<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 1.1?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">5905645</article-id><article-id pub-id-type="pmid">29186322</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btx767</article-id><article-id pub-id-type="publisher-id">btx767</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Notes</subject><subj-group subj-group-type="category-toc-heading"><subject>Genome Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title>SAPP: functional genome annotation and analysis through a semantic framework using FAIR principles</article-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-8172-8981</contrib-id><name><surname>Koehorst</surname><given-names>Jasper J</given-names></name><xref ref-type="aff" rid="btx767-aff1">1</xref><xref ref-type="corresp" rid="btx767-cor1"/><!--<email>jasperkoehorst@gmail.com</email>--></contrib><contrib contrib-type="author"><name><surname>van Dam</surname><given-names>Jesse C J</given-names></name><xref ref-type="aff" rid="btx767-aff1">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-8284-4829</contrib-id><name><surname>Saccenti</surname><given-names>Edoardo</given-names></name><xref ref-type="aff" rid="btx767-aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Martins dos Santos</surname><given-names>Vitor A P</given-names></name><xref ref-type="aff" rid="btx767-aff1">1</xref><xref ref-type="aff" rid="btx767-aff2">2</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-5845-146X</contrib-id><name><surname>Suarez-Diez</surname><given-names>Maria</given-names></name><xref ref-type="aff" rid="btx767-aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Schaap</surname><given-names>Peter J</given-names></name><xref ref-type="aff" rid="btx767-aff1">1</xref><xref ref-type="corresp" rid="btx767-cor1"/><!--<email>peter.schaap@wur.nl</email>--></contrib></contrib-group><contrib-group><contrib contrib-type="editor"><name><surname>Hancock</surname><given-names>John</given-names></name><role>Associate Editor</role></contrib></contrib-group><aff id="btx767-aff1"><label>1</label>Laboratory of Systems and Synthetic Biology, Wageningen University &#x00026; Research, Wageningen WE, The Netherlands</aff><aff id="btx767-aff2"><label>2</label>LifeGlimmer GmbH, Berlin, Germany</aff><author-notes><corresp id="btx767-cor1">To whom correspondence should be addressed. Email: <email>jasperkoehorst@gmail.com</email> or <email>peter.schaap@wur.nl</email></corresp></author-notes><pub-date pub-type="ppub"><day>15</day><month>4</month><year>2018</year></pub-date><pub-date pub-type="epub" iso-8601-date="2017-11-23"><day>23</day><month>11</month><year>2017</year></pub-date><pub-date pub-type="pmc-release"><day>23</day><month>11</month><year>2017</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>34</volume><issue>8</issue><fpage>1401</fpage><lpage>1403</lpage><history><date date-type="received"><day>10</day><month>10</month><year>2017</year></date><date date-type="rev-recd"><day>09</day><month>11</month><year>2017</year></date><date date-type="accepted"><day>22</day><month>11</month><year>2017</year></date></history><permissions><copyright-statement>&#x000a9; The Author 2017. Published by Oxford University Press.</copyright-statement><copyright-year>2017</copyright-year><license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p></license></permissions><self-uri xlink:href="btx767.pdf"/><abstract><title>Abstract</title><sec id="s1"><title>Summary</title><p>To unlock the full potential of genome data and to enhance data interoperability and reusability of genome annotations we have developed SAPP, a Semantic Annotation Platform with Provenance. SAPP is designed as an infrastructure supporting FAIR <italic>de novo</italic> computational genomics but can also be used to process and analyze existing genome annotations. SAPP automatically predicts, tracks and stores structural and functional annotations and associated dataset- and element-wise provenance in a Linked Data format, thereby enabling information mining and retrieval with Semantic Web technologies. This greatly reduces the administrative burden of handling multiple analysis tools and versions thereof and facilitates multi-level large scale comparative analysis.</p></sec><sec id="s2"><title>Availability and implementation</title><p>SAPP is written in JAVA and freely available at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/sapp">https://gitlab.com/sapp</ext-link> and runs on Unix-like operating systems. The documentation, examples and a tutorial are available at <ext-link ext-link-type="uri" xlink:href="https://sapp.gitlab.io">https://sapp.gitlab.io</ext-link>.</p></sec></abstract><funding-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">Research Council of Norway</named-content><named-content content-type="funder-identifier">10.13039/501100005416</named-content></funding-source><award-id>248792</award-id></award-group></funding-group><counts><page-count count="3"/></counts></article-meta></front><body><sec><title>1 Introduction</title><p>Managing the genomic data deluge puts specific emphasis on the ability of machines to automatically find and use the data. To meet this demand and to extract maximum benefit from research investments, digital objects should be Findable, Accessible, Interoperable and Reusable (i.e. FAIR) (<xref rid="btx767-B12" ref-type="bibr">Wilkinson <italic>et al.</italic>, 2016</xref>).</p><p>Genome annotation data is usually findable and accessible through public repositories in which the data is linked to metadata providing detailed descriptions of the data acquisition and generation process. Interoperability reflects the potential for seamless integration of data from independent sources. Currently, genome comparisons usually involve a laborious process of data retrieval, modification and standardization (canonicalization). Reusability requires rich metadata with provenance for each annotation. Current standard formats (GenBank, EMBL or GFF3) retain the output of the prediction tools (for example for gene identification) but only when they score better than a predefined, often pragmatic, prediction threshold. Detailed information of the actual prediction scores is lost. This hampers critical re-examination of the results.</p><p>Because existing genome annotation data is hard to be made FAIR and managing of FAIR genome annotation data requires a considerable administrative load, we developed SAPP, a semantic framework for large scale comparative functional genomics studies. SAPP can automatically annotate genome sequences using standard tools. The unique characteristic of SAPP is that the annotation results and their provenance are stored in a Linked Data format, thus enabling the deployment of mining capabilities of the Semantic Web. As the automatic annotations are incorporated into a dynamic framework, SAPP supports periodic querying, comparison and linking of diverse annotation sources, resulting in up-to-date genome annotations. By interrogating metadata as part of a digital annotation object, annotation data becomes interoperable as the extraction procedure requires no additional standardization process.</p></sec><sec><title>2 Implementation</title><p>SAPP accepts annotated and non-annotated sequence files which are converted into an RDF data structure using the GBOL ontology (<xref rid="btx767-B11" ref-type="bibr">van Dam <italic>et al.</italic>, 2017</xref>). Within SAPP, structural and functional annotation is performed using add-on modules incorporating existing standard annotation tools such as Prodigal and Augustus (<xref rid="btx767-B6" ref-type="bibr">Hyatt <italic>et al.</italic>, 2010</xref>; <xref rid="btx767-B10" ref-type="bibr">Stanke and Morgenstern, 2005</xref>). Modules for tRNA, tmRNA, rRNAs, protein domain and CRISPR repeats annotation are also available. New modules can be added. Annotation data and metadata are stored in a compressed graph database (<xref rid="btx767-B4" ref-type="bibr">Fern&#x000e1;ndez <italic>et al.</italic>, 2013</xref>), as shown in <xref ref-type="fig" rid="btx767-F1">Figure 1A</xref>.
</p><fig id="btx767-F1" orientation="portrait" position="float"><label>Fig. 1</label><caption><p>(<bold>A</bold>) The conversion module imports genome sequences in common formats. Annotation modules perform common tasks such as gene, tRNA, protein and protein domain annotation. Results are stored as Linked Data and consistency is ensured by the GBOL stack. (<bold>B</bold>) SPARQL query to retrieve the E-value score of the instances of the protein domain PF00465 across multiple bacterial genomes. (<bold>C</bold>) Distribution of E-values for protein domain PF00465 across multiple bacterial genomes: note the multimodality of the distribution. (<bold>D</bold>) Principal component analysis of functional similarities of 100 bacterial genomes from the <italic>Streptococcus</italic> (blue) and the <italic>Staphylococcus</italic> (orange) genera. PC1 and PC2 account for 51.4 and 10.1% of the variance in the dataset respectively</p></caption><graphic xlink:href="btx767f1"/></fig><p>Genome annotations can be exported to standard formats. All data can be directly queried and compared using the SPARQL endpoint or via the GBOL API (Java/R). Complex queries can be performed on multiple genomes while simultaneously taking meta-data into account. A SPARQL query example is provided in <xref ref-type="fig" rid="btx767-F1">Figure 1B</xref>. Examples to query SAPP from R, Java or Python, a tutorial and a list of publications in which SAPP was used can be found at <ext-link ext-link-type="uri" xlink:href="http://sapp.gitlab.io">http://sapp.gitlab.io</ext-link>.</p></sec><sec><title>3 Results and discussion</title><p>Reproducible computational research requires a management system that links data with data provenance. Interoperability requires a strictly defined ontology. Using and sharing Linked Data based on controlled vocabularies and ontologies ensures the interoperability and reusability of the data. SAPP functionalities are unique since none of the existing <italic>de novo</italic> annotation pipelines implement Semantic Web technologies. SAPP generated data fulfil the applicable requirements for data FAIRness proposed by <xref rid="btx767-B12" ref-type="bibr">Wilkinson <italic>et al.</italic> (2016)</xref>.</p><p>For input and output, these tools interact directly with the database thereby forcing automatic linkage of data and provenance. In this way there is no need to work with predefined thresholds on the parameters controlling the annotation output. SAPP uses a controlled vocabulary to describe genome annotations. Consistency is ensured through the GBOL Stack (<xref rid="btx767-B11" ref-type="bibr">van Dam <italic>et al.</italic>, 2017</xref>).</p><p>The GBOL ontology enables consistent genome annotation while integrating dataset-wise and element-wise provenance. The element-wise provenance is the statistical basis or score of each individual annotation, whereas the dataset-wise provenance refers to the programs, versions thereof and parameters used for the complete annotation of the (set of) sequences under study.</p><p>GBOL makes use of existing ontologies: PROV-O for activity capturing (<xref rid="btx767-B9" ref-type="bibr">Lebo <italic>et al.</italic>, 2013</xref>); FOAF for agent information (<xref rid="btx767-B2" ref-type="bibr">Brickley and Miller, 2007</xref>); BIBO for article information stored within the annotation files (<xref rid="btx767-B5" ref-type="bibr">Giasson and D&#x02019;arcus, 2008</xref>); SO for sequence information (<xref rid="btx767-B3" ref-type="bibr">Eilbeck <italic>et al.</italic>, 2005</xref>); FALDO for genomic location (<xref rid="btx767-B1" ref-type="bibr">Bolleman <italic>et al.</italic>, 2016</xref>), among many others. We refer the reader to <xref rid="btx767-B11" ref-type="bibr">van Dam <italic>et al.</italic> (2017)</xref> for detailed information on the integrated ontologies and the data model.</p><p>Annotations can be evaluated through critical examination of the provenance. The use of SPARQL allows complex queries across data annotated with SAPP and in direct comparison of these annotations with external resources, such as UniProt. Additionally for specific questions, likelihood values can be integrated, normalized or corrected for multiple testing. For instance, study of E-value distribution on instances of a protein domain across multiple genomes can inform optimal threshold selection, as shown in <xref ref-type="fig" rid="btx767-F1">Figure 1C</xref>. SAPP implements existing tools: consistency of SAPP annotation and a comparison with deposited annotations is shown and discussed in <xref rid="btx767-B7" ref-type="bibr">Koehorst <italic>et al.</italic> (2016</xref>).</p><p>By querying multiple consistently annotated genomes simultaneously, large scale functional comparisons can be performed without additional conversion steps [see <xref ref-type="fig" rid="btx767-F1">Fig. 1D</xref> and <xref rid="btx767-B8" ref-type="bibr">Koehorst <italic>et al.</italic> (2017)</xref>].</p><p>These examples demonstrate that by adopting FAIR principles to genome annotation, knowledge discovery is facilitated.</p></sec><sec><title>Funding</title><p>This work has received funding from the Research Council of Norway, No. 248792 (DigiSal) and from the European Union FP7 and H2020 under grant agreements No. 305340 (INFECT), No. 635536 (EmPowerPutida), Synthetic Biology Investment Theme (KB-32) from Wageningen University &#x00026; Research, and No. 634940 (MycoSynVac).</p><p>
<italic>Conflict of Interest</italic>: none declared.</p></sec></body><back><ref-list><title>References</title><ref id="btx767-B1"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Bolleman</surname><given-names>J.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>FALDO: a semantic standard for describing the location of nucleotide and protein feature annotation</article-title>. <source>J. Biomed. Seman</source>., <volume>7</volume>, <fpage>1</fpage>&#x02013;<lpage>19</lpage>.</mixed-citation></ref><ref id="btx767-B2"><mixed-citation publication-type="other">
<person-group person-group-type="author"><name name-style="western"><surname>Brickley</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Miller</surname><given-names>L.</given-names></name></person-group> (<year>2007</year>) Foaf vocabulary specification 0.91.</mixed-citation></ref><ref id="btx767-B3"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Eilbeck</surname><given-names>K.</given-names></name></person-group>
<etal>et al</etal> (<year>2005</year>) 
<article-title>The Sequence Ontology: a tool for the unification of genome annotations</article-title>. <source>Genome Biol</source>., <volume>6</volume>, <fpage>R44</fpage>.<pub-id pub-id-type="pmid">15892872</pub-id></mixed-citation></ref><ref id="btx767-B4"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Fern&#x000e1;ndez</surname><given-names>J.D.</given-names></name></person-group>
<etal>et al</etal> (<year>2013</year>) 
<article-title>Binary RDF representation for publication and exchange (HDT)</article-title>. <source>Web Semant. Sci. Serv. Agents World Wide Web</source>, <volume>19</volume>, <fpage>22</fpage>&#x02013;<lpage>41</lpage>.</mixed-citation></ref><ref id="btx767-B5"><mixed-citation publication-type="other">
<person-group person-group-type="author"><name name-style="western"><surname>Giasson</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>D&#x02019;arcus</surname><given-names>B.</given-names></name></person-group> (<year>2008</year>) Bibliographic ontology. Technical report, Technical report.</mixed-citation></ref><ref id="btx767-B6"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Hyatt</surname><given-names>D.</given-names></name></person-group>
<etal>et al</etal> (<year>2010</year>) 
<article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>119</fpage>.<pub-id pub-id-type="pmid">20211023</pub-id></mixed-citation></ref><ref id="btx767-B7"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Koehorst</surname><given-names>J.J.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>Comparison of 432 pseudomonas strains through integration of genomic, functional, metabolic and expression data</article-title>. <source>Sci. Rep</source>., <volume>6</volume>.</mixed-citation></ref><ref id="btx767-B8"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Koehorst</surname><given-names>J.J.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Protein domain architectures provide a fast, efficient and scalable alternative to sequence-based methods for comparative functional genomics</article-title>. <source>F1000Research</source>, <volume>5</volume>, <fpage>1987</fpage>.</mixed-citation></ref><ref id="btx767-B9"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Lebo</surname><given-names>T.</given-names></name></person-group>
<etal>et al</etal> (<year>2013</year>) 
<article-title>Prov-o: The prov ontology. Technical report, W3C Recommendation</article-title>.</mixed-citation></ref><ref id="btx767-B10"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Stanke</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Morgenstern</surname><given-names>B.</given-names></name></person-group> (<year>2005</year>) 
<article-title>Augustus: a web server for gene prediction in eukaryotes that allows user-defined constraints</article-title>. <source>Nucleic Acids Res</source>., <volume>33</volume>, <fpage>W465</fpage>&#x02013;<lpage>W467</lpage>.<pub-id pub-id-type="pmid">15980513</pub-id></mixed-citation></ref><ref id="btx767-B11"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>van Dam</surname><given-names>J.C.J.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Interoperable genome annotation with GBOL, an extendable infrastructure for functional data mining</article-title>. <source>bioRxiv</source>, <volume>184747</volume>, <fpage>1</fpage>&#x02013;<lpage>9</lpage>.</mixed-citation></ref><ref id="btx767-B12"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Wilkinson</surname><given-names>M.D.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>The FAIR Guiding Principles for scientific data management and stewardship</article-title>. <source>Sci. Data</source>, <volume>3</volume>, <fpage>160018</fpage>.<pub-id pub-id-type="pmid">26978244</pub-id></mixed-citation></ref></ref-list></back></article>