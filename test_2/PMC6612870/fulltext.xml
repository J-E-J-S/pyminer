<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 1.1?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6612870</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btz321</article-id><article-id pub-id-type="publisher-id">btz321</article-id><article-categories><subj-group subj-group-type="heading"><subject>Ismb/Eccb 2019 Conference Proceedings</subject><subj-group subj-group-type="category-toc-heading"><subject>Comparative and Functional Genomics</subject></subj-group></subj-group></article-categories><title-group><article-title>A statistical simulator scDesign for rational scRNA-seq experimental design</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Li</surname><given-names>Wei Vivian</given-names></name><xref ref-type="aff" rid="btz321-aff1">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-9288-5648</contrib-id><name><surname>Li</surname><given-names>Jingyi Jessica</given-names></name><xref ref-type="aff" rid="btz321-aff1">1</xref><xref ref-type="aff" rid="btz321-aff2">2</xref><xref ref-type="corresp" rid="btz321-cor1"/><!--<email>jli@stat.ucla.edu</email>--></contrib></contrib-group><aff id="btz321-aff1"><label>1</label>Department of Statistics, University of California, Los Angeles, CA, USA</aff><aff id="btz321-aff2"><label>2</label>Department of Human Genetics, University of California, Los Angeles, CA, USA</aff><author-notes><corresp id="btz321-cor1">To whom correspondence should be addressed. <email>jli@stat.ucla.edu</email></corresp></author-notes><pub-date pub-type="ppub"><month>7</month><year>2019</year></pub-date><pub-date pub-type="epub" iso-8601-date="2019-07-05"><day>05</day><month>7</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>05</day><month>7</month><year>2019</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>35</volume><issue>14</issue><fpage>i41</fpage><lpage>i50</lpage><permissions><copyright-statement>&#x000a9; The Author(s) 2019. Published by Oxford University Press.</copyright-statement><copyright-year>2019</copyright-year><license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p></license></permissions><self-uri xlink:href="btz321.pdf"/><abstract><title>Abstract</title><sec id="s1"><title>Motivation</title><p>Single-cell RNA sequencing (scRNA-seq) has revolutionized biological sciences by revealing genome-wide gene expression levels within individual cells. However, a critical challenge faced by researchers is how to optimize the choices of sequencing platforms, sequencing depths and cell numbers in designing scRNA-seq experiments, so as to balance the exploration of the depth and breadth of transcriptome information.</p></sec><sec id="s2"><title>Results</title><p>Here we present a flexible and robust simulator, scDesign, the first statistical framework for researchers to quantitatively assess practical scRNA-seq experimental design in the context of differential gene expression analysis. In addition to experimental design, scDesign also assists computational method development by generating high-quality synthetic scRNA-seq datasets under customized experimental settings. In an evaluation based on 17 cell types and 6 different protocols, scDesign outperformed four state-of-the-art scRNA-seq simulation methods and led to rational experimental design. In addition, scDesign demonstrates reproducibility across biological replicates and independent studies. We also discuss the performance of multiple differential expression and dimension reduction methods based on the protocol-dependent scRNA-seq data generated by scDesign. scDesign is expected to be an effective bioinformatic tool that assists rational scRNA-seq experimental design and comparison of scRNA&#x02013;seq computational methods based on specific research goals.</p></sec><sec id="s3"><title>Availability and implementation</title><p>We have implemented our method in the R package scDesign, which is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/Vivianstats/scDesign">https://github.com/Vivianstats/scDesign</ext-link>.</p></sec><sec id="s4"><title>Supplementary information</title><p>
<xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p></sec></abstract><funding-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">National Science Foundation</named-content><named-content content-type="funder-identifier">10.13039/100000001</named-content></funding-source><award-id>DMS-1613338</award-id><award-id>DBI-1846216</award-id></award-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">National Institutes of Health</named-content><named-content content-type="funder-identifier">10.13039/100000002</named-content></funding-source><award-id>R01GM120507</award-id></award-group></funding-group><counts><page-count count="10"/></counts></article-meta></front><body><sec><title>1 Introduction</title><p>The emergence and rapid development of single-cell RNA-sequencing (scRNA-seq) technologies offer unprecedented opportunities for investigating transcriptional mechanisms underlying biological and medical phenomena at the individual-cell resolution (<xref rid="btz321-B15" ref-type="bibr">Haque <italic>et al.</italic>, 2017</xref>; <xref rid="btz321-B47" ref-type="bibr">Wagner <italic>et al.</italic>, 2016</xref>). While bulk RNA sequencing has been widely used to capture the average transcriptome information in a batch of cells (<xref rid="btz321-B25" ref-type="bibr">Li and Li, 2018b</xref>), scRNA-seq allows the investigation of transcriptome variation across thousands to millions of cells. The scRNA-seq technologies have enabled researchers to investigate fundamental biomedical questions, such as cellular composition of various tissues and cell types, cell differentiation trajectories, and spatial and temporal dynamics of single cells. Important discoveries have been made from scRNA-seq data and have advanced our understanding of diseases, such as neurological disorders (<xref rid="btz321-B41" ref-type="bibr">Skene <italic>et al.</italic>, 2018</xref>) and tumorigenesis (<xref rid="btz321-B44" ref-type="bibr">Tirosh <italic>et al.</italic>, 2016</xref>).</p><p>Since the first scRNA-seq study was published in 2009 (<xref rid="btz321-B43" ref-type="bibr">Tang <italic>et al.</italic>, 2009</xref>), more than 20 scRNA-seq experimental protocols have been developed. An effective experimental design requires careful consideration of the target research question as well as the experimental budget, and a typical design in practice consists of two steps. First, researchers need to select a proper protocol among the available ones, and the primary consideration is the choice between a tag-based protocol that allows the integration of unique molecular identifiers (UMIs) (<xref rid="btz321-B20" ref-type="bibr">Kivioja <italic>et al.</italic>, 2012</xref>) and a full-length protocol that captures full-length transcripts and allows the addition of the External RNA Control Consortium (ERCC) spike-ins (<xref rid="btz321-B2" ref-type="bibr">Bacher and Kendziorski, 2016</xref>). The tag-based protocols [e.g. Drop-seq (<xref rid="btz321-B29" ref-type="bibr">Macosko <italic>et al.</italic>, 2015</xref>)] are usually used to obtain a broad but shallow view of the transcriptomes across many cells, while the full-length protocols [e.g. Smart-seq2 (<xref rid="btz321-B33" ref-type="bibr">Picelli <italic>et al.</italic>, 2013</xref>)] provide a deeper account of the gene expression in fewer cells. For example, a study about gene expression dynamics during stem cell differentiation requires accurate gene expression measurements, so it should opt for a full-length protocol. In contrast, in a study aiming to identify a previously unknown cell phase during the differentiation, it is necessary to sequence a large number of cells using a tag-based protocol to capture the transient phases. In the second step, to optimize an experiment with a selected protocol and a fixed budget, researchers need to choose between exploring the depth or breadth of transcriptome information, which sums up to determining the appropriate number of cells to sequence.</p><p>However, in contrast to the classical experimental design (<xref rid="btz321-B36" ref-type="bibr">Quinn and Keough, 2002</xref>) guided by certain theoretical optimality (e.g. the maximum power of a statistical test), the scRNA-seq experimental design is impeded by various sources of data noises, making a reasonable theoretical analysis tremendously difficult (<xref rid="btz321-B22" ref-type="bibr">Kolodziejczyk <italic>et al.</italic>, 2015</xref>; <xref rid="btz321-B34" ref-type="bibr">Pierson and Yau, 2015</xref>). Especially, scRNA-seq data are characterized by excess zeros resulted from <italic>dropout</italic> events, in which a gene is expressed in a cell but its mRNA transcripts are undetected. As a result, many commonly used statistical assumptions are not directly applicable to modeling scRNA-seq data. For example, Baran-Gale <italic>et al.</italic> proposed using a Negative Binomial model to estimate the number of cells to sequence, so that the resulting experiment is expected to capture at least a specified number of cells from the rarest cell type (<xref rid="btz321-B3" ref-type="bibr">Baran-Gale <italic>et al.</italic>, 2017</xref>). However, the estimation accuracy depends on the idealized Negative Binomial model assumption, which real scRNA-seq data usually do not closely follow (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>). There is also a theoretical investigation of the cell-depth trade-off based on the Poisson assumption of gene read counts and a specific list of genes of interests (<xref rid="btz321-B50" ref-type="bibr">Zhang <italic>et al.</italic>, 2018</xref>). In contrast to model-based design approaches (<xref rid="btz321-B9" ref-type="bibr">Dumitrascu <italic>et al.</italic>, 2018</xref>), multiple scRNA-seq studies used descriptive statistics to provide qualitative guidance instead of well-defined optimization criteria for experimental design (<xref rid="btz321-B13" ref-type="bibr">Gr&#x000fc;n and van Oudenaarden, 2015</xref>; <xref rid="btz321-B38" ref-type="bibr">Rizzetto <italic>et al.</italic>, 2017</xref>). However, because the descriptive statistics were proposed from diverse perspectives, their resulting experimental designs are difficult to unify to guide practices. For example, one study reported that the sensitivity of most protocols saturates at approximately one million reads per cell (<xref rid="btz321-B52" ref-type="bibr">Ziegenhain <italic>et al.</italic>, 2017</xref>), while another study found that the saturation occurs at around 4.5 million reads per cell (<xref rid="btz321-B42" ref-type="bibr">Svensson <italic>et al.</italic>, 2017</xref>). The reason for this discrepancy is that the two studies defined the sensitivity in different ways: the first study used the gene detection rate, while the second study used the minimum number of input RNA molecules required for confidently detecting a spike-in control (<xref rid="btz321-B18" ref-type="bibr">Jiang <italic>et al.</italic>, 2011</xref>).</p><p>In this article, we propose a statistical simulator scDesign for optimizing scRNA-seq experimental design from the perspective of detecting differentially expressed (DE) genes between two biological conditions (determined before an experiment) or two cell states (inferred after an experiment), a major scRNA-seq data analysis task. Given a pre-defined significance level [e.g. a false discovery rate (FDR)], the power of an scRNA-seq experiment for detecting DE genes is jointly determined by the sensitivity of detecting gene expression, the accuracy of measuring gene expression and the number of cells sequenced for each cell state. For each protocol and a specified total sequencing depth (i.e., the total number of reads in an scRNA-seq experiment), the cell-wise sequencing depth (i.e. the expected number of reads per cell) decreases as the cell number increases (<xref rid="btz321-B15" ref-type="bibr">Haque <italic>et al.</italic>, 2017</xref>). However, existing power analysis methods for scRNA-seq experiments unrealistically assume a fixed cell-wise sequencing depth, which does not change as the cell number varies (<xref rid="btz321-B46" ref-type="bibr">Vieth <italic>et al.</italic>, 2017</xref>; <xref rid="btz321-B52" ref-type="bibr">Ziegenhain <italic>et al.</italic>, 2017</xref>). Therefore, the practical scRNA-seq experimental design calls for a new approach that accounts for various characteristics and constraints of a real scRNA-seq experiment.</p><p>ScDesign is a simulation-based experimental design framework that has multiple advantages in real practice. First, scDesign is protocol- and data-adaptive. It learns scRNA-seq data characteristics from rapidly accumulating public scRNA-seq data generated under diverse settings. For example, 1976 series of scRNA-seq datasets are currently available in the Gene Expression Omnibus (GEO) database (<xref rid="btz321-B10" ref-type="bibr">Edgar <italic>et al.</italic>, 2002</xref>). There are also newly developed scRNA-seq databases, such as SCPortalen (70 studies with 67 146 cells) (<xref rid="btz321-B1" ref-type="bibr">Abugessaisa <italic>et al.</italic>, 2018</xref>), scRNASeqDB (36 studies with 8910 cells) (<xref rid="btz321-B6" ref-type="bibr">Cao <italic>et al.</italic>, 2017</xref>) and the Single Cell Portal (43 studies with 496 366 cells). Second, scDesign generates synthetic data that well mimic real scRNA-seq data under the same experimental settings, providing a basis for using its synthetic data to guide practical scRNA-seq experimental design. Third, scDesign is flexible in accommodating user-specific analysis needs. Users can apply scDesign to evaluate the performance of downstream analysis, such as gene differential expression and cell clustering, under various experimental settings at no experimental cost. Assisted by the evaluation results, users will be able to design an scRNA-seq experiment based on the setting that leads to the best performance according to their specified criteria.</p></sec><sec><title>2 Materials and Methods</title><sec><title>2.1 The statistical framework of scDesign</title><p>We develop scDesign based on a statistical generative framework that utilizes both existing real scRNA-seq data and reasonable assumptions mimicking various experimental processes. In contrast to the existing simulation methods for scRNA-seq data, scDesign constructs a Gamma-Normal mixture model to account for dropout events. This is motivated by the successful applications of our previously developed imputation method, scImpute, for recovering dropout gene expression values in scRNA-seq data (<xref rid="btz321-B24" ref-type="bibr">Li and Li, 2018a</xref>). This mixture model allows scDesign to overcome the dropout hurdle in learning key gene expression characteristics from real scRNA-seq data (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>), so that scDesign generates synthetic data highly similar to real data in multiple aspects. Depending on whether the task is to design an scRNA-seq experiment to sequence one or two batches of cells, scDesign has the corresponding one-state mode (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2a</xref>) or the two-state mode (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2b</xref>). In the one-state mode, scDesign leverages the information in a real scRNA-seq dataset from one biological condition (e.g. treatment or control) or one cell state (e.g. T cells) to generate a single scRNA-seq dataset given an experimental setting, i.e. a pre-specified total sequencing depth and a cell number. From the real scRNA-seq dataset, scDesign first estimates two cell-wise and three gene-wise parameters, which jointly define the key characteristics of scRNA-seq data. Second, scDesign simulates ideal gene expression levels for new cells of the same biological condition or cell state based on the estimated gene expression parameters. Third, scDesign introduces missing values to mimic the actual dropout events in an scRNA-seq experiment. Fourth, scDesign outputs a synthetic gene expression matrix with entries as read counts. In the two-state mode, scDesign leverages the information in two real scRNA-seq datasets from different biological conditions or cell states to generate two scRNA-seq datasets given an experimental setting. In this two-state mode, the simulation by scDesign mimics an experiment where two groups of cells from two biological conditions or cell states are sequenced together (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2b</xref>).</p></sec><sec><title>2.2 scDesign for scRNA-seq data simulation</title><p>In this section, we describe how scDesign generates simulated RNA-seq data given existing real scRNA-seq data from a certain cell state. These simulated count matrices capture the characteristics of real count matrices, and they thus can be used to assist the development of computational methods and evaluate the performance of those methods under user-specified settings. We introduce how to simulate a single count matrix below. Please refer to the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> for simulating multiple count matrices following a differentiation path.</p><p>Given a real single-cell count matrix with <italic>I</italic> genes and <italic>J</italic><sub>0</sub> cells, our goal is to generate a new count matrix with <italic>I</italic> genes and <italic>J</italic> cells, under the constraint that the new matrix has a total of <italic>S</italic> reads (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2a</xref>). Both <italic>J</italic> and <italic>S</italic> are user-specified parameters. This resembles the real scenario where both the cell number and the total read number (i.e. the total sequencing depth) need to be specified before an scRNA-seq experiment.</p><sec><title>2.2.1. Step 1: Estimate parameters from real scRNA-seq data</title><p>Denote the real single-cell count matrix by <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mtext>real</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, whose <italic>I</italic> rows and <italic>J</italic><sub>0</sub> columns represent the genes and cells, respectively. About the two cell-wise parameters, for each cell <italic>j</italic> we estimated its library size as
<disp-formula id="E1"><mml:math id="M1"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mtext>real</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#x02003;</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x000a0;</mml:mo></mml:mrow></mml:math></disp-formula>
and its cell-wise dropout rate as
<disp-formula id="E2"><mml:math id="M2"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>I</mml:mi></mml:mfrac><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:munderover><mml:mi mathvariant="double-struck">I</mml:mi><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mtext>real</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mo>&#x02003;</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>.</mml:mo><mml:mo>&#x000a0;</mml:mo></mml:mrow></mml:math></disp-formula>
Then we fit the cell library sizes <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> using a truncated Normal distribution, and the estimated mean and standard deviation (SD) are denoted as <inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, respectively.</p><p>To estimate the three gene-wise parameters, we first normalized the read counts given their corresponding library sizes and then performed a logarithmic transformation on the normalized values. The transformed matrix is denoted as <inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02009;</mml:mo><mml:mtext>log</mml:mtext><mml:mo>&#x02009;</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, where
<disp-formula id="E3"><mml:math id="M3"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02009;</mml:mo><mml:mtext>log</mml:mtext><mml:mo>&#x02009;</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>&#x02009;</mml:mo><mml:mtext>log</mml:mtext><mml:mo>&#x02009;</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>median</mml:mtext><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>J</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mtext>real</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1.01</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mo>&#x000a0;</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Using the Gamma-Normal mixture model described in the scImpute method (<xref rid="btz321-B24" ref-type="bibr">Li and Li, 2018a</xref>), we estimated the gene-wise dropout rate and mean and SD of gene expression. The mixture model considers the expression levels of gene <italic>i</italic> as independently and identically distributed random variable <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02009;</mml:mo><mml:mtext>log</mml:mtext><mml:mo>&#x02009;</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo>&#x02009;</mml:mo><mml:mtext>log</mml:mtext><mml:mo>&#x02009;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> following the density function
<disp-formula id="E4"><mml:math id="M4"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003bb;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtext>Gamma</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b1;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b2;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003bb;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>Normal</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003bc;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>&#x003c3;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#x000a0;</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE7"><mml:math id="IM7"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003bb;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is gene <italic>i&#x02019;</italic>s dropout rate, <inline-formula id="IE8"><mml:math id="IM8"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003b1;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE9"><mml:math id="IM9"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003b2;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are the shape and rate parameters of the Gamma distribution and <inline-formula id="IE10"><mml:math id="IM10"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003bc;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE11"><mml:math id="IM11"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003c3;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are the mean and SD of the Normal distribution. The Gamma component describes the gene expression distribution when dropout occurs, while the Normal component represents the distribution of actual gene expression levels. We use multiple real scRNA-seq datasets to demonstrate that this mixture model outperforms the widely used Negative Binomial model in terms of goodness of fit to real data (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>). The parameters in this model can be estimated by the Expectation-Maximization (EM) algorithm and the resulting dropout rate, mean and SD estimates are denoted as <inline-formula id="IE12"><mml:math id="IM12"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bb;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02009;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE13"><mml:math id="IM13"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, respectively. We then used a Gamma distribution to fit the estimated gene mean expression levels <inline-formula id="IE14"><mml:math id="IM14"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and denoted the estimated shape and scale parameters as <inline-formula id="IE15"><mml:math id="IM15"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE16"><mml:math id="IM16"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p>To summarize, we estimated two cell-wise parameters including the cell library size <inline-formula id="IE17"><mml:math id="IM17"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and the cell-wise dropout rate <inline-formula id="IE18"><mml:math id="IM18"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (<inline-formula id="IE19"><mml:math id="IM19"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>), and three gene-wise parameters including the mean expression <inline-formula id="IE20"><mml:math id="IM20"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, the SD <inline-formula id="IE21"><mml:math id="IM21"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and the gene-wise dropout rate <inline-formula id="IE22"><mml:math id="IM22"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bb;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (<inline-formula id="IE23"><mml:math id="IM23"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>).</p></sec><sec><title>2.2.2. Step 2: Simulate ideal gene expression values</title><p>In this step, we simulated the ideal expression values independently for each gene without considering varying cell library sizes and the dropout issue. For each gene <italic>i</italic> (<inline-formula id="IE24"><mml:math id="IM24"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>), we first simulated its mean expression <inline-formula id="IE25"><mml:math id="IM25"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003bc;</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, then we simulated its SD by stratified sampling from the binned observations, which we processed from the real count matrix. Specifically, we divided the estimated gene mean expression values <inline-formula id="IE26"><mml:math id="IM26"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> into <italic>B</italic> intervals, and we use <inline-formula id="IE27"><mml:math id="IM27"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to denote the <italic>k</italic>th order statistic of <inline-formula id="IE28"><mml:math id="IM28"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. Then, the first interval is <inline-formula id="IE29"><mml:math id="IM29"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mo>&#x0221e;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mi>B</mml:mi></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the <italic>b</italic>th interval (<inline-formula id="IE30"><mml:math id="IM30"><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x0003c;</mml:mo><mml:mi>b</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula>) is <inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mi>B</mml:mi></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>&#x02009;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mi>B</mml:mi></mml:mfrac><mml:mi>b</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and the <italic>B</italic>th interval is <inline-formula id="IE32"><mml:math id="IM32"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mi>B</mml:mi></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mo>&#x0221e;</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We define <inline-formula id="IE33"><mml:math id="IM33"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula> if <inline-formula id="IE34"><mml:math id="IM34"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> belongs to the <italic>b</italic>th bin, and similarly we define <italic>z<sub>i</sub></italic> = <italic>b</italic> if <italic>&#x003bc;<sub>i</sub></italic> belongs to the <italic>b</italic>th bin. We simulated the SD <italic>&#x003c3;<sub>i</sub></italic> of gene <italic>i</italic> by sampling from the stratified gene SDs estimated from the real data: <inline-formula id="IE35"><mml:math id="IM35"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003c3;</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mtext>Uniform</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:mo>}</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Finally, we generated the ideal expression matrix <inline-formula id="IE36"><mml:math id="IM36"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mtext>ideal</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE37"><mml:math id="IM37"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mtext>ideal</mml:mtext></mml:mrow></mml:msubsup><mml:mrow><mml:mover><mml:mo>&#x0223c;</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mtext>Normal</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003bc;</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>&#x003c3;</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula>.</p></sec><sec><title>2.2.3. Step 3: Introduce dropout events</title><p>In this step, we introduced dropout events into the synthetic count matrix, while accounting for the variability of both gene-wise and cell-wise dropout rates. The cell-wise dropout rate in a synthetic cell <italic>j</italic> was simulated as <inline-formula id="IE38"><mml:math id="IM38"><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mover><mml:mo>&#x0223c;</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mtext>Uniform</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula>. For each gene <italic>i</italic> (<inline-formula id="IE39"><mml:math id="IM39"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>), we simulated its gene-wise dropout rate <italic>&#x003bb;<sub>i</sub></italic> by sampling one value from the stratified dropout rates estimated from the real data: <inline-formula id="IE40"><mml:math id="IM40"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003bb;</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mtext>Uniform</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bb;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:mo>}</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Then, we simulated the number of dropout events of gene <italic>i</italic>: <inline-formula id="IE41"><mml:math id="IM41"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mtext>Binomial</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>J</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003bb;</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. In other words, gene <italic>i</italic> was affected by the dropout events in <italic>n<sub>i</sub></italic> cells. These <italic>n<sub>i</sub></italic> cells were sampled without replacement from the cell population <inline-formula id="IE42"><mml:math id="IM42"><mml:mrow><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, with cell <italic>j</italic> being selected with probability <inline-formula id="IE43"><mml:math id="IM43"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. We denote the sampling results by <italic>I<sub>ij</sub></italic>, with <italic>I<sub>ij</sub></italic> = 1 indicating that gene <italic>i</italic> is a dropout in cell <italic>j</italic> and <italic>I<sub>ij</sub></italic> = 0 indicating that gene <italic>i</italic> is successfully amplified in cell <italic>j</italic>, <inline-formula id="IE44"><mml:math id="IM44"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula>. Then we obtained the synthetic count matrix with dropout events <inline-formula id="IE45"><mml:math id="IM45"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mtext>drop</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE46"><mml:math id="IM46"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mtext>drop</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mtext>ideal</mml:mtext></mml:mrow></mml:msubsup><mml:mi mathvariant="double-struck">I</mml:mi><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:msup><mml:mo>&#x02212;</mml:mo><mml:mn>1.01</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE47"><mml:math id="IM47"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> is the nearest integer to <italic>x</italic>.</p></sec><sec><title>2.2.4. Step 4: Simulate the final count matrix</title><p>We first simulated the library size of each synthetic cell <italic>j</italic>: <inline-formula id="IE48"><mml:math id="IM48"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mover><mml:mo>&#x0223c;</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mtext>Normal</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula>, and then we calculated the expected proportion of each entry in the count matrix
<disp-formula id="E5"><mml:math id="M5"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mtext>drop</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mtext>drop</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Finally, we obtained the final synthetic count matrix <inline-formula id="IE49"><mml:math id="IM49"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, which is constrained by the sequencing depth <italic>S</italic>, by simulating its counts from the multinomial distribution: <inline-formula id="IE50"><mml:math id="IM50"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">IJ</mml:mi></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x0223c;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mtext>Multinomial</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">J</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>IJ</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula></p></sec></sec><sec><title>2.3 scDesign for scRNA-seq experimental design</title><p>ScDesign aims to determine the best number of cells to sequence given a fixed sequencing depth, such that the resulting RNA-seq data are optimized for differential gene expression analysis. We denote the two real count matrices as <inline-formula id="IE51"><mml:math id="IM51"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mtext>real</mml:mtext><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, with <italic>I</italic> rows (genes) and <italic>J</italic><sub>01</sub> columns (cells), and <inline-formula id="IE52"><mml:math id="IM52"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mtext>real</mml:mtext><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, with <italic>I</italic> rows (genes) and <italic>J</italic><sub>02</sub> columns (cells). Without loss of generality, we assume that the two matrices, which represent two cell states, have the same genes listed in the same order. We introduce how to simulate a synthetic count matrix for each state with scDesign in two scenarios, and the procedure is then repeated with varying cell numbers to obtain synthetic data for power analysis (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>).</p><sec><title>2.3.1 Scenario (1)</title><p>In scenario (1), we assume that cells from the two cell states are prepared as separate libraries and sequenced independently. Given <inline-formula id="IE53"><mml:math id="IM53"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mtext>real</mml:mtext><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE54"><mml:math id="IM54"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mtext>real</mml:mtext><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, the goal of scDesign is to generate a synthetic count matrix with <italic>I</italic> genes and <italic>J</italic><sub>1</sub> cells for state 1, and a synthetic count matrix with <italic>I</italic> genes and <italic>J</italic><sub>2</sub> cells for state 2. Cell states 1 and 2 have sequencing depths of <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub>, respectively. For each state <inline-formula id="IE55"><mml:math id="IM55"><mml:mrow><mml:mi>g</mml:mi><mml:mo>&#x02009;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we follow Section 2.2 to simulate a count matrix <inline-formula id="IE56"><mml:math id="IM56"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. The only difference is in step 2, where we directly set <inline-formula id="IE57"><mml:math id="IM57"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>&#x003bc;</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE58"><mml:math id="IM58"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>&#x003c3;</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>, instead of simulating new parameters. This is to ensure that the rows in the two simulated matrices still represent the same set of real genes, and the power analysis based on the simulated data is biologically meaningful.</p></sec><sec><title>2.3.2 Scenario (2)</title><p>Now we consider the case where the two cell states are jointly sequenced. Suppose that the two cell states are mixed in one biological sample, and the experimental setting is that <italic>J</italic> cells are to be sequenced to generate <italic>S</italic> RNA-seq reads in total. We assume that the two cell states present in fractions of <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub> in the sample, respectively. That is, <inline-formula id="IE59"><mml:math id="IM59"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE60"><mml:math id="IM60"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. When <inline-formula id="IE61"><mml:math id="IM61"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, there are more than two cell states present in the same sample. The goal of scDesign in scenario (2) is to simulate count matrices for the two selected cell states, based on a real count matrix of each state (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2b</xref>).
<list list-type="simple"><list-item><p>1. Determine cell numbers.</p></list-item></list></p><p>We denote the numbers of cells from state 1, state 2 and the remaining states as <italic>J</italic><sub>1</sub>, <italic>J</italic><sub>2</sub> and <italic>J<sub>r</sub></italic>, respectively. These numbers were sampled from a Multinomial distribution: <inline-formula id="IE62"><mml:math id="IM62"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x0223c;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mtext>Multinomial</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>J</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula><list list-type="simple"><list-item><p>2. Simulate count matrices with dropout events.</p></list-item></list></p><p>Following steps 1&#x02013;3 in Section 2.2, we simulated two count matrices <inline-formula id="IE63"><mml:math id="IM63"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mtext>drop</mml:mtext><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE64"><mml:math id="IM64"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mtext>drop</mml:mtext><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> for cell states 1 and 2, respectively. The only difference is in step 2, where we directly set <inline-formula id="IE65"><mml:math id="IM65"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>&#x003bc;</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE66"><mml:math id="IM66"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>&#x003c3;</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>, to ensure that the rows in the synthetic count matrices represent the same set of real genes.
<list list-type="simple"><list-item><p>3. Simulate the final count matrices.</p></list-item></list></p><p>We first simulated the library sizes of the cells in the two states:
<disp-formula id="E6"><mml:math id="M6"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>&#x0223c;</mml:mo><mml:mtext>Normal</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>;</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E7"><mml:math id="M7"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&#x0223c;</mml:mo><mml:mtext>Normal</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE67"><mml:math id="IM67"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE68"><mml:math id="IM68"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> are estimated from <inline-formula id="IE69"><mml:math id="IM69"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mtext>real</mml:mtext><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE70"><mml:math id="IM70"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE71"><mml:math id="IM71"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> are estimated from <inline-formula id="IE72"><mml:math id="IM72"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mtext>real</mml:mtext><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Then we combined the two count matrices to obtain the expected proportion matrix <inline-formula id="IE73"><mml:math id="IM73"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>:
<disp-formula id="E8"><mml:math id="M8"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02032;</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02032;</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi><mml:mo>&#x02032;</mml:mo></mml:mrow><mml:mrow><mml:mtext>drop</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo></mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02033;</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02033;</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02033;</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mtext>drop</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE74"><mml:math id="IM74"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mtext>drop</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> if <inline-formula id="IE75"><mml:math id="IM75"><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE76"><mml:math id="IM76"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>drop</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> if <inline-formula id="IE77"><mml:math id="IM77"><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. The first <italic>J</italic><sub>1</sub> columns and the last <italic>J</italic><sub>2</sub> columns in <inline-formula id="IE78"><mml:math id="IM78"><mml:mi mathvariant="bold-italic">P</mml:mi></mml:math></inline-formula> give the expected proportions of genes in cell states 1 and 2, respectively. We further assume that the total number of reads from the two states together is <inline-formula id="IE79"><mml:math id="IM79"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>J</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE80"><mml:math id="IM80"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> denotes the nearest integer to <italic>x</italic>. Then we simulated the final count matrix <inline-formula id="IE81"><mml:math id="IM81"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> constrained by the sequencing depth from a Multinomial distribution: <inline-formula id="IE82"><mml:math id="IM82"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x0223c;</mml:mo><mml:mtext>Multinomial</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> The final count matrix of cell state 1 and state 2 are <inline-formula id="IE83"><mml:math id="IM83"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> (<inline-formula id="IE84"><mml:math id="IM84"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>) and <inline-formula id="IE85"><mml:math id="IM85"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula><inline-formula id="IE86"><mml:math id="IM86"><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>syn</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula>, respectively.</p></sec></sec></sec><sec><title>3 Results</title><sec><title>3.1 scDesign captures key characteristics of scRNA-seq data</title><p>We first demonstrate that scDesign accurately captures six key characteristics of real scRNA-seq data, so it serves as a reliable data simulator to assist scRNA-seq experimental design and to compare relevant computational methods. To assess the simulation performance of scDesign as compared with four other simulation methods, splat, powsimR, Lun and scDD, we compared the simulated data generated by each method with the real data from various protocols. Both splat and powsimR are software packages for simulating scRNA-seq data (<xref rid="btz321-B46" ref-type="bibr">Vieth <italic>et al.</italic>, 2017</xref>; <xref rid="btz321-B49" ref-type="bibr">Zappia <italic>et al.</italic>, 2017</xref>); Lun denotes the simulation design introduced by Lun <italic>et al.</italic> (<xref rid="btz321-B27" ref-type="bibr">Lun <italic>et al.</italic>, 2016</xref>); scDD denotes the simulation method designed to evaluate the DE method scDD (<xref rid="btz321-B23" ref-type="bibr">Korthauer <italic>et al.</italic>, 2016</xref>). We considered six experimental protocols: Smart-seq2 (<xref rid="btz321-B33" ref-type="bibr">Picelli <italic>et al.</italic>, 2013</xref>), Drop-seq (<xref rid="btz321-B29" ref-type="bibr">Macosko <italic>et al.</italic>, 2015</xref>), 10x Genomics (<xref rid="btz321-B51" ref-type="bibr">Zheng <italic>et al.</italic>, 2017</xref>), Fluidigm C1 (SMARTer) (<xref rid="btz321-B35" ref-type="bibr">Pollen <italic>et al.</italic>, 2014</xref>), inDrop (<xref rid="btz321-B21" ref-type="bibr">Klein <italic>et al.</italic>, 2015</xref>) and Seq-Well (<xref rid="btz321-B12" ref-type="bibr">Gierahn <italic>et al.</italic>, 2017</xref>), and we collected three real scRNA-seq gene expression datasets of distinct cell types from each protocol (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>). In summary, we used 18 real count matrices of 17 cell types from human and mouse to evaluate the five simulation methods.</p><p>For each real count matrix, we randomly split the columns (cells) into two subsets of equal sizes, one used to estimate gene expression parameters and simulate a new count matrix with the same dimensions, and the other used to evaluate the simulation results. We compared each pair of real and simulated count matrices in terms of six summary statistics, including four gene-wise statistics [the count mean, the count variance, the count coefficient of variation (cv) and the gene-wise zero proportion) and two cell-wise statistics (the library size and the cell-wise zero proportion) (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). Our results show that scDesign well mimics real scRNA-seq experiments based on all the six experimental protocols, even though those protocols generate data with distinct properties. For example, data from Smart-seq2 and Fluidigm C1 have relatively larger library sizes and smaller count cvs (<xref ref-type="fig" rid="btz321-F1">Fig.&#x000a0;1a</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S3 and S4</xref>), while data from the other four protocols have smaller library sizes and larger zero proportions (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S5&#x02013;S8</xref>). We measured the similarity between each summary statistics&#x02019; empirical distributions in real and the corresponding simulated data by each simulation method, using the Kolmogorov&#x02013;Smirnov (KS) distance, whose value is between 0 and 1 and a smaller value indicates greater similarity (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). Comparing the KS distances of the five methods, we found that scDesign performs the best for five protocols: Smart-seq2, Fluidigm C1, Seq-Well, Drop&#x02013;seq and inDrop (<xref ref-type="fig" rid="btz321-F1">Fig.&#x000a0;1b</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S3&#x02013;S5, S7</xref> and <xref ref-type="supplementary-material" rid="sup1">S8</xref>), while scDesign and powsimR perform comparably for 10x Genomics (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S6</xref>). In summary, scDesign is ranked the best in 84 comparisons and the second best in 20 comparisons, among all the 108 comparisons (6 statistics for each of the 18 datasets). In addition, our results also show that scDesign is able to preserve the relationships between genes&#x02019; expression mean and expression variance, expression cv and zero proportion (<xref ref-type="fig" rid="btz321-F1">Fig.&#x000a0;1c</xref>). The demonstrated advantage of scDesign is rooted in its ability to incorporate both parametric and non-parametric methods to simulate scRNA-seq data. By constructing a mixture model to account for the dropout events, scDesign explicitly models the gene-wise parameters from the real data. When generating cell-wise parameters for the simulated cells, scDesign uses different sampling techniques for each parameter to capture its distribution characteristic. In terms of the method stability, scDesign, Lun and splat successfully estimated simulated data for all the 18 datasets, while scDD encountered errors with 5 datasets, and powsimR had errors with 4 datasets.
</p><fig id="btz321-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>Comparison of scRNA-seq simulation methods based on the Smart-seq2 protocol. (<bold>a</bold>) The gene-wise expression mean, expression variance, expression coefficient of variation, zero proportion and the cell-wise zero proportion and library size in both real (monocytes) and simulated datasets. (<bold>b</bold>) The KS distances between the six statistics in the real and simulated data. The best and second best simulation methods with respect to each statistic are respectively marked with 1 and 2 in the heatmaps. (<bold>c</bold>) The empirical relationships between the key statistics in the real and simulated data</p></caption><graphic xlink:href="btz321f1"/></fig></sec><sec><title>3.2 scDesign guides rational scRNA-seq experimental design</title><p>Given a fixed sequencing depth in designing an scRNA-seq experiment, scDesign assists users in predicting the optimal number of cells for sequencing. In the context of gene differential expression analysis of two cell states, the cell number is optimal if its resulting scRNA-seq data lead to the most accurate detection of DE genes, where the accuracy depends on a user-specified criterion, e.g. a statistical test&#x02019;s power given a significance level. We consider two scenarios: (1) cells from the two cell states are prepared as two separate libraries and sequenced independently; (2) cells from the two cell states are prepared in the same library and sequenced together. Scenario (1) includes many studies that investigated cells collected at two differentiating time points, cells of the same tissue type from patients and healthy subjects or cells of the same type but exposed to different experimental treatments (<xref rid="btz321-B17" ref-type="bibr">Jaitin <italic>et al.</italic>, 2014</xref>; <xref rid="btz321-B40" ref-type="bibr">Shekhar <italic>et al.</italic>, 2016</xref>). The experimental design under scenario (1) aims to select the optimal cell numbers simultaneously for two libraries, so that the subsequent DE analysis becomes the most accurate given a user-specified criterion. Scenario (2) includes many scRNA-seq studies that sequenced an <italic>in vivo</italic> tissue sample, e.g. the peripheral blood mononuclear cell sample (<xref rid="btz321-B51" ref-type="bibr">Zheng <italic>et al.</italic>, 2017</xref>), which is composed of a mixture of cell subtypes. In scenario (2), DE analysis is performed on a pair of known or putative cell subtypes within the sequenced sample. We consider the experimental design to optimize the DE analysis between two pre-selected cell subtypes under scenario (2).</p><p>In scenario (1), the constraints are the total sequencing depths of the two cell states, and scDesign aims to determine the optimal cell number for each cell state, among a set of candidate cell numbers. ScDesign simulates a new count matrix of each state based on a real count matrix of the same state, for each pre-specified sequencing depth and cell number. Once obtaining the simulated count matrices corresponding to various candidate cell numbers, scDesign assesses the accuracy of DE gene identification using five measures: precision, recall, true negative rate, F1 score (the harmonic mean of precision and recall) and F2 score (the harmonic mean of true negative rate and recall) (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>). We applied scDesign to optimize the designs of 14 example experiments (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>). In every experiment, we set the sequencing depth to 100 million reads, and considered eight candidate cell numbers per cell state: 64, 128, 256, 512, 1024, 2048, 4096 and 8192. The DE genes between two cell states were identified using the two-sample <italic>t</italic>-test.</p><p>Our results suggest that given a selected criterion in the DE analysis, the optimal cell number is jointly determined by multiple technical factors, including the experimental protocol and the variation introduced by sequencing, as well as biological factors, such as the intra- and inter-state cellular heterogeneity. Two factors are notable. First, when cells of the same two states are sequenced, the optimal cell number varies with protocols. For example, between two subtypes of glial cells: astrocytes and oligodendrocytes, 512 cells per state is the optimal cell number that maximizes the recall in DE analysis when Fluidigm C1 is used, but the number becomes 4096 per state when inDrop is used (<xref ref-type="fig" rid="btz321-F2">Fig.&#x000a0;2</xref>). If users choose the F1 score as the criterion, the optimal cell number per state is 128 and 1024 for Fluidigm C1 and inDrop, respectively. Therefore, Fluidigm C1 and inDrop require vastly different cell numbers to reach the same level of accuracy in DE analysis, and inDrop generally needs more cells than Fluidigm C1. This result is reasonable, since inDrop is a tag-based protocol that is advantageous in capturing more cells but disadvantageous in measuring each cell accurately, compared with the full-length protocol Fluidigm C1. Second, under the same protocol, the optimal cell number depends on the transcriptome similarity of the two cell states. For instance, with Smart-seq2, 512 cells need to be sequenced per state to maximize the recall in identifying DE genes between two dendrocyte subtypes, but only 256 cells per state are needed when dendrocytes are compared with monocytes (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S9</xref>). If the goal is to maximize the F2 score, the optimal cell number for comparing the two dendrocyte subtypes remains 512 per state, but the number reduces to 128 for comparing dendrocytes with monocytes. It is worth noting that the optimal cell number for both comparisons becomes 64, the smallest candidate cell number, when the criterion is the precision or the true negative rate (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>). The reason is that only the genes with strong DE signals are detectable with a small sample size (cell number) in any statistical testing. Hence, with a reasonable lower bound on the cell number, the DE genes detected at a smaller cell number have a higher precision. Unlike the precision, the largest recall in DE analysis is mostly achieved at a medium to large cell number. In all the experimental designs we evaluated, the recall rate of DE genes first increases with the cell number and then decreases after reaching a peak (<xref ref-type="fig" rid="btz321-F2">Fig.&#x000a0;2</xref> and <xref ref-type="supplementary-material" rid="sup1">Table S3</xref>). These results demonstrate the trade-off between the cell number and the cell-wise library size in scRNA-seq experiments. A combination of a small cell number and a large cell-wise library size ensures the identification of the DE genes with strong DE signals (i.e. achieving a high precision rate), but the small cell number may prohibit the detection of the DE genes with small to medium DE signals (i.e. sacrificing the recall rate). On the other hand, a combination of a reasonably large cell number and a small cell-wise library size increases the recall rate in detecting DE genes but compromises the precision rate due to high dropout rates (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S10</xref>). We also performed the DE analysis by replacing the two-sample <italic>t</italic>-test with an scRNA-seq DE method MAST (<xref rid="btz321-B11" ref-type="bibr">Finak <italic>et al.</italic>, 2015</xref>) (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S4</xref>). The optimal cell number remains 64 per state when the criterion is the precision. The optimal cell numbers defined by the recall have small differences from the <italic>t</italic>-test results, but the scale and trend remain largely consistent.
</p><fig id="btz321-F2" orientation="portrait" position="float"><label>Fig. 2.</label><caption><p>Power analysis for DE studies comparing astrocytes and oligodendrocytes scenario (1). The thresholds on the FDRs to identify DE genes are denoted in the color legends. The table summarizes the optimal cell number according to each measure. (<bold>a</bold>) The Fluidigm C1 protocol and (<bold>b</bold>) the inDrop protocol</p></caption><graphic xlink:href="btz321f2"/></fig><p>In scenario (2), the constraint is the total sequencing depth of one experiment with at least two cell states, and the goal is to determine the optimal total cell number for that experiment given a criterion in DE analysis. ScDesign simulates a new count matrix of each cell state based on a real count matrix from the same state, with pre-specified total sequencing depth, total cell number and cell proportions of the two cell states of interest. We applied scDesign to evaluate the designs of 12 example experiments (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S5</xref>). In every experiment, we set the sequencing depth to 100 million reads and considered six cell numbers: 512, 1024, 2048, 4096, 8192 and 16 384. We estimated the cell proportions of the two cell states from the corresponding real data (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S5</xref>). In practical applications of scDesign, the cell state proportions can be inferred from pilot studies, public data or literature (<xref rid="btz321-B12" ref-type="bibr">Gierahn <italic>et al.</italic>, 2017</xref>; <xref rid="btz321-B29" ref-type="bibr">Macosko <italic>et al.</italic>, 2015</xref>).</p><p>In contrast to scenario (1), the optimal total cell number in scenario (2) depends on an additional factor: the cell state proportions, aside from the technical and biological factors we have discussed. The two cell states of interest may present in various proportions depending on biological conditions and experimental protocols, and larger cell state proportions in general reduce the demand of a larger total cell number. For example, the estimated cell state proportions of astrocytes and oligodendrocytes in a human brain sample are 19.2% and 14.9%, respectively (<xref rid="btz321-B8" ref-type="bibr">Darmanis <italic>et al.</italic>, 2015</xref>), and 1024 cells are needed to maximize the recall with Fluidigm C1 (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S11</xref>). In a mouse visual cortex sample, however, the estimated proportions of the same two cell types are 8.8% and 13.1%, respectively, and 16 384 cells are required to achieve the highest recall with inDrop (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S11</xref>). Given an experimental protocol, the optimal total cell number depends on both the two cell state proportions and the magnitude of gene expression differences between the two cell states. For example, the proportions of CD4 cells, CD8 cells and B cells in a human peripheral blood mononuclear sample are 17.2%, 10.2% and 7.3%, respectively (<xref rid="btz321-B12" ref-type="bibr">Gierahn <italic>et al.</italic>, 2017</xref>). Two important facts about this experiment are: first, the proportion of CD8 cells is higher than the proportion of B cells; second, the magnitude of gene expression differences is larger between CD4 and B cells than between CD4 and CD8 cells. With the Seq-Well protocol, the DE analysis of CD4 versus B cells only needs 4096 cells to achieve the highest F1 score. On the other hand, the DE analysis of CD4 versus CD8 requires 16 384 cells to maximize the F1 score (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S12</xref>). To further assess the effects of cell state proportions on DE analysis, we synthesized CD4 and B cells with multiple hypothetical cell proportions: <inline-formula id="IE87"><mml:math id="IM87"><mml:mrow><mml:mn>10</mml:mn><mml:mo>%</mml:mo><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo>%</mml:mo><mml:mo>,</mml:mo><mml:mn>30</mml:mn><mml:mo>%</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mtext>and</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:mn>40</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S13</xref>), among which the mixture of 40% B cells and <inline-formula id="IE88"><mml:math id="IM88"><mml:mrow><mml:mn>20</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mn>30</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> CD4 cells led to the minimum cell number required to maximize the recall and precision. Determining the optimal cell state proportions given a total cell number is especially useful when the cell states of interest can be enriched by fluorescence-activated cell sorting (<xref rid="btz321-B17" ref-type="bibr">Jaitin <italic>et al.</italic>, 2014</xref>) or flow cytometry (<xref rid="btz321-B48" ref-type="bibr">Yen-Rei <italic>et al.</italic>, 2016</xref>) before the sequencing step.</p></sec><sec><title>3.3 scDesign demonstrates reproducibility across studies</title><p>In addition to evaluating the results of scDesign across different cell types and scRNA-seq protocols, we also analyzed the experimental designs of the same cell types and protocols but different datasets, in attempt to assess the reproducibility of scDesign.</p><p>First, we applied scDesign to optimize the pairwise DE analysis between the oligodendrocyte precursor cells (OPCs) and three other brain cell types: differentiation-committed oligodendrocyte precursors (COPs), myelin-forming oligodendrocytes (MFOs) and newly formed oligodendrocytes (NFOs). Two real datasets were collected for each cell type, and the two datasets were generated using the Fluidigm C1 protocol but from different brain regions: dorsal horn and hypothalamus (<xref rid="btz321-B30" ref-type="bibr">Marques <italic>et al.</italic>, 2016</xref>). We applied scDesign in scenario (1), assuming a total sequencing depth of 50 million reads for each cell type. In each experiment, we assumed that the libraries of the two cell types have the same number of cells, and we considered five candidate cell numbers per cell type: 64 128, 256 512 and 1024. The experimental design based on the two brain regions lead to highly consistent results. Both designs show that in a DE analysis between OPCs and COPs, the optimal number of each cell type is 64 if selected by precision or true negative rate, 512 by F2 score and 1024 by recall or F1 score (<xref ref-type="fig" rid="btz321-F3">Fig.&#x000a0;3</xref>); to better compare OPCs and MFOs or NFOs, the optimal number of each cell type is 64 if selected by precision, recall or true negative rate, 128 by F2 score and 64 by F1 score (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S14</xref>). In fact, not only do the two designs identify the same optimal cell number in each case, but they also reveal highly consistent trends about how DE accuracy changes as the number of sequenced cells increases (<xref ref-type="fig" rid="btz321-F3">Fig.&#x000a0;3</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S14</xref>). This example implies the reproducibility of scDesign when taking input data from biological replicates.
</p><fig id="btz321-F3" orientation="portrait" position="float"><label>Fig. 3.</label><caption><p>Reproducibility of scDesign based on data from different brain regions. The DE studies compare OPCs and COPs based on scRNA-seq data from two brain regions: dorsal horn and hypothalamus. When identifying the DE genes, the threshold set on the FDR rate is <inline-formula id="IE89"><mml:math id="IM89"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The <italic>y</italic>-axis of each line are divided by the maximum value of that line for normalization</p></caption><graphic xlink:href="btz321f3"/></fig><p>Second, we applied scDesign to optimize the pairwise DE analysis between three retina cell types: muller glia, amacrine and rods. Two real datasets were collected for each cell type, and the two datasets were generated using the Drop-seq protocol in two independent studies (<xref rid="btz321-B29" ref-type="bibr">Macosko <italic>et al.</italic>, 2015</xref>; <xref rid="btz321-B40" ref-type="bibr">Shekhar <italic>et al.</italic>, 2016</xref>). We applied scDesign in scenario (1), assuming a total sequencing depth of 100 million reads for each cell type. In each experiment, we assumed that the libraries of the two cell types have the same number of cells and considered six candidate cell numbers per cell type: 64, 128, 256, 512, 1024 and 2048. The experimental design based on the single-cell studies lead to highly similar results (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S15</xref>). As in the first example, both designs identified the same optimal cell number regardless of the DE criterion used. The only exception was in the comparison between the muller glia and rods: using the Macosko <italic>et al.</italic> data, the best cell number is 512 by F1 score and 1024 by F2 score, while using the Shekhar <italic>et al.</italic> data, the best cell number is 1024 by F1 score and 512 by F2 score. Such discrepancy is not suprising since we only evaluated a few candidate cell numbers, and the two input datasets inevitably differ in qualities as they came from two studies. Overall, this example demonstrates the reproducibility of scDesign when taking input data from independent studies to design scRNA-seq experiments.</p></sec><sec><title>3.4 scDesign assists scRNA-seq method development</title><p>In addition to assisting single-cell experimental design, scDesign can also simulate scRNA-seq data to benchmark various computational methods for differential gene expression analysis, single cell clustering analysis, gene expression dimension reduction, etc. Due to excess zeros resulting from dropout events and the fact that each gene&#x02019;s expression level in each cell is only measured once, the ground truth of individual genes&#x02019; expression levels in single cells cannot be accurately estimated from scRNA-seq data. Also, cellular identities of individual cells are difficult to pre-determine in most experiments. Lacking the aforementioned ground truth encumbers the development of computational methods to decipher information from scRNA-seq data. Direct evaluation of computational methods relies on experimental validation, which is often unavailable for computationalists, and indirect interpretation from downstream analysis is used instead as a not-so-ideal substitute. Empowered by its ability to generate synthetic scRNA-seq data that well mimic real scRNA-seq data and have ground truth information, scDesign provides a flexible framework to benchmark computational methods for various scRNA-seq data analysis tasks.</p><p>We first demonstrated the application of scDesign to evaluating DE methods. We considered a baseline DE method, i.e. the two-sample <italic>t</italic>-test, and four DE methods [MAST (<xref rid="btz321-B11" ref-type="bibr">Finak <italic>et al.</italic>, 2015</xref>), SCDE (<xref rid="btz321-B19" ref-type="bibr">Kharchenko <italic>et al.</italic>, 2014</xref>), DESeq2 (<xref rid="btz321-B26" ref-type="bibr">Love <italic>et al.</italic>, 2014</xref>) and edgeR (<xref rid="btz321-B39" ref-type="bibr">Robinson <italic>et al.</italic>, 2010</xref>)] specifically designed for scRNA-seq data. Here both DESeq2 and edgeR denote their single-cell-adapted versions, where gene expression values are weighted by the weights estimated from a zero inflated Negative Binomial model before the statistical testing step (<xref rid="btz321-B45" ref-type="bibr">Van den Berge <italic>et al.</italic>, 2017</xref>) . We evaluated scDesign using real scRNA-seq data of six cell types: dendrocytes (Smart-seq2, 63.6% zero count), oligodendrocytes (Fluidigm C1, 62.9% zero count), interneurons (inDrop, 75.3% zero counts), retinal ganglions (Drop&#x02013;seq, 78.3% zero counts), enterocytes (10x Genomics, 82.0% zero counts) and natural killer cells (Seq-Well, 88.0% zero counts) (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>). Based on the real data of each cell type, we simulated a pair of count matrices, with one matrix representing the given cell type and the other including up-regulated and down-regulated genes (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). In the first setting, we set the percentage of DE genes to 5% and sampled the fold changes of those DE genes&#x02019; expression values uniformly from the interval <inline-formula id="IE90"><mml:math id="IM90"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. Then we evaluated the performance of the five DE methods by comparing the areas under their precision&#x02013;recall curves (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S16</xref>). With Smart-seq2 and Fluidigm C1, MAST and SCDE were the only two methods that achieved better accuracy than the two-sample <italic>t</italic>-test, but overall the three methods had comparable precision and recall. With inDrop and 10x Genomics, edgeR became the best DE method, followed by MAST and SCDE. With Drop-seq and Seq-Well, the most accurate method was SCDE, and the baseline two-sample <italic>t</italic>-test had poor performance. These simulation results suggest that scRNA-seq data from the 10x, inDrop, Drop-seq and Seq-Well protocols need more specialized statistical modeling in the DE analysis, compared with Smart-seq2 and Fluidigm C1. In the second setting, we set the percentage of up-regulated and down-regulated genes in each comparison to 10% and sampled the fold changes of these DE genes uniformly from the interval <inline-formula id="IE91"><mml:math id="IM91"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. Since the magnitude of fold changes increased, the DE methods overall demonstrated improved accuracy (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S17</xref>), but the relative accuracy of the five DE methods was consistent with that under the first setting.</p><p>We next demonstrated the application of scDesign to comparing dimension reduction methods. We considered four methods: principal component analysis (PCA), <italic>t</italic>-distributed stochastic neighbor embedding (tSNE) (<xref rid="btz321-B28" ref-type="bibr">Maaten and Hinton, 2008</xref>), independent component analysis (ICA) (<xref rid="btz321-B16" ref-type="bibr">Hyv&#x000e4;rinen and Oja, 2000</xref>) and ZINB-WaVE (<xref rid="btz321-B37" ref-type="bibr">Risso <italic>et al.</italic>, 2018</xref>). We evaluated scDesign based on the same real scRNA-seq data used in the comparison of DE methods. Based on the real data of each cell type, we simulated a set of synthetic count matrices, representing multiple cell states following a differentiation path (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). For the Smart-seq2 and Fluidigm C1 protocols, we simulated four cell states with two states each having 80 cells and the other two each having 50 cells. For the other four protocols, we simulated five cell states with two states each having 300 cells and the other three each having 100 cells. In each case, we first simulated the cell state at the starting point of differentiation based on the real data, and then we simulated each of the three subsequent cell states with 1% of up-regulated and down-regulated genes from its previous state. In addition, we sampled the fold changes of those DE genes&#x02019; expression values uniformly from <inline-formula id="IE92"><mml:math id="IM92"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. Among the four dimension reduction methods, ZINB-WaVE had the best performance in grouping cells into biologically meaningful clusters based on the C1 data, followed by the tSNE method (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S18</xref>). Based on the Smart-Seq2 data, PCA had the best performance in the 2D space, followed by ZINB-WaVE (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S19</xref>). However, the comparison results were different for droplet-based protocols. The tSNE method led to the most accurate cell clusters for the Drop-seq, inDrop, 10x and Seq-Well protocols, followed by ICA or PCA (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S20&#x02013;S23</xref>). In addition to the clustering performance, another factor worth noting is that PCA, ICA and ZINB-WaVE generate comparable cell&#x02212;cell distances after dimension reduction, but tSNE does not. The above results demonstrate the capacity of scDesign in helping developers evaluate competing computational methods for the same purpose (e.g. DE analysis or dimension reduction), and in assisting users to select the appropriate method for analyzing scRNA-seq data from a specific protocol.</p></sec></sec><sec><title>4 Discussion</title><p>The scRNA-seq technologies have become an essential tool for studying various biological and biomedical problems, but one unresolved challenge is how to balance the trade-off between exploring the depth or breadth of transcriptome information in experimental design. We introduce scDesign, the first statistical and computational simulator that enables rational and practical scRNA-seq experimental design. By integrating statistical assumptions and real scRNA-seq datasets from public repositories into its generative framework, scDesign is able to mimic real experimental processes and simulate synthetic scRNA-seq datasets that well capture gene expression characteristics in real data. In addition, scDesign is a flexible and reproducible simulator that is capable of modeling protocol-specific scRNA-seq data generated under multiple biological and experimental conditions. We conducted a comprehensive comparison of scDesign and four other scRNA-seq simulation methods based on datasets from 17 different cell types and 6 experimental protocols. The comparison suggests that scDesign generates synthetic data with the largest resemblance to real scRNA-seq data regardless of cell types and protocols.</p><p>Using its simulated data, scDesign performs power analysis on differential gene expression analysis to provide a quantitative and objective standard for designing future experiments. In the context of differential gene expression analysis between two cell states, scDesign suggests an optimal cell number given a fixed sequencing depth, in the trade-off between a deeper sequencing of a smaller number of cells or a shallower sequencing of a larger number of cells. Specifically, we demonstrated the application of scDesign in two scenarios, where cells from the two states are sequenced as two separate libraries or as one pooled library. We evaluated the experimental designs for 14 and 12 scRNA-seq studies under the two scenarios, respectively. Our results for the first time demonstrate how the optimal experimental design for DE analysis depends on the scRNA-seq protocol and the intra- and inter-cell state transcriptome heterogeneity. In addition, our results revealed a general phenomenon that a deeper sequencing of a smaller number of cells leads to a higher precision in DE analysis. In contrast to the precision, maximizing the recall of DE analysis requires finding a balance between the cell-wise sequencing depth and the cell number, because our results show that the recall first increases and then decreases as we increase the cell number with the total sequencing depth fixed. ScDesign enables researchers to design effective scRNA-seq experiments without pre-experimental costs in an objective manner, for example, guided by the expected power in downstream DE analysis. In addition, we demonstrate that scDesign leads to reproducible experimental design for target cell states given data generated in different studies.</p><p>Aside from enhancing future experimental design, another main contribution of scDesign is to assist computational method development for scRNA-seq. Since large-scale benchmark data are not yet available in the field, computationalists typically rely on scRNA-seq datasets from public repositories to test and evaluate new methods and algorithms. However, quality control and normalization of real data are themselves ongoing research questions, making the evaluation results in many method papers not comparable nor reproducible (<xref rid="btz321-B31" ref-type="bibr">McCarthy <italic>et al.</italic>, 2017</xref>; <xref rid="btz321-B52" ref-type="bibr">Ziegenhain <italic>et al.</italic>, 2017</xref>). To tackle this challenge, scDesign allows users to generate synthetic scRNA-seq datasets with user-specified experimental protocols, sequencing depths, cell states, cell numbers, as well as pre-specified DE genes. Given that scDesign generates synthetic data that have known truth and well mimic real data, users can leverage its synthetic data to comprehensively evaluate computational and statistical methods in a flexible, reproducible and comparable way. For example, we compared five DE methods (the two-sample <italic>t</italic>-test, MAST, SCDE, DESeq2 and edgeR) and four dimension reduction methods (PCA, tSNE, ICA and ZINB-WaVE) using synthetic data generated by scDesign. Those comparison results provide useful guidance for researchers to select the most appropriate computational method to analyze real data.</p><p>We expect scDesign to assist scRNA-seq experimental design for a vast array of available experimental protocols. ScDesign incorporates real scRNA-seq data into its statistical framework to make flexible decisions based on the protocol and cell states used in the target study. If the real data of the two cell states are not generated from the same experiment, it is recommended to first correct the batch effect before applying scDesign (<xref rid="btz321-B4" ref-type="bibr">Butler <italic>et al.</italic>, 2018</xref>; <xref rid="btz321-B14" ref-type="bibr">Haghverdi <italic>et al.</italic>, 2018</xref>). To extend scDesign&#x02019;s ability to evaluate experimental designs for cell states whose scRNA-seq data are not yet publicly available, a future direction is to incorporate bulk RNA-seq data of the same type as a surrogate to estimate the gene expression parameters. Otherwise, pilot experiments need to be conducted to collect data for experimental design, which is also a widely adopted practice (<xref rid="btz321-B7" ref-type="bibr">Chatterjee <italic>et al.</italic>, 2018</xref>). Another future extension of scDesign is to find the optimal design in the context of other types of downstream analyses besides the differential gene expression analysis, such as the detection of novel cell sub-types or the recovery of temporal transcriptome trajectories (<xref rid="btz321-B9" ref-type="bibr">Dumitrascu <italic>et al.</italic>, 2018</xref>). For instance, we may jointly learn the proportions and the gene expression profiles of multiple cell states from real scRNA-seq data and use them as input into our simulation framework to evaluate how the power of detecting rare cell types changes with experimental parameters. Given time-series scRNA-seq data, the scDesign framework can be modified to conduct ANOVA or more advanced statistical analysis to objectively select cell numbers for multiple time points. It is also possible to generalize the simulation framework of scDesign to account for more complex trajectories in the cell differentiation process (<xref rid="btz321-B5" ref-type="bibr">Cannoodt <italic>et al.</italic>, 2019</xref>; <xref rid="btz321-B32" ref-type="bibr">Papadopoulos <italic>et al.</italic>, 2019</xref>). We expect scDesign to be an effective bioinformatic tool that assists rational scRNA-seq experiment design and benchmarks competing scRNA&#x02013;seq computational methods based on specific research goals.</p></sec><sec><title>Funding</title><p>This work was supported by the following grants: UCLA Dissertation Year Fellowship (to W.V.L.); and National Science Foundation [DMS-1613338, DBI-1846216]; National Institutes of Health/NIGMS [R01GM120507]; PhRMA Foundation Research Starter Grant in Informatics; Johnson &#x00026; Johnson WiSTEM2D Award and Sloan Research Fellowship (to J.J.L.).</p><p>
<italic>Conflict of Interest</italic>: none declared.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="sup1"><label>btz321_Supplementary_Data</label><media xlink:href="btz321_supplementary_data.pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ref-list id="ref1"><title>References</title><ref id="btz321-B1"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Abugessaisa</surname><given-names>I.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>SCPortalen: human and mouse single-cell centric database</article-title>. <source>Nucleic Acids Res</source>., <volume>46</volume>, <fpage>D781</fpage>&#x02013;<lpage>D787</lpage>.<pub-id pub-id-type="pmid">29045713</pub-id></mixed-citation></ref><ref id="btz321-B2"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Bacher</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Kendziorski</surname><given-names>C.</given-names></name></person-group> (<year>2016</year>) 
<article-title>Design and computational analysis of single-cell RNA-sequencing experiments</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>63</fpage>.<pub-id pub-id-type="pmid">27052890</pub-id></mixed-citation></ref><ref id="btz321-B3"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Baran-Gale</surname><given-names>J.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Experimental design for single-cell RNA sequencing</article-title>. <source>Brief. Funct. Genomics</source>, <volume>17</volume>, <fpage>233</fpage>&#x02013;<lpage>239</lpage>.</mixed-citation></ref><ref id="btz321-B4"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Butler</surname><given-names>A.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat. Biotechnol</source>., <volume>36</volume>, <fpage>411.</fpage><pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation></ref><ref id="btz321-B5"><mixed-citation publication-type="book">
<person-group person-group-type="author"><name name-style="western"><surname>Cannoodt</surname><given-names>R.</given-names></name></person-group>
<etal>et al</etal> (<year>2019</year>) <chapter-title>Dynbenchmark: accuracy, scalability, robustness and usability of single-cell trajectory inference methods</chapter-title> In: <source>Single Cell Biology, Breckenridge, CO</source>, January 13, 2019.</mixed-citation></ref><ref id="btz321-B6"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Cao</surname><given-names>Y.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>scRNASeqDB: a database for RNA-seq based gene expression profiles in human single cells</article-title>. <source>Genes</source>, <volume>8</volume>, <fpage>368.</fpage></mixed-citation></ref><ref id="btz321-B7"><mixed-citation publication-type="book">
<person-group person-group-type="author"><name name-style="western"><surname>Chatterjee</surname><given-names>A.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) <chapter-title>A guide for designing and analyzing RNA-seq data</chapter-title> In <source>Gene Expression Analysis</source>. 
<publisher-name>Humana Press</publisher-name>, 
<publisher-loc>New York, NY</publisher-loc>, pp. <fpage>35</fpage>&#x02013;<lpage>80</lpage>.</mixed-citation></ref><ref id="btz321-B8"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Darmanis</surname><given-names>S.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>A survey of human brain transcriptome diversity at the single cell level</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>112</volume>, <fpage>7285</fpage>&#x02013;<lpage>7290</lpage>.<pub-id pub-id-type="pmid">26060301</pub-id></mixed-citation></ref><ref id="btz321-B9"><mixed-citation publication-type="other">
<person-group person-group-type="author"><name name-style="western"><surname>Dumitrascu</surname><given-names>B.</given-names></name></person-group>
<etal>et al</etal> (<year>2018a</year>) GT-TS: experimental design for maximizing cell type discovery in single-cell data. bioRxiv, doi:10.1101/386540.</mixed-citation></ref><ref id="btz321-B10"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Edgar</surname><given-names>R.</given-names></name></person-group>
<etal>et al</etal> (<year>2002</year>) 
<article-title>Gene Expression Omnibus: NCBI gene expression and hybridization array data repository</article-title>. <source>Nucleic Acids Res</source>., <volume>30</volume>, <fpage>207</fpage>&#x02013;<lpage>210</lpage>.<pub-id pub-id-type="pmid">11752295</pub-id></mixed-citation></ref><ref id="btz321-B11"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Finak</surname><given-names>G.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>Mast: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>278</fpage>.<pub-id pub-id-type="pmid">26653891</pub-id></mixed-citation></ref><ref id="btz321-B12"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Gierahn</surname><given-names>T.M.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Seq-well: portable, low-cost RNA sequencing of single cells at high throughput</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>395.</fpage><pub-id pub-id-type="pmid">28192419</pub-id></mixed-citation></ref><ref id="btz321-B13"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Gr&#x000fc;n</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>van Oudenaarden</surname><given-names>A.</given-names></name></person-group> (<year>2015</year>) 
<article-title>Design and analysis of single-cell sequencing experiments</article-title>. <source>Cell</source>, <volume>163</volume>, <fpage>799</fpage>&#x02013;<lpage>810</lpage>.<pub-id pub-id-type="pmid">26544934</pub-id></mixed-citation></ref><ref id="btz321-B14"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Haghverdi</surname><given-names>L.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors</article-title>. <source>Nat. Biotechnol</source>., <volume>36</volume>, <fpage>421.</fpage><pub-id pub-id-type="pmid">29608177</pub-id></mixed-citation></ref><ref id="btz321-B15"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Haque</surname><given-names>A.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>A practical guide to single-cell RNA-sequencing for biomedical research and clinical applications</article-title>. <source>Genome Med</source>., <volume>9</volume>, <fpage>75.</fpage><pub-id pub-id-type="pmid">28821273</pub-id></mixed-citation></ref><ref id="btz321-B16"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Hyv&#x000e4;rinen</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Oja</surname><given-names>E.</given-names></name></person-group> (<year>2000</year>) 
<article-title>Independent component analysis: algorithms and applications</article-title>. <source>Neural Netw</source>., <volume>13</volume>, <fpage>411</fpage>&#x02013;<lpage>430</lpage>.<pub-id pub-id-type="pmid">10946390</pub-id></mixed-citation></ref><ref id="btz321-B17"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Jaitin</surname><given-names>D.A.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>Massively parallel single-cell RNA-seq for marker-free decomposition of tissues into cell types</article-title>. <source>Science</source>, <volume>343</volume>, <fpage>776</fpage>&#x02013;<lpage>779</lpage>.<pub-id pub-id-type="pmid">24531970</pub-id></mixed-citation></ref><ref id="btz321-B18"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Jiang</surname><given-names>L.</given-names></name></person-group>
<etal>et al</etal> (<year>2011</year>) 
<article-title>Synthetic spike-in standards for RNA-seq experiments</article-title>. <source>Genome Res</source>., <volume>21</volume>, <fpage>1543</fpage>&#x02013;<lpage>1551</lpage>.<pub-id pub-id-type="pmid">21816910</pub-id></mixed-citation></ref><ref id="btz321-B19"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Kharchenko</surname><given-names>P.V.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>Bayesian approach to single-cell differential expression analysis</article-title>. <source>Nat. Methods</source>, <volume>11</volume>, <fpage>740</fpage>&#x02013;<lpage>742</lpage>.<pub-id pub-id-type="pmid">24836921</pub-id></mixed-citation></ref><ref id="btz321-B20"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Kivioja</surname><given-names>T.</given-names></name></person-group>
<etal>et al</etal> (<year>2012</year>) 
<article-title>Counting absolute numbers of molecules using unique molecular identifiers</article-title>. <source>Nat. Methods</source>, <volume>9</volume>, <fpage>72.</fpage></mixed-citation></ref><ref id="btz321-B21"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Klein</surname><given-names>A.M.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>. <source>Cell</source>, <volume>161</volume>, <fpage>1187</fpage>&#x02013;<lpage>1201</lpage>.<pub-id pub-id-type="pmid">26000487</pub-id></mixed-citation></ref><ref id="btz321-B22"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Kolodziejczyk</surname><given-names>A.A.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>The technology and biology of single-cell RNA sequencing</article-title>. <source>Mol. Cell</source>, <volume>58</volume>, <fpage>610</fpage>&#x02013;<lpage>620</lpage>.<pub-id pub-id-type="pmid">26000846</pub-id></mixed-citation></ref><ref id="btz321-B23"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Korthauer</surname><given-names>K.D.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>A statistical approach for identifying differential distributions in single-cell RNA-seq experiments</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>222.</fpage><pub-id pub-id-type="pmid">27782827</pub-id></mixed-citation></ref><ref id="btz321-B24"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>W.V.</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>J.J.</given-names></name></person-group> (<year>2018a</year>) 
<article-title>An accurate and robust imputation method scimpute for single-cell RNA-seq data</article-title>. <source>Nat. Commun</source>., <volume>9</volume>, <fpage>997</fpage>.<pub-id pub-id-type="pmid">29520097</pub-id></mixed-citation></ref><ref id="btz321-B25"><mixed-citation publication-type="other">
<person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>W.V.</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>J.J.</given-names></name></person-group> (<year>2018b</year>) Modeling and analysis of RNA-seq data: a review from a statistical perspective. arXiv preprint arXiv: 1804.06050.</mixed-citation></ref><ref id="btz321-B26"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Love</surname><given-names>M.I.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>550.</fpage><pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation></ref><ref id="btz321-B27"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Lun</surname><given-names>A.T.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>75.</fpage><pub-id pub-id-type="pmid">27122128</pub-id></mixed-citation></ref><ref id="btz321-B28"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Maaten</surname><given-names>L.V.D.</given-names></name>, <name name-style="western"><surname>Hinton</surname><given-names>G.</given-names></name></person-group> (<year>2008</year>) 
<article-title>Visualizing data using t-SNE</article-title>. <source>J. Mach. Learn. Res</source>., <volume>9</volume>, <fpage>2579</fpage>&#x02013;<lpage>2605</lpage>.</mixed-citation></ref><ref id="btz321-B29"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Macosko</surname><given-names>E.Z.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>. <source>Cell</source>, <volume>161</volume>, <fpage>1202</fpage>&#x02013;<lpage>1214</lpage>.<pub-id pub-id-type="pmid">26000488</pub-id></mixed-citation></ref><ref id="btz321-B30"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Marques</surname><given-names>S.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>Oligodendrocyte heterogeneity in the mouse juvenile and adult central nervous system</article-title>. <source>Science</source>, <volume>352</volume>, <fpage>1326</fpage>&#x02013;<lpage>1329</lpage>.<pub-id pub-id-type="pmid">27284195</pub-id></mixed-citation></ref><ref id="btz321-B31"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>McCarthy</surname><given-names>D.J.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Scater: pre-processing, quality control, normalization and visualization of single-cell RNA-seq data in R</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>1179</fpage>&#x02013;<lpage>1186</lpage>.<pub-id pub-id-type="pmid">28088763</pub-id></mixed-citation></ref><ref id="btz321-B32"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Papadopoulos</surname><given-names>N.</given-names></name></person-group>
<etal>et al</etal> (<year>2019</year>) 
<article-title>PROSSTT: probabilistic simulation of single-cell RNA-seq data for complex differentiation processes</article-title>. <source>Bioinformatics</source>.</mixed-citation></ref><ref id="btz321-B33"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Picelli</surname><given-names>S.</given-names></name></person-group>
<etal>et al</etal> (<year>2013</year>) 
<article-title>Smart-seq2 for sensitive full-length transcriptome profiling in single cells</article-title>. <source>Nat. Methods</source>, <volume>10</volume>, <fpage>1096.</fpage><pub-id pub-id-type="pmid">24056875</pub-id></mixed-citation></ref><ref id="btz321-B34"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Pierson</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Yau</surname><given-names>C.</given-names></name></person-group> (<year>2015</year>) 
<article-title>ZIFA: dimensionality reduction for zero-inflated single-cell gene expression analysis</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>241.</fpage><pub-id pub-id-type="pmid">26527291</pub-id></mixed-citation></ref><ref id="btz321-B35"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Pollen</surname><given-names>A.A.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>Low-coverage single-cell mRNA sequencing reveals cellular heterogeneity and activated signaling pathways in developing cerebral cortex</article-title>. <source>Nat. Biotechnol</source>., <volume>32</volume>, <fpage>1053.</fpage><pub-id pub-id-type="pmid">25086649</pub-id></mixed-citation></ref><ref id="btz321-B36"><mixed-citation publication-type="book">
<person-group person-group-type="author"><name name-style="western"><surname>Quinn</surname><given-names>G.P.</given-names></name>, <name name-style="western"><surname>Keough</surname><given-names>M.J.</given-names></name></person-group> (<year>2002</year>) <source>Experimental Design and Data Analysis for Biologists</source>. 
<publisher-name>Cambridge University Press</publisher-name>, Cambridge, England.</mixed-citation></ref><ref id="btz321-B37"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Risso</surname><given-names>D.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>A general and flexible method for signal extraction from single-cell RNA-seq data</article-title>. <source>Nat. Commun</source>., <volume>9</volume>, <fpage>284.</fpage><pub-id pub-id-type="pmid">29348443</pub-id></mixed-citation></ref><ref id="btz321-B38"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Rizzetto</surname><given-names>S.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Impact of sequencing depth and read length on single cell RNA sequencing data of t cells</article-title>. <source>Sci. Rep</source>., <volume>7</volume>, <fpage>12781.</fpage><pub-id pub-id-type="pmid">28986563</pub-id></mixed-citation></ref><ref id="btz321-B39"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Robinson</surname><given-names>M.D.</given-names></name></person-group>
<etal>et al</etal> (<year>2010</year>) 
<article-title>edger: a bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>139</fpage>&#x02013;<lpage>140</lpage>.<pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation></ref><ref id="btz321-B40"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Shekhar</surname><given-names>K.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>Comprehensive classification of retinal bipolar neurons by single-cell transcriptomics</article-title>. <source>Cell</source>, <volume>166</volume>, <fpage>1308</fpage>&#x02013;<lpage>1323</lpage>.<pub-id pub-id-type="pmid">27565351</pub-id></mixed-citation></ref><ref id="btz321-B41"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Skene</surname><given-names>N.G.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Genetic identification of brain cell types underlying schizophrenia</article-title>. <source>Nat. Genet</source>., <volume>50</volume>, <fpage>825</fpage>&#x02013;<lpage>833</lpage>.<pub-id pub-id-type="pmid">29785013</pub-id></mixed-citation></ref><ref id="btz321-B42"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Svensson</surname><given-names>V.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Power analysis of single-cell RNA-sequencing experiments</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>381.</fpage><pub-id pub-id-type="pmid">28263961</pub-id></mixed-citation></ref><ref id="btz321-B43"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Tang</surname><given-names>F.</given-names></name></person-group>
<etal>et al</etal> (<year>2009</year>) 
<article-title>mRNA-seq whole-transcriptome analysis of a single cell</article-title>. <source>Nat. Methods</source>, <volume>6</volume>, <fpage>377.</fpage><pub-id pub-id-type="pmid">19349980</pub-id></mixed-citation></ref><ref id="btz321-B44"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Tirosh</surname><given-names>I.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>Dissecting the multicellular ecosystem of metastatic melanoma by single-cell RNA-seq</article-title>. <source>Science</source>, <volume>352</volume>, <fpage>189</fpage>&#x02013;<lpage>196</lpage>.<pub-id pub-id-type="pmid">27124452</pub-id></mixed-citation></ref><ref id="btz321-B45"><mixed-citation publication-type="other">
<person-group person-group-type="author"><name name-style="western"><surname>Van den Berge</surname><given-names>K</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) zinger: unlocking RNA-seq tools for zero-inflation and single cell applications. bioRxiv, doi:10.1101/157982.</mixed-citation></ref><ref id="btz321-B46"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Vieth</surname><given-names>B.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>powsimr: power analysis for bulk and single cell RNA-seq experiments</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>3486</fpage>&#x02013;<lpage>3488</lpage>.<pub-id pub-id-type="pmid">29036287</pub-id></mixed-citation></ref><ref id="btz321-B47"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Wagner</surname><given-names>A.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>Revealing the vectors of cellular identity with single-cell genomics</article-title>. <source>Nat. Biotechnol</source>., <volume>34</volume>, <fpage>1145.</fpage><pub-id pub-id-type="pmid">27824854</pub-id></mixed-citation></ref><ref id="btz321-B48"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Yen-Rei</surname><given-names>A.Y.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>A protocol for the comprehensive flow cytometric analysis of immune cells in normal and inflamed murine non-lymphoid tissues</article-title>. <source>PLoS One</source>, <volume>11</volume>, <fpage>e0150606.</fpage><pub-id pub-id-type="pmid">26938654</pub-id></mixed-citation></ref><ref id="btz321-B49"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Zappia</surname><given-names>L.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Splatter: simulation of single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>., <volume>18</volume>, <fpage>174.</fpage><pub-id pub-id-type="pmid">28899397</pub-id></mixed-citation></ref><ref id="btz321-B50"><mixed-citation publication-type="other">
<person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>M.J.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) One read per cell per gene is optimal for single-cell RNA-seq. bioRxiv, doi:10.1101/389296.</mixed-citation></ref><ref id="btz321-B51"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Zheng</surname><given-names>G.X.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>14049</fpage>.<pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation></ref><ref id="btz321-B52"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Ziegenhain</surname><given-names>C.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Comparative analysis of single-cell RNA sequencing methods</article-title>. <source>Mol. Cell</source>, <volume>65</volume>, <fpage>631</fpage>&#x02013;<lpage>643</lpage>.<pub-id pub-id-type="pmid">28212749</pub-id></mixed-citation></ref></ref-list></back></article>