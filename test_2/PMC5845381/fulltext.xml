<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id><journal-title-group><journal-title>BMC Bioinformatics</journal-title></journal-title-group><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">5845381</article-id><article-id pub-id-type="publisher-id">2092</article-id><article-id pub-id-type="doi">10.1186/s12859-018-2092-7</article-id><article-categories><subj-group subj-group-type="heading"><subject>Software</subject></subj-group></article-categories><title-group><article-title>An interpretable framework for clustering single-cell RNA-Seq datasets</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Zhang</surname><given-names>Jesse M.</given-names></name><address><email>jessez@stanford.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Fan</surname><given-names>Jue</given-names></name><address><email>juefan7@gmail.com</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Fan</surname><given-names>H. Christina</given-names></name><address><email>cfan@Cellular-Research.com</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Rosenfeld</surname><given-names>David</given-names></name><address><email>David.Rosenfeld@bd.com</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1460-5900</contrib-id><name><surname>Tse</surname><given-names>David N.</given-names></name><address><email>dntse@stanford.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000000419368956</institution-id><institution-id institution-id-type="GRID">grid.168010.e</institution-id><institution>Department of Electrical Engineering, Stanford, </institution></institution-wrap>Stanford, 94305 California USA </aff><aff id="Aff2"><label>2</label>BD Genomics, California, 94025 Menlo Park USA </aff></contrib-group><pub-date pub-type="epub"><day>9</day><month>3</month><year>2018</year></pub-date><pub-date pub-type="pmc-release"><day>9</day><month>3</month><year>2018</year></pub-date><pub-date pub-type="collection"><year>2018</year></pub-date><volume>19</volume><elocation-id>93</elocation-id><history><date date-type="received"><day>22</day><month>11</month><year>2017</year></date><date date-type="accepted"><day>28</day><month>2</month><year>2018</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2018</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p>With the recent proliferation of single-cell RNA-Seq experiments, several methods have been developed for unsupervised analysis of the resulting datasets. These methods often rely on unintuitive hyperparameters and do not explicitly address the subjectivity associated with clustering.</p></sec><sec><title>Results</title><p>In this work, we present DendroSplit, an interpretable framework for analyzing single-cell RNA-Seq datasets that addresses both the clustering interpretability and clustering subjectivity issues. DendroSplit offers a novel perspective on the single-cell RNA-Seq clustering problem motivated by the definition of &#x0201c;cell type&#x0201d;, allowing us to cluster using feature selection to uncover multiple levels of biologically meaningful populations in the data. We analyze several landmark single-cell datasets, demonstrating both the method&#x02019;s efficacy and computational efficiency.</p></sec><sec><title>Conclusion</title><p>DendroSplit offers a clustering framework that is comparable to existing methods in terms of accuracy and speed but is novel in its emphasis on interpretabilty. We provide the full DendroSplit software package at <ext-link ext-link-type="uri" xlink:href="https://github.com/jessemzhang/dendrosplit">https://github.com/jessemzhang/dendrosplit</ext-link>.</p></sec><sec><title>Electronic supplementary material</title><p>The online version of this article (10.1186/s12859-018-2092-7) contains supplementary material, which is available to authorized users.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Single-cell RNA-seq</kwd><kwd>Clustering</kwd><kwd>Feature selection</kwd><kwd>Interpretability</kwd></kwd-group><funding-group><award-group><funding-source><institution>National Human Genome Research Institute</institution></funding-source><award-id>R01HG008164</award-id></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2018</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p>In recent years, single-cell RNA-Seq has proven to be a powerful approach for studying biological samples in various settings [<xref ref-type="bibr" rid="CR1">1</xref>]. Scientists have leveraged this technology to shed light on how cells differentiate [<xref ref-type="bibr" rid="CR2">2</xref>&#x02013;<xref ref-type="bibr" rid="CR6">6</xref>], investigate known cell types [<xref ref-type="bibr" rid="CR7">7</xref>&#x02013;<xref ref-type="bibr" rid="CR10">10</xref>], and discover new cell types and gene patterns [<xref ref-type="bibr" rid="CR11">11</xref>&#x02013;<xref ref-type="bibr" rid="CR17">17</xref>]. These efforts have yielded a plethora of diverse datasets sharing characteristics such as missing entries (drop-out events) and high dimensionality. Additionally, technological breakthroughs such as droplet encapsulation, molecular barcoding, and cheap parallelization have produced datasets involving tens of thousands and even millions of cells [<xref ref-type="bibr" rid="CR17">17</xref>&#x02013;<xref ref-type="bibr" rid="CR22">22</xref>]. After obtaining such datasets, scientists are often interested in clustering the high-dimensional points corresponding to individual cells, ideally recovering known cell populations while discovering new and perhaps rare cell types. While the definition of a cell type is not precise [<xref ref-type="bibr" rid="CR23">23</xref>], biologists agree that gene expression levels are highly relevant. With gene expression dictating protein expression (and hence cellular function), identifying the genes that distinguish a cell type is of paramount importance. Therefore from a computational perspective, there are two key problems in downstream analysis: 1) clustering and 2) feature selection, also known as differential expression.</p><p>General-purpose clustering algorithms such as <italic>K</italic>-means, DBSCAN [<xref ref-type="bibr" rid="CR24">24</xref>], affinity propagation [<xref ref-type="bibr" rid="CR25">25</xref>], and spectral clustering [<xref ref-type="bibr" rid="CR26">26</xref>] have performed well for several single-cell datasets [<xref ref-type="bibr" rid="CR27">27</xref>]. In order to achieve good performance, however, the datasets often need to be carefully preprocessed, and the algorithms require non-intuitive hyperparameter tuning. For example, both <italic>K</italic>-means and spectral clustering require choosing the desired number of clusters, DBSCAN requires choosing the max distance between two samples in the same neighborhood, and affinity propagation requires choosing both a preference parameter for determining which points are exemplars and a damping parameter for avoiding numerical oscillations. To address specific computational challenges of single-cell RNA-Seq datasets, researchers have developed a wide array of application-specific clustering algorithms [<xref ref-type="bibr" rid="CR28">28</xref>&#x02013;<xref ref-type="bibr" rid="CR34">34</xref>] and packages for end-to-end analysis [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR35">35</xref>&#x02013;<xref ref-type="bibr" rid="CR39">39</xref>]. Regardless of which set of these tools one uses, finding the right approach for clustering a specific dataset requires careful design of the computational workflow, but often finding a good combination of clustering algorithm and hyperparameters is time-consuming and difficult. Additionally, none of these approaches explicitly addresses the inherent subjectiveness behind clustering, which stems from the potential existence of subtypes and sub-subtypes.</p><p>With an emphasis on interpretability and ease of exploratory analysis, we introduce DendroSplit, a framework for clustering single-cell RNA-Seq data. In addition to speed, the framework has the following advantages: 
<list list-type="bullet"><list-item><p>Gene-based justification for all decisions made when generating clusters</p></list-item><list-item><p>Interpretable hyperparameters</p></list-item><list-item><p>Ability to cheaply produce multiple clusterings for the same dataset</p></list-item><list-item><p>Ease of incorporation into existing single-cell RNA-Seq workflows</p></list-item></list></p><p>At a high level, the approach leverages a feature selection algorithm to generate biologically meaningful clusters. The end-to-end DendroSplit workflow is illustrated in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>a. After preprocessing the <italic>N</italic>&#x000d7;<italic>M</italic> expression matrix <italic>X</italic> (where <italic>N</italic> and <italic>M</italic> represent the number of cells and genes, respectively), we generate the <italic>N</italic>&#x000d7;<italic>N</italic> distance matrix <italic>D</italic>. We use hierarchical clustering to iteratively group cells based on their pairwise distances, obtaining a dendrogram, a tree-like data structure illustrating how grouping was performed. The split step starts at the root of the tree. Each node in the dendrogram represents a potential partitioning of a larger cluster into two smaller ones. If this &#x0201c;split&#x0201d; results in two adequately separated clusters (according to a metric we call the <bold>separation score</bold>), the split is deemed valid and the algorithm continues on the new clusters. Otherwise, the algorithm terminates for the subtree below the node. After the split step, DendroSplit performs a pairwise comparison of the resulting clusters, repeatedly merging clusters until all clusters are sufficiently separated. The merge step counteracts the greedy nature of hierarchical clustering, allowing DendroSplit to compare clusters that may have incorrectly ended up far away from one another in the dendrogram. The overall approach involves two intuitive hyperparameters: the separation score threshold for accepting a split, and the separation score threshold for accepting a merge.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of DendroSplit. <bold>a</bold> The workflow starts by preprocessing a <italic>N</italic>&#x000d7;<italic>M</italic> matrix of gene expressions before computing cell-cell pairwise distances, resulting in a <italic>N</italic>&#x000d7;<italic>N</italic> distance matrix. The distance matrix is fed into a hierarchical clustering algorithm to generate a dendrogram. The dynamic splitting step involves recursively splitting the tree into smaller subtrees corresponding to potential clusters. Finally, the subtrees are merged together during a cleanup step to produce final clusters. <bold>b</bold> A split corresponds to the partitioning of a larger cluster into two smaller clusters. A split is only deemed valid if the separation score, a metric for how well-separated two populations are, is above a predefined split threshold. Leveraging biological intuition, we rank how well each gene distinguishes the two subpopulations based on independent Welch&#x02019;s <italic>t</italic>-tests. We use the &#x02013; log of the smallest <italic>p</italic>-value obtained as our separation score due to its interpretability and practical effectiveness. A split threshold of 10 would work for the example shown here. <bold>c</bold> During the merge step, the clusters obtained from the split step are compared to one another using pairwise separation scores. If the closest two clusters are not sufficiently far apart based on a predefined merge threshold, they are merged together and the process is repeated. When all clusters are sufficiently far apart, the algorithm terminates and the final labels are output</p></caption><graphic xlink:href="12859_2018_2092_Fig1_HTML" id="MO1"/></fig></p><p>We use the term &#x0201c;framework&#x0201d; to underline how specific design choices for certain components in the workflow such as the separation score will result in different clustering &#x0201c;methods&#x0201d;. Our choice of separation score is motivated by a key assumption: <bold>if two cell populations are of different types, then there should exist at least one gene that is differentially expressed between the two populations</bold>. Given a candidate split in the dendrogram, we perform a Welch&#x02019;s <italic>t</italic>-test for each gene. The separation score is &#x02212; log(<italic>p</italic><sub>min</sub>) where <italic>p</italic><sub>min</sub> represents the smallest <italic>p</italic>-value achieved (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>b), and we will be using this definition of separation score for all experiments presented in this work. We demonstrate that the deterministic method outlined in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> is applicable to a wide variety of single-cell datasets. We show how DendroSplit can help us investigate the most significant genes considered at each split or merge, providing insight for how clusters are generated. Finally, we show how DendroSplit can cheaply generate several clusterings for different hyperparameter values.</p><p>Some clustering approaches similar to DendroSplit exist in literature. For example, the most common method of generating clusters from a dendrogram involves simply cutting the dendrogram horizontally at some fixed height. This rigid approach often fails to generate meaningful clusters for more complex datasets. The Dynamic Tree Cut algorithm [<xref ref-type="bibr" rid="CR40">40</xref>] adds significant flexibility and processes the dendrogram based on an adaptive cut. Though it does not explicitly use a dendrogram, the backSPIN algorithm [<xref ref-type="bibr" rid="CR12">12</xref>] also uses cell-cell similarities to perform iterative splitting. Unlike DendroSplit, both of these algorithms require choosing unintuitive hyperparameter cutoffs based on nuanced criteria. The most similar clustering approach was used by Lake et al. [<xref ref-type="bibr" rid="CR15">15</xref>] for analyzing their human brain single-cell dataset. Their approach fits into the DendroSplit framework, using a separation score based on random forests. This separation score, compared to the separation score mentioned above, has an element of randomness, is significantly more computationally expensive, and requires less intuitive hyperparameter choices.</p></sec><sec id="Sec2"><title>Implementation</title><sec id="Sec3"><title>Distance metric</title><p>For all single-cell datasets, we used the correlation distance. The correlation distance between <bold>x</bold><sub><italic>i</italic></sub> and <bold>x</bold><sub><italic>j</italic></sub> corresponding to cells <italic>i</italic> and <italic>j</italic> is 
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$d(\mathbf{x}_{i},\mathbf{x}_{j}) = 1-r(\mathbf{x}_{i},\mathbf{x}_{j}) $$ \end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2018_2092_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> where <italic>r</italic> is the Pearson correlation coefficient. Therefore <italic>d</italic> is bounded between 0 and 2. This distance metric has the advantage of being agnostic to both shift and scale, making it robust to certain biases we would expect to vary across datasets. As a caveat, the distance metric has the disadvantage of depending on the number of zeros, and therefore the distance between two cells before and after gene filtering may be different due to removal of entries equal to 0. For all experiments in this work, distance matrix computations were parallelized on 32 cores and computed using the scikit-learn Python package [<xref ref-type="bibr" rid="CR41">41</xref>].</p></sec><sec id="Sec4"><title>Hierarchical clustering</title><p>DendroSplit performs hierarchical clustering using the Scipy Python package [<xref ref-type="bibr" rid="CR42">42</xref>]. One source of ambiguity for hierarchical clustering lies in the method for determining the distance between two clusters. We found that the &#x0201c;complete&#x0201d; method produces the best results, and this is the method used for all experiments reported below. For this method, the distance between two clusters is equal to the largest distance between a point from the first cluster and another point from the second cluster.</p></sec><sec id="Sec5"><title>Separation score</title><p>The separation score effectively serves as a distance metric between two clusters, quantifying how different they are (see the supplementary material for further discussion). The cell-type assumption discussed in the &#x0201c;<xref rid="Sec1" ref-type="sec">Background</xref>&#x0201d; section can also be phrased as: if two cell populations are of different types, then projection along one of the <italic>M</italic> axes should result in two distinguishable point clouds. For all experiments performed in this work, we defined the separation score between the <italic>N</italic><sub>1</sub>&#x000d7;<italic>M</italic> population <bold>X</bold> and the <italic>N</italic><sub>2</sub>&#x000d7;<italic>M</italic> population <bold>Y</bold> as 
<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$s(\mathbf{X},\mathbf{Y}) = -\log_{10}\left(\min_{i} p(\mathbf{X}_{.i},\mathbf{Y}_{.i})\right) $$ \end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>s</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo>min</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>.i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>.i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2018_2092_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> where <italic>p</italic>(<bold>X</bold><sub>.<italic>i</italic></sub>,<bold>Y</bold><sub>.<italic>i</italic></sub>) represents the <italic>p</italic>-value achieved using a Welch&#x02019;s <italic>t</italic>-test for gene <italic>i</italic>. <bold>X</bold><sub>.<italic>i</italic></sub> represents the <italic>i</italic>th column of <bold>X</bold> corresponding to the expression of gene <italic>i</italic> in population <bold>X</bold>. Welch&#x02019;s <italic>t</italic>-test is similar to Student&#x02019;s <italic>t</italic>-test but is more reliable when the two populations have unequal variance and size [<xref ref-type="bibr" rid="CR43">43</xref>]. Compared to other differential expression approaches, Welch&#x02019;s <italic>t</italic>-test is computationally cheap.</p><p>As an implementation note, if for a given split two or more genes have the exact same score, these genes are ranked by the magnitude of the <italic>t</italic> statistic. We note that because we are using Welch&#x02019;s <italic>t</italic>-test rather than Student&#x02019;s <italic>t</italic>-test, the degrees of freedom associated with each test is different, and hence outputting the largest <italic>t</italic> statistic is only approximately sound. Two genes may have the exact same score for larger datasets and for splits near the root of the dendrogram where <italic>p</italic>-values may be quite small, resulting in an underflow issue and a score of <italic>&#x0221e;</italic>.</p></sec><sec id="Sec6"><title>Handling singletons</title><p>In addition to the split and merge thresholds, the two major hyperparameters discussed in the &#x0201c;<xref rid="Sec1" ref-type="sec">Background</xref>&#x0201d; section, the DendroSplit framework can also be customized using three minor hyperparameters. These three hyperparameters are relevant for finding singletons (clusters containing one point), which are analogous to outliers.</p><p>Two of these hyperparameters are relevant for the split step. The first is the minimum cluster size. During a split, if one of the two candidate clusters contains less points than the minimum cluster size, that cluster is disbanded (each of its points are labeled as &#x0201c;Singleton&#x0201d;) and the algorithm continues on the other candidate. The second hyperparameter is the disband percentile. If a candidate split does not produce a subtree that meets the minimum cluster size requirement or if the candidate split does not achieve a high enough separation score, we look at the pairwise distances amongst samples in this final cluster. If all of them are greater than a certain percentile of distances in <italic>D</italic>, the original <italic>N</italic>&#x000d7;<italic>N</italic> distance matrix, then all points in this final cluster are marked as singletons. For all experiments performed in this work, the minimum cluster size was set to 2 (the smallest value) and the disband percentile was set to 50.</p><p>Before merging clusters, each singleton obtained during the split step is assigned to the same cluster as its nearest neighbor. If the distance between a singleton and its nearest neighbor is greater than a certain percentile of all pairwise distances in <italic>D</italic>, then the singleton remains unclassified. This percentile is the third minor hyperparameter and was set to 90 for all experiments performed in this work.</p></sec><sec id="Sec7"><title>Hyperparameter sweeping</title><p>When choosing hyperparameters for DendroSplit, a relatively small split threshold such as 20 and a merge threshold set to half the split threshold often yields reasonable initial results. The DendroSplit approach can also rapidly generate several clusterings based on different split thresholds. Since DendroSplit saves the <italic>p</italic>-values and cell IDs considered at each split, we can obtain several split-step clustering results by exploiting the fact that the clusters generated with a smaller score threshold partition the clusters generated with a larger score threshold. The merge threshold can then be chosen by looking at pairwise separation scores between clusters.</p></sec></sec><sec id="Sec8" sec-type="results"><title>Results</title><sec id="Sec9"><title>Data preprocessing</title><p>For all single-cell datasets, we apply a logarithmic transformation log10(<italic>X</italic>+1) to the raw expression levels. We analyze 9 datasets in this paper. For each dataset, genes that have 0 expression across all cells were removed. Additionally, all datasets consisting of over 1000 cells undergo feature selection based on the method proposed by Macosko et al. [<xref ref-type="bibr" rid="CR20">20</xref>] The <italic>M</italic> genes are sorted into equal-sized bins depending on their mean expression values. Within a bin, genes are <italic>z</italic>-normalized based on their dispersions, where the dispersion for a gene is defined as the variance divided by the mean. Only genes corresponding to a <italic>z</italic>-score above a certain cutoff are retained. For the Zeisel et al. [<xref ref-type="bibr" rid="CR12">12</xref>], Birey et al. [<xref ref-type="bibr" rid="CR17">17</xref>], and Zheng et al. [<xref ref-type="bibr" rid="CR21">21</xref>] datasets, we use DendroSplit&#x02019;s default setting of 5 bins with a <italic>z</italic>-cutoff of 1.5. For the Macosko et al. dataset, we first remove cells with less than 900 counts across all genes just like in Wang et al.&#x02019;s [<xref ref-type="bibr" rid="CR30">30</xref>] approach, reducing the original 44808 cells to 11040. We then use Macosko et al.&#x02019;s gene-filtering settings of 20 bins with a <italic>z</italic>-cutoff of 1.7. For the Zheng et al. dataset, reducing the number of genes results in several of the original 68579 cells having few and even 0 counts across all genes. We remove cells with less than 50 counts across all genes, resulting in 17426 cells, and again filtered out genes with 0 counts across all remaining cells. We also experimented with standardizing all log-transformed genes to have 0 mean and unit variance across all cells, but the increased computational overhead did not yield better results.</p></sec><sec id="Sec10"><title>Adjusted Rand index</title><p>The adjusted Rand index (ARI) is used to quantify how our clustering results match another given set of labels. The ARI ranges from 0 for poor matching to 1 for perfectly matched labels. For a set of <italic>n</italic> elements, we let <italic>X</italic> and <italic>Y</italic> represent two partitions of the elements. <italic>X</italic><sub><italic>i</italic></sub> represents the set of elements in partition <italic>i</italic> according to <italic>X</italic>. The adjusted Rand index is defined as: 
<disp-formula id="Equc"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ARI = \frac{\sum_{ij} {n_{ij} \choose 2} - \left[\sum_{i} {a_{i} \choose 2} \sum_{j} {b_{j} \choose 2} \right] / {n \choose 2}} {\frac{1}{2} \left[\sum_{i} {a_{i} \choose 2} + \sum_{j} {b_{j} \choose 2} \right] - \left[\sum_{i} {a_{i} \choose 2} \sum_{j} {b_{j} \choose 2} \right]/ {n \choose 2}} $$ \end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mtext mathvariant="italic">ARI</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mfenced><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mfenced><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2018_2092_Article_Equc.gif" position="anchor"/></alternatives></disp-formula> where <italic>n</italic><sub><italic>ij</italic></sub> is the number of elements in common between <italic>X</italic><sub><italic>i</italic></sub> and <italic>Y</italic><sub><italic>j</italic></sub>, <inline-formula id="IEq1"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$a_{i} = \sum _{k} n_{ik}$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2018_2092_Article_IEq1.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq2"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$b_{j} = \sum _{k} n_{kj}$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">kj</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2018_2092_Article_IEq2.gif"/></alternatives></inline-formula>.</p></sec><sec id="Sec11"><title>Ground-truth datasets</title><p>To test the effectiveness of the DendroSplit framework, we first test the approach on datasets where the ground truth is known.</p><sec id="Sec12"><title>Synthetic datasets</title><p>Figure&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref> shows the performance of DendroSplit on four synthetic datasets [<xref ref-type="bibr" rid="CR44">44</xref>]. Since the 2-dimensional data points have clear, intuitive clustering structure, pairwise Euclidean distance is a natural choice. Figure&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>a shows the exploratory power of DendroSplit on a toy dataset of oddly-oriented clusters. Because DendroSplit saves the information gathered at each valid split, we can easily investigate how the clustering was performed. At a given split, we can identify the points that went into each partition and look at the partition-specific distributions of the feature that validated the split. Thus the true advantage of DendroSplit is in its ability to justify its behavior with interpretable results. Figure&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>b shows that DendroSplit has the power to uncover several clusters especially when the distance metric (Euclidean) suits the type of data (2-D Gaussian balls). Figure&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>c emphasizes that, like other methods, DendroSplit cannot automatically overcome poor choices in preprocessing and distance metric selection.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Synthetic Datasets. <bold>a</bold> The DendroSplit approach is applied to a synthetic 2-dimensional dataset where pairwise distances are equal to the Euclidean distances between points. The dendrogram splitting process can be visualized using a tree, and each box in the tree represents a step in the algorithm where a larger cluster is partitioned into the red and green clusters. For each of the two features (dimensions), the split is evaluated based on the distributions of that feature within the candidate clusters. Teal points are &#x0201c;background&#x0201d; points and not considered for a given step. <bold>b</bold> DendroSplit is evaluated on two other 2-dimensional synthetic datasets and recovers the correct number of clusters both times. Euclidean distance is used. <bold>c</bold> We note that DendroSplit cannot overcome poor preprocessing and distance metric selection. Directly computing Euclidean distances for the points in the concentric circle dataset would yield poor performance, but using Euclidean distance after some preprocessing (e.g. mapping each point to its distance from the center) yields the correct results. For the examples shown here, the merge thresholds are 10, and the split thresholds are 40 for (<bold>a</bold>) and 30 for (<bold>b</bold>, <bold>c</bold>)</p></caption><graphic xlink:href="12859_2018_2092_Fig2_HTML" id="MO2"/></fig></p></sec><sec id="Sec13"><title>Single-cell RNA-Seq datasets</title><p>Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> shows the performance of DendroSplit on four single-cell RNA-Seq datasets featuring high-quality labels. Kiselev et al. [<xref ref-type="bibr" rid="CR34">34</xref>] refers to these datasets as &#x0201c;gold standards&#x0201d;. We chose four datasets with varying amounts of cells, genes, and total clusters to understand how they affect the behavior of DendroSplit. We see that when <italic>N</italic> is on the order of 100s, the runtime is widely determined by <italic>M</italic>, the number of independent Welch&#x02019;s <italic>t</italic>-tests that must be performed at every split. Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> shows that for the Biase et al. [<xref ref-type="bibr" rid="CR2">2</xref>], Pollen et al. [<xref ref-type="bibr" rid="CR8">8</xref>], and Kolodziejcyk et al. [<xref ref-type="bibr" rid="CR5">5</xref>] datasets, most of the final ARI is achieved after the split step. Therefore most of the information captured by the clusters lies in one of the dendrogram&#x02019;s subtrees. Due to how the dendrogram is constructed, a cell may end up being split off into its own cluster and is temporarily labeled as a non-classified &#x0201c;Singleton&#x0201d;. The merge step cleans up singletons and small clusters, resulting in a higher ARI. For the Yan et al. [<xref ref-type="bibr" rid="CR9">9</xref>] dataset, the ARI increases dramatically after the merge step. This is due to the fact that after the split step, 1) 15 of the 124 cells ended up as singletons, and 2) splitting generated twice as many clusters as needed. In fact, for this dataset, dividing each true cluster into two equal-sized parts would result in an ARI of 0.74 when compared with the original labels. A more detailed visual analysis of the Yan et al. dataset is given in Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S1. Under certain conditions, some cells may remain in their own clusters even after the merge step (see &#x0201c;<xref rid="Sec2" ref-type="sec">Implementation</xref>&#x0201d; section). These cells are analogous to outliers.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Gold standard datasets. DendroSplit is evaluated on four single-cell RNA-Seq datasets where the labels are highly likely to be correct [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR34">34</xref>]. In addition to visual inspection, cluster quality is evaluated using the adjusted Rand index (ARI) based on the true labels. We observe here that the split step tends to generate more clusters than expected, shrinking the ARI. Additionally, due to how the dendrogram is constructed, a cell may end up in its own cluster and is consequentially labeled as a &#x0201c;Singleton&#x0201d;. The merge step treats both these cases. The cells are visualized using either the first two principal components (PC) or the first two t-distributed stochastic neighbor embedding [<xref ref-type="bibr" rid="CR63">63</xref>] (t-SNE) components. The reported runtimes include computation of the pairwise distance matrices</p></caption><graphic xlink:href="12859_2018_2092_Fig3_HTML" id="MO3"/></fig></p></sec><sec id="Sec14"><title>Exploratory analysis</title><p>We further demonstrate the exploratory power of DendroSplit on Patel et al.&#x02019;s [<xref ref-type="bibr" rid="CR7">7</xref>] dataset of 430 cells, 5948 features from five primary human glioblastomas. Without any further preprocessing, DendroSplit recovers five clusters corresponding to the five glioblastomas (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>a). Furthermore, DendroSplit can justify its findings by showing us the gene that plays the largest role in validating each split. Splits 4 and 5 in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>b show distinctively how <italic>SEC61G</italic>, for example, distinguishes MGH26 cells from MGH29 and MGH31 cells. The analysis also gives insight on how the hierarchical clustering was performed. The cells from MGH26 were split in half during earlier stages of clustering, which is why they end up in separate superclusters at the root node. This is an artifact of the greedy nature of hierarchical clustering where clusters that should be close together may end up far apart. Merge 1 in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>c shows DendroSplit fixing this. At the same time, we see that <italic>PAN3</italic> may be a valid marker for distinguishing these two subtypes within MGH26 cells. Further analysis and perhaps side information would be needed to decide whether or not these two subtypes are truly different. DendroSplit handles the subjectiveness associated with clustering by showing the factors that contribute to its decisions.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Exploratory analysis on Patel et al. dataset. <bold>a</bold> DendroSplit is evaluated on Patel et al.&#x02019;s dataset of 430 cells, 5948 features (genes) from five primary human glioblastomas [<xref ref-type="bibr" rid="CR7">7</xref>]. Gene expression is quantified using TPM. The split and merge thresholds are 20 and 15, respectively, and the analysis takes 9.64 seconds to run. The numbers in the legends represent the number of points in the corresponding clusters. For the split step, the names of the clusters are generated based on the position of the subtrees in the dendrogram. &#x0201c;r&#x0201d; represents the root node, and &#x0201c;rRL&#x0201d; represents the subtree found at the left child of the right child of the root. <bold>b</bold> We can evaluate how cells were partitioned at each step of the split procedure, and DendroSplit can also show us the within-cluster distributions of the gene that validates the split. <bold>c</bold> We can also evaluate how clusters obtained after the split step were combined during the merge procedure, and DendroSplit can show us the distributions of the most distinguishing gene between two merged clusters</p></caption><graphic xlink:href="12859_2018_2092_Fig4_HTML" id="MO4"/></fig></p></sec></sec><sec id="Sec15"><title>Performance on larger single-cell datasets</title><p>We use DendroSplit to re-analyze three large single-cell RNA-Seq datasets that utilize unique molecular identifiers (UMIs) for quantifying genes [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. Unlike for previous single-cell RNA-Seq datasets, the labels for these datasets were assigned using diverse computational methods. Figure&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref> first shows that performing a feature selection step prior to analysis with DendroSplit decreases the runtime dramatically. In fact, for the Zeisel et al. dataset, filtering out genes using the procedure described by Macosko et al. reduces both <italic>M</italic> and the runtime by a factor of 16.6. Additionally, the filtering out of noisy features improves the quality of the distance metric, and we see that the ARI improves dramatically. We also report that using a much smaller split threshold of 15 results in 43 non-singleton clusters. When compared with Zeisel et al.&#x02019;s 47 subclasses, we achieve an ARI of 0.42. The gene filtering procedure is used for the all datasets presented in Figs.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref> and <xref rid="Fig6" ref-type="fig">6</xref>.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Larger datasets. DendroSplit is evaluated on three large single-cell datasets where the labels were assigned using computational methods [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. Because <italic>M</italic> independent Welch&#x02019;s <italic>t</italic>-tests are performed at each potential split, the runtime of the algorithm scales linearly with <italic>M</italic>. As demonstrated with the Zeisel et al. dataset, decreasing <italic>M</italic> by a factor of 16.6 likewise decreases the runtime by the same factor. The datasets here are preprocessed by filtering out genes using the procedure described by Macosko et al. [<xref ref-type="bibr" rid="CR20">20</xref>]. This preprocessing step also improves the quality of the distance metric used, resulting in better performance</p></caption><graphic xlink:href="12859_2018_2092_Fig5_HTML" id="MO5"/></fig>
<fig id="Fig6"><label>Fig. 6</label><caption><p>Exploratory analysis on PBMC dataset. <bold>a</bold> After gene selection and removal of cells with less than 50 counts across all genes, DendroSplit generates clusters for Zheng et al.&#x02019;s remaining dataset of 17426 cells, 908 features (genes) from fresh peripheral blood mononuclear cells (PBMCs) [<xref ref-type="bibr" rid="CR21">21</xref>]. Gene expression is quantified using UMI counts. The split and merge thresholds are 200 and 100, respectively, and the analysis takes 119.97 seconds to run. <bold>b</bold> 5 of the 15 recorded valid splits are shown along with the expression levels of the top 4 genes used for validating each split. The reported runtimes include computation of the pairwise distance matrices</p></caption><graphic xlink:href="12859_2018_2092_Fig6_HTML" id="MO6"/></fig></p><p>For the three datasets analyzed in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>, DendroSplit generates similar but not identical labels. Figure&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>a shows that DendroSplit disagrees even more strongly on Zheng et al.&#x02019;s dataset of 17426 cells, 908 features from fresh peripheral blood mononuclear cells (PBMCs). Noting that the merge step does not increase the ARI significantly, we focus on the split step labels. Although 15 valid splits were recorded, we investigate only the 5 shown in Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>b. For the remaining splits, see Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S2. Split 1 was validated due to a lack of expression of several genes (<italic>FCGR3A</italic>, <italic>LY86</italic>, <italic>FCN1</italic>, and <italic>IFI30</italic>) in the red population, which we match to the authors&#x02019; CD34+ cells. Split 2 shows the separation of the red cells from the green cells based on high expression of <italic>NKG7</italic> and <italic>GNLY</italic>, markers for natural killer (NK) cells. The green cluster in split 5 likely corresponds to cytotoxic T cells based on increased expression of <italic>GZMH</italic>. The red cluster in split 9 shows greater expression of <italic>CD79A</italic> and may therefore represent B cells. Finally, the red cluster in split 14 does not have an obvious match with any of Zheng et al.&#x02019;s set of labels. DendroSplit shows us that the existence of this cluster is justified based on increased expression of several genes including <italic>FCGR3A</italic>, <italic>CFD</italic>, and <italic>LST1</italic>. A one-versus-rest differential expression analysis based on independent Welch&#x02019;s <italic>t</italic>-tests (see Additional file&#x000a0;<xref rid="MOESM2" ref-type="media">2</xref>: Table S1) further shows that <italic>PSAP</italic> and <italic>SERPINA1</italic> are also overexpressed, indicating that the red cluster (cluster 6 after the merge step in Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>a) corresponds to some type of monocyte. We also repeat this analysis with the full 68579 cells, 20374 genes dataset, and the results are shown in Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S3.</p><p>Finally, Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref> demonstrates the score threshold sweeping procedure for the Kolodziejcyk et al. and Zeisel et al. datasets. As observed in the experiments, larger datasets often require larger thresholds due to the <italic>t</italic>-statistic generally increasing with <italic>N</italic>.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Split threshold sweeping. Since DendroSplit saves all relevant information at each valid split (e.g. <italic>p</italic>-values from Welch&#x02019;s <italic>t</italic>-tests and IDs of cells being compared), we can run the method with a small split threshold to gather information about several potential splits. From this information, we can generate the labels we would have obtained after the split step had we run the algorithm with a larger split threshold. <bold>a</bold> For the 704&#x000d7;13473 Kolodziejczyk et al. [<xref ref-type="bibr" rid="CR5">5</xref>] dataset, running DendroSplit using a split threshold of 2 takes 37.63 seconds, and generating a set of new labels takes 0.032 seconds. <bold>b</bold> For the 3005&#x000d7;1202 Zeisel et al. dataset, running DendroSplit using a split threshold of 2 takes 13.48 seconds, and generating new labels takes 0.403 seconds. For both datasets, the DendroSplit runtimes include computation of the pairwise distance matrices</p></caption><graphic xlink:href="12859_2018_2092_Fig7_HTML" id="MO7"/></fig></p></sec></sec><sec id="Sec16" sec-type="conclusion"><title>Conclusion</title><p>In this work, we presented a novel interpretable framework for tackling the single-cell RNA-Seq clustering problem. We demonstrated that a dendrosplit-splitting approach based on a separation score was key for uncovering the multiple layers of biological information within a dataset. In addition to recovering results from a diverse set of single-cell studies, we showed that the framework could cheaply produce several clusterings of the same dataset. Most importantly, the algorithm could justify each of its decisions in an interpretable way. Thus, DendroSplit is suitable as a backend algorithm for interactive analysis and interpretation.</p><p>With single-cell RNA-Seq technology improving, we can only expect increased cell throughput and larger datasets. While DendroSplit is able to generate clusters without expensive hyperparameter tuning, its optimal split and merge thresholds do depend on the size of the dataset since larger datasets tend to yield smaller <italic>p</italic>-values. To remove this size dependence, one could subsample a larger dataset to the same fixed size multiple times, run DendroSplit on each subsample, and ultimately report some consensus result. Another strategy for handling this dependence is in choosing a dataset-size-correcting statistical test rather than the naive Welch&#x02019;s <italic>t</italic>-test when computing the separation score.</p><p>For the analyses in this work, we used a separation score based on a computationally cheap method of performing differential expression and a simple definition of cell type. Separation scores based on more complex methods of evaluating differential expression such as those presented by [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR45">45</xref>&#x02013;<xref ref-type="bibr" rid="CR51">51</xref>] may yield better results at the cost of greater computation. Additionally, just like for other clustering approaches, existing tools including those designed for outlier detection [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR52">52</xref>], drop-out imputation [<xref ref-type="bibr" rid="CR53">53</xref>], and correcting other sources of technical noise [<xref ref-type="bibr" rid="CR54">54</xref>&#x02013;<xref ref-type="bibr" rid="CR62">62</xref>] can be easily incorporated into the DendroSplit framework by applying the desired correction procedures before the clustering step.</p></sec><sec id="Sec17"><title>Availability and requirements</title><p><bold>Project name</bold>: DendroSplit</p><p><bold>Project home page</bold>: <ext-link ext-link-type="uri" xlink:href="https://github.com/jessemzhang/dendrosplit">https://github.com/jessem-</ext-link><ext-link ext-link-type="uri" xlink:href="https://github.com/jessemzhang/dendrosplit">zhang/dendrosplit</ext-link></p><p><bold>Operating system(s)</bold>: Platform independent</p><p><bold>Programming language</bold>: Python 2.7</p><p><bold>Other requirements</bold>: Python modules numpy 1.12.1, scipy 0.19.0, matplotlib 1.5.3, sklearn 0.18.1, networkx 1.11, community</p><p><bold>License</bold>: Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International license</p><p><bold>Any restrictions to use by non-academics</bold>: License needed</p></sec><sec sec-type="supplementary-material"><title>Additional files</title><sec id="Sec18"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="12859_2018_2092_MOESM1_ESM.pdf"><label>Additional file 1</label><caption><p>Supplementary figures and separation score analysis. A file containing a distance-metric interpretation of separability score along with the three supplementary figures described in the main text: 1) visual analysis of the Yan et al. dataset, 2) further analysis for the splits generated for the Zheng et al. dataset, 3) analysis on the full Zheng et al. dataset. (PDF 3707 kb)</p></caption></media></supplementary-material>
</p><p>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="12859_2018_2092_MOESM2_ESM.tsv"><label>Additional file 2</label><caption><p>PBMC differential expression analysis. A one-versus-rest differential expression analysis based on independent Welch&#x02019;s <italic>t</italic>-tests for the Zheng et al. PBMC dataset of 17426 cells, 908 features described in the main text. (TSV 10 kb)</p></caption></media></supplementary-material>
</p></sec></sec></body><back><glossary><title>Abbreviations</title><def-list><def-item><term>ARI</term><def><p>Adjusted Rand index</p></def></def-item><def-item><term>backSPIN</term><def><p>Back sorting points into neighborhoods</p></def></def-item><def-item><term>DBSCAN</term><def><p>Density-based spatial clustering of applications with noise</p></def></def-item><def-item><term>NK</term><def><p>Natural killer cells</p></def></def-item><def-item><term>PBMC</term><def><p>Peripheral blood mononuclear cells</p></def></def-item><def-item><term>RNA-Seq</term><def><p>Ribonucleic acid sequencing</p></def></def-item></def-list></glossary><fn-group><fn><p><bold>Electronic supplementary material</bold></p><p>The online version of this article (10.1186/s12859-018-2092-7) contains supplementary material, which is available to authorized users.</p></fn></fn-group><ack><title>Acknowledgements</title><p>We thank Govinda Kamath and Vasilis Ntranos for feedback and useful discussions about analyzing single-cell RNA-Seq datasets.</p><sec id="d29e1625"><title>Funding</title><p>JMZ and DNT are supported in part by the National Human Genome Research Institute of the National Institutes of Health under award number R01HG008164. JMZ performed part of this work as an employee of BD genomics.</p></sec><sec id="d29e1630"><title>Availability of data and materials</title><p>The [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR7">7</xref>&#x02013;<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>] datasets were obtained from public repositories. The [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR8">8</xref>] datasets were obtained from the GitHub repository for [<xref ref-type="bibr" rid="CR30">30</xref>].</p></sec></ack><notes notes-type="author-contribution"><title>Authors&#x02019; contributions</title><p>JMZ conceived the idea of splitting dendrograms and merging clusters using <italic>p</italic>-values, wrote the software package, performed analyses of data, interpreted results and wrote the manuscript. JF, HCF, DR, and DNT interpreted results, supervised the project and wrote the manuscript. All authors read and approved the final manuscript.</p></notes><notes notes-type="COI-statement"><sec id="d29e1678"><title>Ethics approval and consent to participate</title><p>Not applicable.</p></sec><sec id="d29e1683"><title>Consent for publication</title><p>Not applicable.</p></sec><sec id="d29e1688"><title>Competing interests</title><p>JMZ is a past employee of BD Genomics. JF, HCF, and DR are past and current employees of BD Genomics.</p></sec><sec id="d29e1693"><title>Publisher&#x02019;s Note</title><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></sec></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1</label><mixed-citation publication-type="other">Yuan GC, et al.Challenges and emerging directions in single-cell analysis. Genome Biol. 2017; 18:84. 10.1186/s13059-017-1218-y.</mixed-citation></ref><ref id="CR2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Biase</surname><given-names>FH</given-names></name><name><surname>Cao</surname><given-names>X</given-names></name><name><surname>Zhong</surname><given-names>S</given-names></name></person-group><article-title>Cell fate inclination within 2-cell and 4-cell mouse embryos revealed by single-cell rna sequencing</article-title><source>Genome Res</source><year>2014</year><volume>24</volume><fpage>1787</fpage><lpage>96</lpage><pub-id pub-id-type="doi">10.1101/gr.177725.114</pub-id><?supplied-pmid 25096407?><pub-id pub-id-type="pmid">25096407</pub-id></element-citation></ref><ref id="CR3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><etal/></person-group><article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title><source>Nat Biotechnol</source><year>2014</year><volume>32</volume><fpage>381</fpage><lpage>6</lpage><pub-id pub-id-type="doi">10.1038/nbt.2859</pub-id><?supplied-pmid 24658644?><pub-id pub-id-type="pmid">24658644</pub-id></element-citation></ref><ref id="CR4"><label>4</label><mixed-citation publication-type="other">Goolam M, et al.Heterogeneity in oct4 and sox2 targets biases cell fate in 4-cell mouse embryos. Cell. 2016; 165:61&#x02013;74. <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/S0092867416300617">http://www.sciencedirect.com/science/article/pii/S0092867416300617</ext-link>.</mixed-citation></ref><ref id="CR5"><label>5</label><mixed-citation publication-type="other">Kolodziejczyk AA, et al.Single cell rna-sequencing of pluripotent states unlocks modular transcriptional variation. Cell Stem Cell. 2015; 17:471&#x02013;85. <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/S193459091500418X">http://www.sciencedirect.com/science/article/pii/S193459091500418X</ext-link>.</mixed-citation></ref><ref id="CR6"><label>6</label><mixed-citation publication-type="other">Treutlein B, et al.Reconstructing lineage hierarchies of the distal lung epithelium using single-cell rna-seq. Nature. 2014; 509:371&#x02013;5. 10.1038/nature13173.</mixed-citation></ref><ref id="CR7"><label>7</label><mixed-citation publication-type="other">Patel AP, et al.Single-cell rna-seq highlights intratumoral heterogeneity in primary glioblastoma. Science. 2014; 344:1396&#x02013;401. <ext-link ext-link-type="uri" xlink:href="http://science.sciencemag.org/content/344/6190/1396">http://science.sciencemag.org/content/344/6190/1396</ext-link>. <ext-link ext-link-type="uri" xlink:href="http://science.sciencemag.org/content/344/6190/1396.full.pdf">http://science.sciencemag.org/content/344/6190/1396.full.pdf</ext-link>.</mixed-citation></ref><ref id="CR8"><label>8</label><mixed-citation publication-type="other">Pollen AA, et al.Low-coverage single-cell mrna sequencing reveals cellular heterogeneity and activated signaling pathways in developing cerebral cortex. Nat Biotech. 2014; 32:1053&#x02013;8. 10.1038/nbt.2967.</mixed-citation></ref><ref id="CR9"><label>9</label><mixed-citation publication-type="other">Yan L, et al.Single-cell rna-seq profiling of human preimplantation embryos and embryonic stem cells. Nat Struct Mol Biol. 2013; 20:1131&#x02013;9. 10.1038/nsmb.2660.</mixed-citation></ref><ref id="CR10"><label>10</label><mixed-citation publication-type="other">Buettner F, et al.Computational analysis of cell-to-cell heterogeneity in single-cell rna-sequencing data reveals hidden subpopulations of cells. Nat Biotech. 2015; 33:155&#x02013;60. 10.1038/nbt.3102.</mixed-citation></ref><ref id="CR11"><label>11</label><mixed-citation publication-type="other">Usoskin D, et al.Unbiased classification of sensory neuron types by large-scale single-cell rna sequencing. Nat Neurosci. 2015; 18:145&#x02013;53. 10.1038/nn.3881.</mixed-citation></ref><ref id="CR12"><label>12</label><mixed-citation publication-type="other">Zeisel A, et al.Cell types in the mouse cortex and hippocampus revealed by single-cell rna-seq. Science. 2015; 347:1138&#x02013;42. <ext-link ext-link-type="uri" xlink:href="http://science.sciencemag.org/content/347/6226/1138">http://science.sciencemag.org/content/347/6226/1138</ext-link>. <ext-link ext-link-type="uri" xlink:href="http://science.sciencemag.org/content/347/6226/1138.full.pdf">http://science.sciencemag.org/content/347/6226/1138.full.pdf</ext-link>.</mixed-citation></ref><ref id="CR13"><label>13</label><mixed-citation publication-type="other">Grun D, et al.Single-cell messenger rna sequencing reveals rare intestinal cell types. Nature. 2015; 525:251&#x02013;5. <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.1038/nature14966">http://doi.org/10.1038/nature14966</ext-link>.</mixed-citation></ref><ref id="CR14"><label>14</label><mixed-citation publication-type="other">Ting DT, et al.Single-cell {RNA} sequencing identifies extracellular matrix gene expression by pancreatic circulating tumor cells. Cell Rep. 2014; 8:1905&#x02013;18. <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/S2211124714007050">http://www.sciencedirect.com/science/article/pii/S2211124714007050</ext-link>.</mixed-citation></ref><ref id="CR15"><label>15</label><mixed-citation publication-type="other">Lake BB, et al.Neuronal subtypes and diversity revealed by single-nucleus rna sequencing of the human brain. Science. 2016; 352:1586&#x02013;90. <ext-link ext-link-type="uri" xlink:href="http://science.sciencemag.org/content/352/6293/1586">http://science.sciencemag.org/content/352/6293/1586</ext-link>. <ext-link ext-link-type="uri" xlink:href="http://science.sciencemag.org/content/352/6293/1586.full.pdf">http://science.sciencemag.org/content/352/6293/1586.full.pdf</ext-link>.</mixed-citation></ref><ref id="CR16"><label>16</label><mixed-citation publication-type="other">Deng Q, Ramsk&#x000f6;ld D, Reinius B, Sandberg R. Single-cell rna-seq reveals dynamic, random monoallelic gene expression in mammalian cells. Science. 2014; 343:193&#x02013;6. <ext-link ext-link-type="uri" xlink:href="http://science.sciencemag.org/content/343/6167/193">http://science.sciencemag.org/content/343/6167/193</ext-link>. <ext-link ext-link-type="uri" xlink:href="http://science.sciencemag.org/content/343/6167/193.full.pdf">http://science.sciencemag.org/content/343/6167/193.full.pdf</ext-link>.</mixed-citation></ref><ref id="CR17"><label>17</label><mixed-citation publication-type="other">Birey F, et al.Assembly of functionally integrated human forebrain spheroids. Nature. 2017; 545:54&#x02013;9. <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.1038/nature22330">http://doi.org/10.1038/nature22330</ext-link>.</mixed-citation></ref><ref id="CR18"><label>18</label><mixed-citation publication-type="other">Fan HC, Fu GK, Fodor SPA. Combinatorial labeling of single cells for gene expression cytometry. Science. 2015;347. <ext-link ext-link-type="uri" xlink:href="http://science.sciencemag.org/content/347/6222/1258367">http://science.sciencemag.org/content/347/6222/1258367</ext-link>. <ext-link ext-link-type="uri" xlink:href="http://science.sciencemag.org/content/347/6222/1258367.full.pdf">http://science.sciencemag.org/content/347/6222/1258367.full.pdf</ext-link>.</mixed-citation></ref><ref id="CR19"><label>19</label><mixed-citation publication-type="other">Klein AM, et al.Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells. Cell. 2015; 161:1187&#x02013;201. <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/S0092867415005000">http://www.sciencedirect.com/science/article/pii/S0092867415005000</ext-link>.</mixed-citation></ref><ref id="CR20"><label>20</label><mixed-citation publication-type="other">Macosko EZ, et al.Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets. Cell. 2015; 161:1202&#x02013;14. <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.1016/j.cell.2015.05.002">http://doi.org/10.1016/j.cell.2015.05.002</ext-link>.</mixed-citation></ref><ref id="CR21"><label>21</label><mixed-citation publication-type="other">Zheng GXY, et al.Massively parallel digital transcriptional profiling of single cells. Nat Commun. 2017; 8:14049. EP &#x02013; <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.1038/ncomms14049">http://doi.org/10.1038/ncomms14049</ext-link>.</mixed-citation></ref><ref id="CR22"><label>22</label><mixed-citation publication-type="other">Cao J, et al.Comprehensive single-cell transcriptional profiling of a multicellular organism. Science. 2017; 357:661&#x02013;7. <ext-link ext-link-type="uri" xlink:href="http://science.sciencemag.org/content/357/6352/661">http://science.sciencemag.org/content/357/6352/661</ext-link>. <ext-link ext-link-type="uri" xlink:href="http://science.sciencemag.org/content/357/6352/661.full.pdf">http://science.sciencemag.org/content/357/6352/661.full.pdf</ext-link>.</mixed-citation></ref><ref id="CR23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name></person-group><article-title>Defining cell types and states with single-cell genomics</article-title><source>Genome Res</source><year>2015</year><volume>25</volume><fpage>1491</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1101/gr.190595.115</pub-id><?supplied-pmid 26430159?><pub-id pub-id-type="pmid">26430159</pub-id></element-citation></ref><ref id="CR24"><label>24</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ester</surname><given-names>M</given-names></name><name><surname>Kriegel</surname><given-names>H-P</given-names></name><name><surname>Sander</surname><given-names>J</given-names></name><name><surname>Xu</surname><given-names>X</given-names></name><etal/></person-group><article-title>A density-based algorithm for discovering clusters in large spatial databases with noise</article-title><source>Kdd</source><year>1996</year><publisher-loc>Portland</publisher-loc><publisher-name>KDD-96</publisher-name></element-citation></ref><ref id="CR25"><label>25</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Dueck</surname><given-names>D</given-names></name><name><surname>Frey</surname><given-names>BJ</given-names></name></person-group><article-title>Non-metric affinity propagation for unsupervised image categorization</article-title><source>Computer Vision, 2007. ICCV 2007. IEEE 11th International Conference on</source><year>2007</year><publisher-loc>Rio de Janeiro</publisher-loc><publisher-name>IEEE</publisher-name></element-citation></ref><ref id="CR26"><label>26</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ng</surname><given-names>AY</given-names></name><name><surname>Jordan</surname><given-names>MI</given-names></name><name><surname>Weiss</surname><given-names>Y</given-names></name></person-group><article-title>On spectral clustering: Analysis and an algorithm</article-title><source>Advances in neural information processing systems</source><year>2002</year><publisher-loc>Cambridge</publisher-loc><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="CR27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ntranos</surname><given-names>V</given-names></name><name><surname>Kamath</surname><given-names>GM</given-names></name><name><surname>Zhang</surname><given-names>JM</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name><name><surname>David</surname><given-names>NT</given-names></name></person-group><article-title>Fast and accurate single-cell rna-seq analysis by clustering of transcript-compatibility counts</article-title><source>Genome Biol</source><year>2016</year><volume>17</volume><fpage>112</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-0970-8</pub-id><?supplied-pmid 27230763?><pub-id pub-id-type="pmid">27230763</pub-id></element-citation></ref><ref id="CR28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rostom</surname><given-names>R</given-names></name><name><surname>Svensson</surname><given-names>V</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name><name><surname>Kar</surname><given-names>G</given-names></name></person-group><article-title>Computational approaches for interpreting scrna-seq data</article-title><source>FEBS Lett</source><year>2017</year><volume>17</volume><fpage>112</fpage></element-citation></ref><ref id="CR29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pierson</surname><given-names>E</given-names></name><name><surname>Yau</surname><given-names>C</given-names></name></person-group><article-title>Zifa: Dimensionality reduction for zero-inflated single-cell gene expression analysis</article-title><source>Genome Biol</source><year>2015</year><volume>16</volume><fpage>241</fpage><pub-id pub-id-type="doi">10.1186/s13059-015-0805-z</pub-id><?supplied-pmid 26527291?><pub-id pub-id-type="pmid">26527291</pub-id></element-citation></ref><ref id="CR30"><label>30</label><mixed-citation publication-type="other">Wang B, Zhu J, Pierson E, Ramazzotti D, Batzoglou S. Visualization and analysis of single-cell rna-seq data by kernel-based similarity learning. Nat Meth. 2017; 14:414&#x02013;6. <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.1038/nmeth.4207">http://doi.org/10.1038/nmeth.4207</ext-link>.</mixed-citation></ref><ref id="CR31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>Potter</surname><given-names>SS</given-names></name><name><surname>Whitsett</surname><given-names>JA</given-names></name><name><surname>Xu</surname><given-names>Y</given-names></name></person-group><article-title>Sincera: a pipeline for single-cell rna-seq profiling analysis</article-title><source>PLoS Comput Biol</source><year>2015</year><volume>11</volume><fpage>e1004575</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004575</pub-id><?supplied-pmid 26600239?><pub-id pub-id-type="pmid">26600239</pub-id></element-citation></ref><ref id="CR32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>C</given-names></name><name><surname>Su</surname><given-names>Z</given-names></name></person-group><article-title>Identification of cell types from single-cell transcriptomes using a novel clustering method</article-title><source>Bioinformatics</source><year>2015</year><volume>31</volume><fpage>1974</fpage><lpage>80</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btv088</pub-id><?supplied-pmid 25805722?><pub-id pub-id-type="pmid">25805722</pub-id></element-citation></ref><ref id="CR33"><label>33</label><mixed-citation publication-type="other">&#x0017e;urauskien&#x00117; J, Yau C. pcareduce: hierarchical clustering of single cell transcriptional profiles. BMC Bioinformatics. 2016; 17:140. 10.1186/s12859-016-0984-y.</mixed-citation></ref><ref id="CR34"><label>34</label><mixed-citation publication-type="other">Kiselev VY, et al.Sc3: consensus clustering of single-cell rna-seq data. Nat Meth. 2017; 14:483&#x02013;6. <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.1038/nmeth.4236">http://doi.org/10.1038/nmeth.4236</ext-link>.</mixed-citation></ref><ref id="CR35"><label>35</label><mixed-citation publication-type="other">Satija R, Farrell JA, Gennert D, Schier AF, Regev A. Spatial reconstruction of single-cell gene expression data. Nat Biotech. 2015; 33:495&#x02013;502. <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.1038/nbt.3192">http://doi.org/10.1038/nbt.3192</ext-link>.</mixed-citation></ref><ref id="CR36"><label>36</label><mixed-citation publication-type="other">Wolf FA, Angerer P, Theis FJ. Scanpy for analysis of large-scale single-cell gene expression data. bioRxiv. 2017;174029.</mixed-citation></ref><ref id="CR37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lun</surname><given-names>AT</given-names></name><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name></person-group><article-title>A step-by-step workflow for low-level analysis of single-cell rna-seq data with bioconductor</article-title><source>F1000Research</source><year>2016</year><volume>5</volume><fpage>2122</fpage><?supplied-pmid 27909575?><pub-id pub-id-type="pmid">27909575</pub-id></element-citation></ref><ref id="CR38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname><given-names>X</given-names></name><etal/></person-group><article-title>Single-cell mrna quantification and differential analysis with census</article-title><source>Nat Methods</source><year>2017</year><volume>14</volume><fpage>309</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4150</pub-id><?supplied-pmid 28114287?><pub-id pub-id-type="pmid">28114287</pub-id></element-citation></ref><ref id="CR39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Campbell</surname><given-names>KR</given-names></name><name><surname>Lun</surname><given-names>AT</given-names></name><name><surname>Wills</surname><given-names>QF</given-names></name></person-group><article-title>Scater: pre-processing, quality control, normalization and visualization of single-cell rna-seq data in r</article-title><source>Bioinformatics</source><year>2017</year><volume>33</volume><fpage>1179</fpage><lpage>86</lpage><?supplied-pmid 28088763?><pub-id pub-id-type="pmid">28088763</pub-id></element-citation></ref><ref id="CR40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langfelder</surname><given-names>P</given-names></name><name><surname>Zhang</surname><given-names>B</given-names></name><name><surname>Horvath</surname><given-names>S</given-names></name></person-group><article-title>Defining clusters from a hierarchical cluster tree: the dynamic tree cut package for r</article-title><source>Bioinformatics</source><year>2007</year><volume>24</volume><fpage>719</fpage><lpage>20</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btm563</pub-id><?supplied-pmid 18024473?><pub-id pub-id-type="pmid">18024473</pub-id></element-citation></ref><ref id="CR41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedregosa</surname><given-names>F</given-names></name><etal/></person-group><article-title>Scikit-learn: Machine learning in Python</article-title><source>J Mach Learn Res</source><year>2011</year><volume>12</volume><fpage>2825</fpage><lpage>30</lpage></element-citation></ref><ref id="CR42"><label>42</label><mixed-citation publication-type="other">Jones E, Oliphant T, Peterson P, et al.SciPy: Open source scientific tools for Python. 2001. <ext-link ext-link-type="uri" xlink:href="http://www.scipy.org/">http://www.scipy.org/</ext-link>. Accessed July 2016.</mixed-citation></ref><ref id="CR43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ruxton</surname><given-names>GD</given-names></name></person-group><article-title>The unequal variance t-test is an underused alternative to student&#x02019;s t-test and the mann&#x02013;whitney u test</article-title><source>Behav Ecol</source><year>2006</year><volume>17</volume><fpage>688</fpage><lpage>90</lpage><pub-id pub-id-type="doi">10.1093/beheco/ark016</pub-id></element-citation></ref><ref id="CR44"><label>44</label><mixed-citation publication-type="other">Franti P. Clustering datasets. 2015. <ext-link ext-link-type="uri" xlink:href="http://cs.uef.fi/sipu/datasets/">http://cs.uef.fi/sipu/datasets/</ext-link>. Accessed July 2017.</mixed-citation></ref><ref id="CR45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Love</surname><given-names>M</given-names></name><name><surname>Anders</surname><given-names>S</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name></person-group><article-title>Differential analysis of count data&#x02013;the deseq2 package</article-title><source>Genome Biol</source><year>2014</year><volume>15</volume><fpage>550</fpage><pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id><?supplied-pmid 25516281?><pub-id pub-id-type="pmid">25516281</pub-id></element-citation></ref><ref id="CR46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>edger: a bioconductor package for differential expression analysis of digital gene expression data</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><fpage>139</fpage><lpage>40</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id><?supplied-pmid 19910308?><pub-id pub-id-type="pmid">19910308</pub-id></element-citation></ref><ref id="CR47"><label>47</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Finak</surname><given-names>G</given-names></name><etal/></person-group><article-title>Mast: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell rna sequencing data</article-title><source>Genome Biol</source><year>2015</year><volume>16</volume><fpage>278</fpage><pub-id pub-id-type="doi">10.1186/s13059-015-0844-5</pub-id><?supplied-pmid 26653891?><pub-id pub-id-type="pmid">26653891</pub-id></element-citation></ref><ref id="CR48"><label>48</label><mixed-citation publication-type="other">Andrews TS, Hemberg M. Modelling dropouts allows for unbiased identification of marker genes in scrnaseq experiments. bioRxiv. 2016;:065094.</mixed-citation></ref><ref id="CR49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kharchenko</surname><given-names>PV</given-names></name><name><surname>Silberstein</surname><given-names>L</given-names></name><name><surname>Scadden</surname><given-names>DT</given-names></name></person-group><article-title>Bayesian approach to single-cell differential expression analysis</article-title><source>Nat Methods</source><year>2014</year><volume>11</volume><fpage>740</fpage><lpage>2</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2967</pub-id><?supplied-pmid 24836921?><pub-id pub-id-type="pmid">24836921</pub-id></element-citation></ref><ref id="CR50"><label>50</label><mixed-citation publication-type="other">Fan J, et al.Characterizing transcriptional heterogeneity through pathway and gene set overdispersion analysis. Nat Meth. 2016; 13:241&#x02013;4. <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.1038/nmeth.3734">http://doi.org/10.1038/nmeth.3734</ext-link>.</mixed-citation></ref><ref id="CR51"><label>51</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Korthauer</surname><given-names>KD</given-names></name><etal/></person-group><article-title>A statistical approach for identifying differential distributions in single-cell rna-seq experiments</article-title><source>Genome Biol</source><year>2016</year><volume>17</volume><fpage>222</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-1077-y</pub-id><?supplied-pmid 27782827?><pub-id pub-id-type="pmid">27782827</pub-id></element-citation></ref><ref id="CR52"><label>52</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>L</given-names></name><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Pinello</surname><given-names>L</given-names></name><name><surname>Yuan</surname><given-names>G-C</given-names></name></person-group><article-title>Giniclust: detecting rare cell types from single-cell gene expression data with gini index</article-title><source>Genome Biol</source><year>2016</year><volume>17</volume><fpage>144</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-1010-4</pub-id><?supplied-pmid 27368803?><pub-id pub-id-type="pmid">27368803</pub-id></element-citation></ref><ref id="CR53"><label>53</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>P</given-names></name><name><surname>Troup</surname><given-names>M</given-names></name><name><surname>Ho</surname><given-names>JW</given-names></name></person-group><article-title>Cidr: Ultrafast and accurate clustering through imputation for single-cell rna-seq data</article-title><source>Genome Biol</source><year>2017</year><volume>18</volume><fpage>59</fpage><pub-id pub-id-type="doi">10.1186/s13059-017-1188-0</pub-id><?supplied-pmid 28351406?><pub-id pub-id-type="pmid">28351406</pub-id></element-citation></ref><ref id="CR54"><label>54</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vallejos</surname><given-names>CA</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name><name><surname>Richardson</surname><given-names>S</given-names></name></person-group><article-title>Basics: Bayesian analysis of single-cell sequencing data</article-title><source>PLoS Comput Biol</source><year>2015</year><volume>11</volume><fpage>e1004333</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004333</pub-id><?supplied-pmid 26107944?><pub-id pub-id-type="pmid">26107944</pub-id></element-citation></ref><ref id="CR55"><label>55</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>WE</given-names></name><name><surname>Li</surname><given-names>C</given-names></name><name><surname>Rabinovic</surname><given-names>A</given-names></name></person-group><article-title>Adjusting batch effects in microarray expression data using empirical bayes methods</article-title><source>Biostatistics</source><year>2007</year><volume>8</volume><fpage>118</fpage><lpage>27</lpage><pub-id pub-id-type="doi">10.1093/biostatistics/kxj037</pub-id><?supplied-pmid 16632515?><pub-id pub-id-type="pmid">16632515</pub-id></element-citation></ref><ref id="CR56"><label>56</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benito</surname><given-names>M</given-names></name><etal/></person-group><article-title>Adjustment of systematic microarray data biases</article-title><source>Bioinformatics</source><year>2004</year><volume>20</volume><fpage>105</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btg385</pub-id><?supplied-pmid 14693816?><pub-id pub-id-type="pmid">14693816</pub-id></element-citation></ref><ref id="CR57"><label>57</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leek</surname><given-names>JT</given-names></name><name><surname>Johnson</surname><given-names>WE</given-names></name><name><surname>Parker</surname><given-names>HS</given-names></name><name><surname>Jaffe</surname><given-names>AE</given-names></name><name><surname>Storey</surname><given-names>JD</given-names></name></person-group><article-title>The sva package for removing batch effects and other unwanted variation in high-throughput experiments</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><fpage>882</fpage><lpage>3</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts034</pub-id><?supplied-pmid 22257669?><pub-id pub-id-type="pmid">22257669</pub-id></element-citation></ref><ref id="CR58"><label>58</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leng</surname><given-names>N</given-names></name><etal/></person-group><article-title>Oefinder: a user interface to identify and visualize ordering effects in single-cell rna-seq data</article-title><source>Bioinformatics</source><year>2016</year><volume>32</volume><fpage>1408</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btw004</pub-id><?supplied-pmid 26743507?><pub-id pub-id-type="pmid">26743507</pub-id></element-citation></ref><ref id="CR59"><label>59</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brennecke</surname><given-names>P</given-names></name><etal/></person-group><article-title>Accounting for technical noise in single-cell rna-seq experiments</article-title><source>Nat Methods</source><year>2013</year><volume>10</volume><fpage>1093</fpage><lpage>5</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2645</pub-id><?supplied-pmid 24056876?><pub-id pub-id-type="pmid">24056876</pub-id></element-citation></ref><ref id="CR60"><label>60</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ilicic</surname><given-names>T</given-names></name><etal/></person-group><article-title>Classification of low quality cells from single-cell rna-seq data</article-title><source>Genome Biol</source><year>2016</year><volume>17</volume><fpage>29</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-0888-1</pub-id><?supplied-pmid 26887813?><pub-id pub-id-type="pmid">26887813</pub-id></element-citation></ref><ref id="CR61"><label>61</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Risso</surname><given-names>D</given-names></name><name><surname>Ngai</surname><given-names>J</given-names></name><name><surname>Speed</surname><given-names>TP</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name></person-group><article-title>Normalization of rna-seq data using factor analysis of control genes or samples</article-title><source>Nat Biotechnol</source><year>2014</year><volume>32</volume><fpage>896</fpage><lpage>902</lpage><pub-id pub-id-type="doi">10.1038/nbt.2931</pub-id><?supplied-pmid 25150836?><pub-id pub-id-type="pmid">25150836</pub-id></element-citation></ref><ref id="CR62"><label>62</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gr&#x000fc;n</surname><given-names>D</given-names></name><name><surname>Kester</surname><given-names>L</given-names></name><name><surname>Van Oudenaarden</surname><given-names>A</given-names></name></person-group><article-title>Validation of noise models for single-cell transcriptomics</article-title><source>Nat Methods</source><year>2014</year><volume>11</volume><fpage>637</fpage><lpage>40</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2930</pub-id><?supplied-pmid 24747814?><pub-id pub-id-type="pmid">24747814</pub-id></element-citation></ref><ref id="CR63"><label>63</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maaten</surname><given-names>Lvd</given-names></name><name><surname>Hinton</surname><given-names>G</given-names></name></person-group><article-title>Visualizing data using t-sne</article-title><source>J Mach Learn Res</source><year>2008</year><volume>9</volume><fpage>2579</fpage><lpage>605</lpage></element-citation></ref></ref-list></back></article>