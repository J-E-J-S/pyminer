<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 1.1?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6612880</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btz355</article-id><article-id pub-id-type="publisher-id">btz355</article-id><article-categories><subj-group subj-group-type="heading"><subject>Ismb/Eccb 2019 Conference Proceedings</subject><subj-group subj-group-type="category-toc-heading"><subject>Population Genomics and Molecular Evolution</subject></subj-group></subj-group></article-categories><title-group><article-title>Collaborative intra-tumor heterogeneity detection</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Khakabimamaghani</surname><given-names>Sahand</given-names></name><xref ref-type="aff" rid="btz355-aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Malikic</surname><given-names>Salem</given-names></name><xref ref-type="aff" rid="btz355-aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Tang</surname><given-names>Jeffrey</given-names></name><xref ref-type="aff" rid="btz355-aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Ding</surname><given-names>Dujian</given-names></name><xref ref-type="aff" rid="btz355-aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Morin</surname><given-names>Ryan</given-names></name><xref ref-type="aff" rid="btz355-aff2">2</xref><xref ref-type="aff" rid="btz355-aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Chindelevitch</surname><given-names>Leonid</given-names></name><xref ref-type="aff" rid="btz355-aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Ester</surname><given-names>Martin</given-names></name><xref ref-type="aff" rid="btz355-aff1">1</xref><xref ref-type="aff" rid="btz355-aff4">4</xref><xref ref-type="corresp" rid="btz355-cor1"/><!--<email>ester@cs.sfu.ca</email>--></contrib></contrib-group><aff id="btz355-aff1"><label>1</label>School of Computing Science, Simon Fraser University, Burnaby, BC</aff><aff id="btz355-aff2"><label>2</label>Department of Molecular Biology and Biochemistry, Simon Fraser University, Burnaby, BC</aff><aff id="btz355-aff3"><label>3</label>Genome Sciences Centre, British Columbia Cancer Agency, Vancouver, BC</aff><aff id="btz355-aff4"><label>4</label>Vancouver Prostate Centre, Vancouver, BC, Canada</aff><author-notes><corresp id="btz355-cor1">To whom correspondence should be addressed. <email>ester@cs.sfu.ca</email></corresp></author-notes><pub-date pub-type="ppub"><month>7</month><year>2019</year></pub-date><pub-date pub-type="epub" iso-8601-date="2019-07-05"><day>05</day><month>7</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>05</day><month>7</month><year>2019</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>35</volume><issue>14</issue><fpage>i379</fpage><lpage>i388</lpage><permissions><copyright-statement>&#x000a9; The Author(s) 2019. Published by Oxford University Press.</copyright-statement><copyright-year>2019</copyright-year><license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p></license></permissions><self-uri xlink:href="btz355.pdf"/><abstract><title>Abstract</title><sec id="s1"><title>Motivation</title><p>Despite the remarkable advances in sequencing and computational techniques, noise in the data and complexity of the underlying biological mechanisms render deconvolution of the phylogenetic relationships between cancer mutations difficult. Besides that, the majority of the existing datasets consist of bulk sequencing data of single tumor sample of an individual. Accurate inference of the phylogenetic order of mutations is particularly challenging in these cases and the existing methods are faced with several theoretical limitations. To overcome these limitations, new methods are required for integrating and harnessing the full potential of the existing data.</p></sec><sec id="s2"><title>Results</title><p>We introduce a method called Hintra for intra-tumor heterogeneity detection. Hintra integrates sequencing data for a cohort of tumors and infers tumor phylogeny for each individual based on the evolutionary information shared between different tumors. Through an iterative process, Hintra learns the repeating evolutionary patterns and uses this information for resolving the phylogenetic ambiguities of individual tumors. The results of synthetic experiments show an improved performance compared to two state-of-the-art methods. The experimental results with a recent Breast Cancer dataset are consistent with the existing knowledge and provide potentially interesting findings.</p></sec><sec id="s3"><title>Availability and implementation</title><p>The source code for Hintra is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/sahandk/HINTRA">https://github.com/sahandk/HINTRA</ext-link>.</p></sec></abstract><counts><page-count count="10"/></counts></article-meta></front><body><sec><title>1 Introduction</title><p>Cancer is the result of a gradual accumulation of somatic genetic mutations. While most of the acquired mutations are putatively neutral and have no significant effect on a cell&#x02019;s phenotype, some confer a selective advantage to the host cell; they are known as <italic>driver mutations</italic>. Consequently, individual tumors are heterogeneous and typically consist of multiple populations of cells (subclones), each harboring a distinct set of driver mutations and possessing a distinct phenotype, a phenomenon known as intra-tumor heterogeneity (ITH). Detecting ITH helps identify the key events initiating the development of the disease or leading to metastasis, and allows for the determination of a tumor&#x02019;s subclonal composition.</p><p>ITH is usually represented by a phylogenetic tree of tumor evolution, where individual nodes represent subclones. Mutations are placed along the edges of the phylogenetic tree. A mutation is assigned to the unique edge directed into the node (subclone) in which the mutation appears for the first time (see <xref ref-type="fig" rid="btz355-F3">Fig.&#x000a0;3</xref> for an example of a phylogenetic tree). In this work, we assume that the mutations satisfy the infinite sites assumption. This assumption means that each mutation appears exactly once in the phylogenetic tree and is present (conserved) in all the descendants of the subclone in which it first occurs.</p><p>Most of the existing methods for studying tumor evolution operate on tumor data from a single cancer patient. The earliest developed methods used bulk sequencing data from a single sample [e.g. rec-BTP (<xref rid="btz355-B12" ref-type="bibr">Hajirasouliha <italic>et al.</italic>, 2014</xref>), CTPsingle (<xref rid="btz355-B8" ref-type="bibr">Donmez <italic>et al.</italic>, 2017</xref>)] or multiple samples from the same individual [e.g. PhyloWGS (<xref rid="btz355-B7" ref-type="bibr">Deshwar <italic>et al.</italic>, 2015</xref>), AncesTree (<xref rid="btz355-B9" ref-type="bibr">El-Kebir <italic>et al.</italic>, 2015</xref>), LICHeE (<xref rid="btz355-B23" ref-type="bibr">Popic <italic>et al.</italic>, 2015</xref>), CITUP (<xref rid="btz355-B17" ref-type="bibr">Malikic <italic>et al.</italic>, 2015</xref>)]. These were followed by the development of several methods that work on single-cell data [e.g. OncoNEM (<xref rid="btz355-B26" ref-type="bibr">Ross and Markowetz, 2016</xref>), SCITE (<xref rid="btz355-B14" ref-type="bibr">Jahn <italic>et al.</italic>, 2016</xref>), SiFit (<xref rid="btz355-B30" ref-type="bibr">Zafar <italic>et al.</italic>, 2017</xref>)]. The most recently introduced methods, B-SCITE (<xref rid="btz355-B18" ref-type="bibr">Malikic <italic>et al.</italic>, 2017</xref>) and PhISCS (<xref rid="btz355-B19" ref-type="bibr">Malikic <italic>et al.</italic>, 2018</xref>), simultaneously utilize the complementary strengths of both single-cell and bulk sequencing data. Indeed, most of the methods above have limitations when faced with the input consisting of a single sample low-to-medium coverage bulk sequencing dataset, which are predominant in existing databases (e.g. TCGA and cBioPortal). Since these type of data contain numerous ambiguous cases (i.e. cases where the input data are consistent with more than one possible phylogenetic tree for the tumor), the existing algorithms for ITH detection based on a single tumor sample [e.g. CTPsingle (<xref rid="btz355-B8" ref-type="bibr">Donmez <italic>et al.</italic>, 2017</xref>)] will yield several possible solutions for those cases (<xref rid="btz355-B18" ref-type="bibr">Malikic <italic>et al.</italic>, 2017</xref>).</p><p>In addition to ITH, inter-tumor heterogeneity is another phenomenon complicating the understanding and treatment of cancer. Inter-tumor heterogeneity is a direct consequence of the fact that individual tumors are genetically distinct. Despite the inter-tumor heterogeneity, one can still expect partially similar evolutionary trajectories among subsets of tumors (<xref rid="btz355-B5" ref-type="bibr">Caravagna <italic>et al.</italic>, 2018</xref>; <xref rid="btz355-B22" ref-type="bibr">Pathare <italic>et al.</italic>, 2009</xref>). Leveraging the phylogenetic similarities among tumors from a cohort of patients in a collaborative fashion can guide the process of exploring the solution space and reduce the above-mentioned ambiguities in inferring tumor phylogenies, especially for cases when the input is low-to-medium coverage bulk sequencing data from a single tumor sample. Most of the existing methods that infer phylogeny at the ensemble level are based on binary mutation data. Some of these methods [e.g. CAPRESE (<xref rid="btz355-B16" ref-type="bibr">Loohuis <italic>et al.</italic>, 2014</xref>), CAPRI (<xref rid="btz355-B24" ref-type="bibr">Ramazzotti <italic>et al.</italic>, 2015</xref>) and <xref rid="btz355-B3" ref-type="bibr">Beerenwinkel <italic>et al.</italic> (2004)</xref>] exploit Suppes&#x02019; probabilistic causation theory (<xref rid="btz355-B29" ref-type="bibr">Suppes, 1970</xref>) to determine the pairwise order of mutations. Some other methods [e.g. conjunctive Bayesian networks (<xref rid="btz355-B4" ref-type="bibr">Beerenwinkel <italic>et al.</italic>, 2007</xref>; <xref rid="btz355-B10" ref-type="bibr">Gerstung <italic>et al.</italic>, 2009</xref>) and Bayesian mutation landscape (<xref rid="btz355-B20" ref-type="bibr">Misra <italic>et al.</italic>, 2014</xref>)] model the phylogenetic relationships as a Bayesian network and propose approaches for learning the network structure. RESIC method proposed by <xref rid="btz355-B2" ref-type="bibr">Attolini <italic>et al.</italic> (2010)</xref> is based on the principles of population genetics and models the tumor samples as individuals in the steady-state of a genetically evolving population and infers the evolutionary history of their genotypes. Since all of these methods use binary mutation data, they do not fully utilize the potential of sequencing data by overlooking the intrinsic information about the timing of evolutionary events. Moreover, these methods gain general knowledge about cancer progression and do not provide personalized evolutionary details.</p><p>A recent method, Revolver (<xref rid="btz355-B5" ref-type="bibr">Caravagna <italic>et al.</italic>, 2018</xref>), uses non-binary sequencing data and exploits the repeating evolutionary patterns for ITH detection in individual tumors by transferring information across all tumors. In this method, the assumption is that a particular mutation usually has the same predictor (preceding mutation) across different tumors in a particular cancer type. Accordingly, the authors consider the frequency of the direct ancestors of a mutation across different tumors and use that information when inferring the phylogeny for a specific tumor. Revolver uses an expectation&#x02013;maximization (EM) approach for finding the optimum phylogenetic trees. In the first step, an existing method [e.g. ClonEvol (<xref rid="btz355-B6" ref-type="bibr">Dang <italic>et al.</italic>, 2017</xref>)] is used for deriving a set of high-scoring candidate phylogenetic trees for each tumor, the best of which is chosen as the current tree for each tumor. Then, the frequencies of the direct ancestors of each mutation are learned from the currently selected trees for all tumors. This information, which constitutes the parameters of the distribution over tree topologies, is then used for re-evaluating the tree set for each tumor and selecting the ones with the highest new scores. These two steps of updating the parameters/frequencies (E-step) and updating the current trees based on the new parameters (M-step) continue until convergence or until termination criterion is met.</p><p>This approach decreases the uncertainty of phylogenetic structures by incorporating the ancestry information. However, the underlying evolutionary assumption in Revolver, which is the dependency of a mutation only on its direct ancestor (the preceding mutation), is a limitation because earlier mutations inherited by a subclone might also be decisive in the selection of the next mutation during the cancer evolution. Therefore, considering only the direct ancestor as the predictor of a mutation might result in a loss of information. Another issue, which is discussed further in Section 2.3, is that the tree topology distribution used in Revolver is biased toward more branching structures. If not controlled, this bias may produce unrealistic results with too much branching.</p><p>In this paper, we discuss the consequences of the above key issues and introduce a collaborative ITH detection method to address them. Our contributions can be summarized as follows:
<list list-type="bullet"><list-item><p>We introduce a Probabilistic graphical model (PGM) called Hintra for collaborative ITH detection, as well as a corresponding parameter learning method. The proposed PGM is based on read count data, instead of summary values such as cancer cell fraction (CCF) or variant allele frequency, to account for the uncertainty of the measurements. To reduce the bias of existing methods, we propose a Bayesian EM method that leverages the topology uncertainty when learning the parameters, using a distribution over possible phylogenetic tree topologies instead of a point estimate.</p></list-item><list-item><p>Hintra includes a novel factorization approach for phylogenetic tree topologies. Addressing the information loss issue mentioned earlier, Hintra considers all the mutations preceding a particular mutation in the phylogenetic tree, instead of only the most recent one. Moreover, the proposed factorization allows for the prediction of the next mutation that might happen in a subclone given its current mutational landscape. This capability, which is lacking in the existing methods, can be used for prognostic clinical applications.</p></list-item></list></p><p>Using both synthetic and real data, we evaluate performance of Hintra and compare it to the state-of-the-art methods including Revolver (as a collaborative ITH detection method) and ClonEvol (as a stand-alone ITH detection method). Our results for synthetic data based on different scenarios indicate that Hintra outperforms the existing methods. Our results for real data were biologically consistent and provided new information of potential clinical interest.</p></sec><sec><title>2 Materials and methods</title><p>For the sake of simplicity, the methods in Sections 2.1&#x02013;2.4 are presented assuming that a single sample is available for each tumor. Later, in Section 2.5, we generalize our model to allow multiple samples per tumor.</p><sec><title>2.1 Problem definition</title><p>We now formally define the collaborative ITH detection problem. We assume that the input consists of read count data across <italic>m</italic> tumors. For each tumor, we consider read counts for a given set <italic>G</italic> of <italic>n</italic> known driver genes. The input data are organized into two matrices, one for the reference read counts denoted by <inline-formula id="IE1"><mml:math id="IM1"><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>&#x02208;</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and the other for the variant read counts denoted by<inline-formula id="IE2"><mml:math id="IM2"><mml:mo>&#x000a0;</mml:mo><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>&#x02208;</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, where <inline-formula id="IE3"><mml:math id="IM3"><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> denotes the set of non-negative integers. More precisely, <italic>r<sub>ij</sub></italic> and <italic>v<sub>ij</sub></italic> respectively denote the number of reference and variant reads supporting driver gene <italic>j</italic> in tumor <italic>i</italic>.</p><p>The output is a set of phylogenetic trees<inline-formula id="IE4"><mml:math id="IM4"><mml:mi mathvariant="normal">&#x000a0;</mml:mi><mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, where <italic>T<sub>i</sub></italic> is the phylogenetic tree of tumor <italic>i</italic> indicating the phylogenetic order of mutations in that tumor. A phylogenetic tree is a representation of the evolutionary events that are observed in a tumor. The root of the tree corresponds to the germline cell and the other nodes indicate the subclones of the tumor. Each edge stands for a mutation that occurs in a cell of the subclone corresponding to the edge&#x02019;s tail (the parent) and triggers the growth of the subclone corresponding to the edge&#x02019;s head (the child). Our goal is to infer the tree for each tumor by considering the evolutionary patterns of similar mutations in the other tumors&#x02019; trees.</p><p>As a byproduct, we also learn model parameters that can be used to compute the probability that a particular mutation occurs in a cell having a specific set of mutations. For example, the parameters can contain information on the most frequent mutation occurring in (i.e. providing competitive advantage to) a breast cancer cell already containing the mutations <italic>TP53</italic> and <italic>PIK3CA</italic>. This parameter provides predictive information with prognostic applications.</p><p>Although it is theoretically possible to consider the exact position where each of the input mutations occurs within its gene, we chose to analyze the data at the gene level to increase the frequency of each mutation and gain statistical power. For genes affected by multiple mutations in the same tumor, we use the read count data for the most prevalent of such mutations, i.e. the mutation with the largest CCF. The CCF represents the fraction of cells of a tumor that harbor a particular mutation and most of the existing methods preprocess the read counts from sequencing data into CCFs before using them for phylogeny inference. This allows the use of the existing CCF computation tools [e.g. PyClone (<xref rid="btz355-B27" ref-type="bibr">Roth <italic>et al.</italic>, 2014</xref>)] that can handle complicated cases such as mutations involving copy number variations (CNV). However, it ignores the uncertainty in the computed CCFs, which may lead to incorrect results by assigning high weights to uncertain inputs or vice versa. Incorporating read counts directly into the inference provides a more accurate representation and can help prioritize informative inputs over uncertain ones. Moreover, in cases with CNV, the computed CCFs can be simply translated into read counts based on an appropriate approximation of the locus coverage (e.g. mean sequencing coverage). Therefore, we choose read counts as the format of our input.</p></sec><sec><title>2.2 Probabilistic graphical model</title><p>The proposed PGM for Hintra is shown in <xref ref-type="fig" rid="btz355-F1">Figure&#x000a0;1</xref> . In this model, each tumor <italic>i</italic>, for<inline-formula id="IE5"><mml:math id="IM5"><mml:mo>&#x000a0;</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>m</mml:mi></mml:math></inline-formula>, is associated with a phylogenetic tree <italic>T<sub>i</sub></italic>, whose structure depends on a parameter &#x003b2;. The tree structure constrains the possible values of the read count data. This is done through a latent variable<inline-formula id="IE6"><mml:math id="IM6"><mml:mi mathvariant="normal">&#x000a0;</mml:mi><mml:msub><mml:mrow><mml:mo>&#x003b8;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>, which is a vector of size <italic>n</italic> of CCFs of driver mutations in tumor <italic>i</italic>. The dot in the index <italic>i</italic>. denotes a vector. The CCF of a mutation indicates the proportion of cells in the tumor sample that harbor that mutation. A larger CCF is, in general, evidence of earlier occurrence of the mutation during tumor evolution. Accordingly, <inline-formula id="IE7"><mml:math id="IM7"><mml:msub><mml:mrow><mml:mo>&#x003b8;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> depends on the tree structure <italic>T<sub>i</sub></italic> corresponding to tumor <italic>i</italic> and influences the noisy observed reference and variant read counts for tumor <italic>i</italic>.
</p><fig id="btz355-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>Probabilistic graphical model of Hintra. Latent and observed variables are indicated by white and shaded circles, respectively</p></caption><graphic xlink:href="btz355f1"/></fig><p>According to the PGM, the joint probability of the model variables is factored as:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x003b8;</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x003b2;</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>V</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x003b8;</mml:mi></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="normal">&#x003b8;</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x003b2;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>The first term on the right hand side of <xref ref-type="disp-formula" rid="E1">Equation (1)</xref> is the likelihood term and is defined as below:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>|</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mo>&#x003b8;</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>&#x0220f;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:munderover><mml:mrow><mml:mo>&#x0220f;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b8;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b8;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mi mathvariant="normal">Binomial</mml:mi><mml:mo>&#x02009;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b8;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>The Binomial distribution parameter is equal to <inline-formula id="IE8"><mml:math id="IM8"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b8;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> because CCF is computed as <inline-formula id="IE9"><mml:math id="IM9"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b8;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula> for driver mutation <italic>j</italic> of tumor <italic>i</italic> (note the multiplication by 2 in the nominator). The second factor in RHS of <xref ref-type="disp-formula" rid="E1">Equation (1)</xref> is defined as below:
<disp-formula id="E3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>&#x003b8;</mml:mo><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>&#x0220f;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b8;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003b8;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mi mathvariant="normal">Uni</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">possible</mml:mi><mml:mo>&#x02009;</mml:mo><mml:mi mathvariant="normal">values</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>The possible values for vector <inline-formula id="IE10"><mml:math id="IM10"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b8;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> are restricted by: (i) the <italic>sum rule</italic> indicating that the CCF for a mutation should not be smaller than the sum of the CCFs of all of its children in the phylogenetic tree <italic>T<sub>i</sub></italic> (<xref rid="btz355-B15" ref-type="bibr">Jiao <italic>et al.</italic>, 2014</xref>) and (2) <inline-formula id="IE11"><mml:math id="IM11"><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b8;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> for<inline-formula id="IE12"><mml:math id="IM12"><mml:mo>&#x000a0;</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>m</mml:mi></mml:math></inline-formula>.</p><p>The third factor and its computation are discussed in Section 2.3.</p></sec><sec><title>2.3 Prior probability of phylogenetic trees</title><p>The underlying assumption of collaborative ITH detection is that some of the evolutionary patterns (i.e. phylogenetic relationships between the evolutionary events in a tumor) are common among different tumors. Accordingly, the goal is to define the entire phylogenetic tree in terms of its substructures representing the evolutionary patterns. One can then investigate the frequency of the patterns to find the more frequent patterns and use them as a reference whenever there is ambiguity for a tumor with respect to the phylogenetic relationships between the events involved in those frequent patterns. Here, ambiguous case refers to the case where multiple phylogenetic trees are consistent with the observed bulk data read counts. For a simple example of an ambiguous case we can consider a tumor with CCF values<inline-formula id="IE13"><mml:math id="IM13"><mml:mo>&#x000a0;</mml:mo><mml:mo>[</mml:mo><mml:mn>0.2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x000a0;</mml:mo><mml:mn>0.3</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x000a0;</mml:mo><mml:mn>1.0</mml:mn><mml:mo>]</mml:mo></mml:math></inline-formula>. In this case, relying solely on CCF values, one can easily observe that both the chain and the branching topology are possible explanations of the observed data. Several more complicated examples for this were recently provided in the analysis of acute lymphoblastic leukemia patients in <xref rid="btz355-B18" ref-type="bibr">Malikic <italic>et al.</italic> (2017)</xref>. For an example of a non-ambiguous case we can consider a tumor with mutations having CCFs<inline-formula id="IE14"><mml:math id="IM14"><mml:mo>&#x000a0;</mml:mo><mml:mo>[</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x000a0;</mml:mo><mml:mn>0.8</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x000a0;</mml:mo><mml:mn>1.0</mml:mn><mml:mo>]</mml:mo></mml:math></inline-formula>. In this case, only the chain topology is consistent with the observed CCFs. Namely, for the branching topology, the frequencies of the two child nodes would add up to 1.3, which is larger than the CCF of their parent, thus violating the sum rule.</p><p>To the best of our knowledge, the most recent ITH detection method that is based on the assumption of common evolutionary patterns is Revolver (<xref rid="btz355-B5" ref-type="bibr">Caravagna <italic>et al.</italic>, 2018</xref>). Revolver assumes independence of the edges and defines the probability of the phylogenetic tree of tumor <italic>i</italic> as the product of the probabilities of the observed edges (i.e. the probability of attaching a given child node to a particular parent node) as follows:
<disp-formula id="E4"><label>(4)</label><mml:math id="M4"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>&#x003b2;</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x0221d;</mml:mo><mml:munder><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x0220f;</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi>c</mml:mi><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02208;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>|</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mo>&#x003b2;</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>p</italic> and <italic>c</italic> are the parent and child nodes of a given edge <inline-formula id="IE15"><mml:math id="IM15"><mml:mi>p</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi>c</mml:mi></mml:math></inline-formula> of tree <italic>T<sub>i</sub></italic>, and <italic>E<sub>i</sub></italic> is the set of all edges of the tree for tumor <italic>i</italic>. The parameter &#x003b2; governs the edge probabilities and is shared across all tumors.</p><p>In the above approach, each node is assumed to be dependent only on its direct ancestor. However, the selection of the next mutation that brings competitive advantage to a cell does not only depend on the last mutation, but it depends on the entire current mutational burden of the cell. <xref ref-type="fig" rid="btz355-F2">Figure&#x000a0;2A</xref> shows a scenario in which the above assumption is violated, leading to a poor performance for Revolver (see Section 3.1). In this scenario, the two trees have different truncal mutations (<bold>a</bold> for topology 1 and <bold>e</bold> for topology 2). Because of this difference, mutation <italic>d</italic> is attached to different parents in the two trees. However, considering only pairwise relationships, because <bold>d</bold> happens after <bold>b</bold> in 70% of the tumors, the factors of Revolver will assign it under <bold>b</bold> even when inferring trees for a tumor having true topology 2.
</p><fig id="btz355-F2" orientation="portrait" position="float"><label>Fig. 2.</label><caption><p>Two sample scenarios in which tree factorization and parameter learning as in <xref rid="btz355-B5" ref-type="bibr">Caravagna <italic>et al.</italic> (2018)</xref> results in undesired inference. The small circles denote the tumor subclones and the empty circle is the germline cell. The edges are labeled with the mutations, denoted by letters within larger circles. The true tree topologies are shown with solid edges. Each ambiguous situation is shown in a different color, with dashed ovals indicating the conflicting evidence (source of ambiguity) and the dashed edge indicating the possible mistake due to that evidence</p></caption><graphic xlink:href="btz355f2"/></fig><p>Another drawback of the above factorization is that it cannot be translated into a prognostic application of predicting the next driver mutation based on the current mutational landscape of a subclone. The reason is that the conditional probability of the next mutation given all current mutations is not computable as a function of the parameters learned based on the above assumptions. In other words, based on the above assumptions, the next mutation depends only on the most recent ancestor.</p><p>To overcome the above limitations, we extend the tree factorization to capture the effect of all existing driver mutations (ancestors) on the next driver mutation (descendant). The occurrence order of the ancestors is not taken into account because the selection of the next mutation depends only on the set of current mutations, but not the order of these mutations. We define the prior tree probability as below:
<disp-formula id="E5"><label>(5)</label><mml:math id="M5"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="normal">&#x003b2;</mml:mi><mml:mo>)</mml:mo><mml:mo>&#x0221d;</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">&#x0220f;</mml:mo><mml:mrow><mml:mi mathvariant="script">P</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi>c</mml:mi><mml:mo>&#x02004;</mml:mo><mml:mo>&#x02208;</mml:mo><mml:mo>&#x02004;</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
where <inline-formula id="IE16"><mml:math id="IM16"><mml:mi mathvariant="script">P</mml:mi></mml:math></inline-formula> is the set of possible ancestor mutations of <italic>c</italic> in tree <italic>T<sub>i</sub></italic>, which we call the <italic>ancestry set</italic> hereafter. An ancestry set consists of all the mutations on the path in <italic>T<sub>i</sub></italic> from the root to any internal (i.e. non-leaf) node/subclone and captures the mutational landscape of that node/subclone. The function <inline-formula id="IE17"><mml:math id="IM17"><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> returns the set of edges of <italic>T<sub>i</sub></italic> consisting of the ancestry sets and their children. The parameter &#x003b2; is a matrix with rows corresponding to all possible ancestry sets for all tumors in the dataset. The columns correspond to the set <italic>G</italic> of all mutations. The entry &#x003b2;<sub><italic>kj</italic></sub> of the &#x003b2; matrix indicates the amount of evidence for an edge labeled with the <italic>j</italic>-th mutation whose tail is a node with the <italic>k</italic>-th ancestry set. <xref ref-type="fig" rid="btz355-F3">Figure&#x000a0;3</xref> illustrates these concepts.
</p><fig id="btz355-F3" orientation="portrait" position="float"><label>Fig. 3.</label><caption><p>A sample phylogenetic tree and its factorization</p></caption><graphic xlink:href="btz355f3"/></fig></sec><sec><title>2.4 Parameter learning</title><p>Although the proposed prior probability in Section 2.3 resolves the information loss issue, it inherits the bias toward branching structures. Scenario B in <xref ref-type="fig" rid="btz355-F2">Figure&#x000a0;2</xref> shows a sample situation where this bias can lead to unexpected phylogeny detection. In topology 1 in Scenario B, mutation <bold>b</bold> occurs after <bold>a</bold>, which is not consistent with topology 2, in which <bold>b</bold> occurs after <bold>c</bold>. A similar inconsistency exists between the ancestors of mutation <bold>a</bold> in the two topologies. Accordingly, based on both the Revolver and Hintra factorization approaches, any ambiguous case that suggests a branching topology in which <bold>a</bold> and <bold>b</bold> can occur in parallel has supporting evidence due to the conflicting orders of <bold>a</bold> and <bold>b</bold> in the two topologies, even if it is originally associated with one of the two topologies. However, in case of a slight ambiguity (e.g. a 5% ambiguous cases for each of the two topologies), the evidence for the branching topology is very small and the chain topology should be favored (which has support from, for example, 95% of the samples). So, if the inherent bias toward branching topologies in the factorization approaches is not controlled, the methods infer the incorrect branching structure (shown with the dashed edges) for the ambiguous cases. We control this bias by employing a Bayesian EM parameter learning method described next. This method accounts for uncertainty of each of the possible topologies when learning the parameters and, in this scenario, only accepts a branching topology in cases with high certainty (i.e. when the subclones corresponding to <bold>a</bold> and <bold>b</bold> are very small).</p><p>We propose a Bayesian EM approach to learn the parameters of the PGM of Hintra. The goal is to optimize the value of &#x003b2;, the topology distribution parameter, by maximizing the marginal likelihood <inline-formula id="IE18"><mml:math id="IM18"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>|</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x003b2;</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> and utilizing the data&#x02019;s uncertainty. This is performed using an iterative approach with the following steps at each iteration:
<list list-type="order"><list-item><p>Compute <inline-formula id="IE19"><mml:math id="IM19"><mml:msup><mml:mrow><mml:mi mathvariant="normal">&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mi>'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> using <inline-formula id="IE20"><mml:math id="IM20"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="normal">&#x003b2;</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> [see <xref ref-type="disp-formula" rid="E6">Equation (6)</xref>].</p></list-item><list-item><p>If <inline-formula id="IE21"><mml:math id="IM21"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>|</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x003b2;</mml:mi><mml:mo>)</mml:mo><mml:mo>&#x0003c;</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>|</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mi>'</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula> [see <xref ref-type="disp-formula" rid="E10">Equation (10)</xref>], then set <inline-formula id="IE22"><mml:math id="IM22"><mml:mi mathvariant="normal">&#x003b2;</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mi>'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and continue; otherwise output <inline-formula id="IE23"><mml:math id="IM23"><mml:msup><mml:mrow><mml:mi mathvariant="normal">&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mi>'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and terminate.</p></list-item></list></p><p>Initially, the tree priors are assumed to be uniform. Then, in the first step, <inline-formula id="IE24"><mml:math id="IM24"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is updated for each ancestry set <inline-formula id="IE25"><mml:math id="IM25"><mml:mi mathvariant="script">P</mml:mi></mml:math></inline-formula> and descendant mutation <italic>c</italic> using the following equation:
<disp-formula id="E6"><label>(6)</label><mml:math id="M6"><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mi>'</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:munder><mml:mo stretchy="false">&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x000d7;</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="normal">&#x003b2;</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="normal">&#x003f5;</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>
where <inline-formula id="IE26"><mml:math id="IM26"><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> is the indicator function for <inline-formula id="IE27"><mml:math id="IM27"><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>A</mml:mi></mml:math></inline-formula> and the value &#x003f5; is the pseudo-count for avoiding zero probabilities. <xref ref-type="disp-formula" rid="E6">Equation (6)</xref> is the sum of evidence for factor <inline-formula id="IE28"><mml:math id="IM28"><mml:mi mathvariant="script">P</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi>c</mml:mi></mml:math></inline-formula> over all tumors, where the evidence is weighted by the posterior likelihood of every possible tree topology that contains the factor <inline-formula id="IE29"><mml:math id="IM29"><mml:mi mathvariant="script">P</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi>c</mml:mi></mml:math></inline-formula>. Accordingly, <inline-formula id="IE30"><mml:math id="IM30"><mml:msubsup><mml:mrow><mml:mo>&#x003b2;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>'</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> indicates the updated evidence for the factor <inline-formula id="IE31"><mml:math id="IM31"><mml:mi mathvariant="script">P</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi>c</mml:mi></mml:math></inline-formula>. The posterior likelihood for tree topology is computed as:
<disp-formula id="E7"><label>(7)</label><mml:math id="M7"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x003b2;</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x003b2;</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mrow><mml:munder><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>X</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x003b2;</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula></p><p>In the above equation, the marginal data likelihood is computed as below:
<disp-formula id="E8"><label>(8)</label><mml:math id="M8"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">&#x0222b;</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b8;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">&#x0220f;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b8;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b8;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b8;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math></disp-formula></p><p>Because the term containing the integral over the vector <inline-formula id="IE32"><mml:math id="IM32"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b8;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> is not in closed form, we approximate that term using discrete values as below:
<disp-formula id="E9"><label>(9)</label><mml:math id="M9"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>&#x02248;</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b8;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b4;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x00394;</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">&#x0220f;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b8;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b8;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>
where <inline-formula id="IE33"><mml:math id="IM33"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b4;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x00394;</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> is a function that enumerates all discrete values of the vector <inline-formula id="IE34"><mml:math id="IM34"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b8;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> with step-size &#x00394; considering the constraints imposed by topology <italic>T<sub>i</sub></italic>. In our experiments (Section 3), we use <inline-formula id="IE35"><mml:math id="IM35"><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:math></inline-formula>.</p><p>In the second step, the marginal probability conditional on &#x003b2; (i.e. the maximization objective) is computed as:
<disp-formula id="E10"><label>(10)</label><mml:math id="M10"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x003b2;</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">&#x0220f;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:munder><mml:mo stretchy="false">&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x003b2;</mml:mi></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math></disp-formula></p><p>
<xref ref-type="fig" rid="btz355-F4">Figure&#x000a0;4</xref> illustrates, with an example, the Bayesian EM approach described above as well as the EM approach used in Revolver, which uses MAP point estimate. It explains how using a Bayesian approach that employs the entire spectrum of possible topologies (i.e. data uncertainty) instead of the point estimates as used in Revolver can reduce the bias inherent in both of the tree prior probability definitions used in Revolver and Hintra. The figure shows the first step of different EM approaches on a dataset with three tumors all having two driver mutations, <italic>a</italic> and <italic>b</italic>. Topologies <italic>A</italic>, <italic>B</italic> and <italic>C</italic> constitute all possible trees with the two mutations. Each of the three tumors has a different topology, as shown. The bar charts show the initial posterior probabilities of the topologies [i.e.<inline-formula id="IE36"><mml:math id="IM36"><mml:mo>&#x000a0;</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo><mml:mo>&#x0221d;</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="normal">&#x003b2;</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>] for the tumors computed assuming a uniform initial topology prior <inline-formula id="IE37"><mml:math id="IM37"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="normal">&#x003b2;</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> and hypothetical data likelihoods. Two types of posteriors are computed, one based on the Bayesian estimation (the top row) and one based on the MAP estimation (the bottom row). The evidence &#x003b2; updated based on the two types of posteriors is shown in the middle. At the right, the updated priors based on the updated evidences are presented. Despite the fact that each of the three topologies is observed only once, the bias in the prior definition makes the most branching topology <italic>B</italic> more likely. However, the Bayesian approach considers the entire spectrum of possible topologies (i.e. based on the data likelihood given each possible topology), which reduces the bias. As shown in this figure, ambiguous cases like <italic>B</italic> often have a more uniform distribution over topologies than the other cases, resulting in reduced support for branching. This mitigates the effects of the prior bias during the learning process. Besides this, since we optimize the marginal data likelihood [<xref ref-type="disp-formula" rid="E10">Equation (10)</xref>] instead of the maximum likelihood, we adapt the parameter &#x003b2; to the whole information in the observed data as opposed to fitting it to the point estimates. This results in further reduction in bias.
</p><fig id="btz355-F4" orientation="portrait" position="float"><label>Fig. 4.</label><caption><p>Bias in the topology prior probabilities and how the Bayesian approach mitigates this bias</p></caption><graphic xlink:href="btz355f4"/></fig><p>To reconstruct the phylogenetic tree structures, we use MAP estimation after the parameter &#x003b2; has been computed using the above Bayesian EM approach. For each tumor <italic>i</italic>, we have:
<disp-formula id="E11"><label>(11)</label><mml:math id="M11"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mo>{</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="normal">&#x003b2;</mml:mi><mml:mo>)</mml:mo><mml:mo>}</mml:mo></mml:math></disp-formula></p></sec><sec><title>2.5 Generalization to multiple samples per tumor</title><p>In the more general case where multiple samples (obtained, for example, by sequencing multiple regions of the tumor) are available for a given tumor, we define the likelihood of tumor data [previously shown in <xref ref-type="disp-formula" rid="E9">Equation (9)</xref> for the single-sample case] as the product of the likelihoods of the individual samples:
<disp-formula id="E12"><label>(12)</label><mml:math id="M12"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">&#x0220f;</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>&#x02248;</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">&#x0220f;</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:munder><mml:mo stretchy="false">&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b8;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b4;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x00394;</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">&#x0220f;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b8;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b8;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>s<sub>i</sub></italic> is the number of samples for tumor <italic>i</italic> and <inline-formula id="IE38"><mml:math id="IM38"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>.</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula id="IE39"><mml:math id="IM39"><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>.</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> are the read count data for sample <italic>q</italic> of tumor <italic>i</italic>.</p></sec><sec><title>2.6 Extracting prognostic information</title><p>The likelihood that each mutation <italic>c</italic> follows an ancestry set <inline-formula id="IE40"><mml:math id="IM40"><mml:mi mathvariant="script">P</mml:mi></mml:math></inline-formula> is computed as:
<disp-formula id="E13"><label>(13)</label><mml:math id="M13"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula>
where <inline-formula id="IE41"><mml:math id="IM41"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the evidence for <inline-formula id="IE42"><mml:math id="IM42"><mml:mi mathvariant="script">P</mml:mi></mml:math></inline-formula> computed as:
<disp-formula id="E14"><label>(14)</label><mml:math id="M14"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:munder><mml:mo stretchy="false">&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x000d7;</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="normal">&#x003b2;</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi mathvariant="normal">&#x003f5;</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>
where the function <inline-formula id="IE43"><mml:math id="IM43"><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> returns all the ancestry sets in tree <italic>T<sub>i</sub></italic>.</p><p>Because <inline-formula id="IE44"><mml:math id="IM44"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is a proportion estimate, the minimum value for the sample size <inline-formula id="IE45"><mml:math id="IM45"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to have a 95% confidence interval of width <italic>W</italic> can be computed as <inline-formula id="IE46"><mml:math id="IM46"><mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> (e.g. <inline-formula id="IE47"><mml:math id="IM47"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02265;</mml:mo><mml:mn>100</mml:mn></mml:math></inline-formula> for <italic>W&#x02009;</italic>=<italic>&#x02009;</italic>0.2).</p></sec></sec><sec><title>3 Experiments and results</title><sec><title>3.1 Experiments with synthetic data</title><p>We evaluated the performance of Hintra using synthetic data to have access to the ground-truth phylogenetic trees. The comparison partners included Revolver (<xref rid="btz355-B5" ref-type="bibr">Caravagna <italic>et al.</italic>, 2018</xref>), as the only method that explores a similar idea of collaborative ITH detection, and ClonEvol (<xref rid="btz355-B6" ref-type="bibr">Dang <italic>et al.</italic>, 2017</xref>), as the state-of-the-art method for stand-alone ITH detection. We used the same evaluation metric as in <xref rid="btz355-B5" ref-type="bibr">Caravagna <italic>et al.</italic> (2018)</xref>, namely true positive ratio, which is the proportion of predicted edges that exist in the ground-truth tree.</p><p>For comparison with Revolver, we conducted three different experiments. The first experiment evaluated the information transfer and de-noising capabilities of Hintra. In this experiment, we followed exactly the same simulation procedure used for evaluating Revolver. The second experiment showcased one of our main contributions, the ability of Hintra to capture more complete evolutionary patterns. This experiment was based on Scenario A in <xref ref-type="fig" rid="btz355-F2">Figure&#x000a0;2</xref>. The third experiment examined the ability of Hintra to control the topology distribution bias and it was based on Scenario B shown in <xref ref-type="fig" rid="btz355-F2">Figure&#x000a0;2</xref>.</p><p>As in <xref rid="btz355-B5" ref-type="bibr">Caravagna <italic>et al.</italic> (2018)</xref>, the sensitivity to CCF noise levels are monitored in the three experiments, where noise follows a Gaussian distribution and was controlled through tweaking the SD (e.g. 0 or 0.05). Moreover, ambiguity was introduced into the ground-truth models as the percentage of tumors with CCFs that had different possible phylogenetic structures (i.e. ambiguous cases). These experiments were conducted assuming a single sample per tumor. To evaluate the effect of the number of samples on the methods&#x02019; performance, we conducted an additional set of experiments where 2 or 4 samples were generated per tumor, and considering the most difficult simulation configuration, i.e. higher noise and ambiguity. All samples of a tumor were assumed to be ambiguous for ambiguous cases and they were all non-ambiguous otherwise. For each configuration of the parameters, the experiment was repeated 10 times with <italic>de novo</italic> generation of the synthetic data at each repetition. For each single repetition, the average true positive ratio over all tumors was computed and plotted as a point. We simulate a sequencing coverage of 100&#x000d7; in all experiments.</p><p>The synthetic data in <xref rid="btz355-B5" ref-type="bibr">Caravagna <italic>et al.</italic> (2018)</xref> was produced by assuming the same evolutionary tree (a chain structure) consisting of four mutations across all tumors. We repeated the same experiments for a cohort of 50 tumors. Two CCF noise levels of 0 and 0.05 and three different percentages of ambiguous cases (10, 30 and 50%) were simulated as in the original paper. The results are shown in <xref ref-type="fig" rid="btz355-F5">Figure&#x000a0;5</xref>. According to <xref ref-type="fig" rid="btz355-F5">Figure&#x000a0;5</xref>, unlike ClonEvol, both Hintra and Revolver were able to detect the correct phylogenetic trees for all tumors and for all levels of ambiguity when there was no noise in the CCFs. However, after introducing noise with SD 0.05 to the true CCFs, the level of ambiguity had a stronger effect on performance. Hintra outperformed Revolver in all the datasets with noise, and the gap between the two methods increased with increasing level of ambiguity. This indicates the higher robustness of Hintra to noise and ambiguity. Interestingly, by increasing the number of samples, the performance of the stand-alone algorithm improved but the collaborative methods exhibited decreasing accuracy. These results are consistent with the original study (<xref rid="btz355-B5" ref-type="bibr">Caravagna <italic>et al.</italic>, 2018</xref>). The most likely reason for this is the high level of ambiguity (50%). For ambiguous cases, multiple noisy samples create conflicting phylogenies which leads to a higher probability for branching structures. Thus, transferring information from the ambiguous cases decreases the overall accuracy. The stand-alone method is less sensitive because each tumor is analyzed separately. We note that it is very unlikely that in real data all samples of a tumor with a ground-truth chain structure are ambiguous as we assumed here. Hintra, in general, performs slightly better than the two other methods for larger numbers of samples.
</p><fig id="btz355-F5" orientation="portrait" position="float"><label>Fig. 5.</label><caption><p>Results for the synthetic datasets from <xref rid="btz355-B5" ref-type="bibr">Caravagna <italic>et al.</italic> (2018)</xref></p></caption><graphic xlink:href="btz355f5"/></fig><p>In the second experiment, we simulated Scenario A shown in <xref ref-type="fig" rid="btz355-F2">Figure&#x000a0;2</xref> for a cohort of 50 tumors (35 with tree 1 and 15 with tree 2). Because the ground-truth topologies have branches and so are associated with ambiguous cases, we only investigated the noise level and the number of samples as the variable factor. Two noise levels of 0 and 0.05 were simulated. The results are shown in <xref ref-type="fig" rid="btz355-F6">Figure&#x000a0;6</xref>. We observe that there are considerable gaps between the performances of the three methods. As explained earlier, the gap between Revolver and Hintra is due to the differences in the definitions of the tree topology factors, where Hintra looks further back into the evolutionary history of a subclone and provides a more accurate assignment of the mutations based on that richer information. Unlike the previous scenario, having more samples improves the performance of the methods in this scenario. This is due to the fact that the trees are consistently branching topologies in this scenario. These topologies are associated with ambiguous cases and, unlike for chain topologies, having multiple ambiguous noisy samples is not misleading for these cases. Overall, Hintra performs slightly better than the two other methods with a larger number of samples.
</p><fig id="btz355-F6" orientation="portrait" position="float"><label>Fig. 6.</label><caption><p>Results for the synthetic datasets based on Scenario A from <xref ref-type="fig" rid="btz355-F2">Figure&#x000a0;2</xref></p></caption><graphic xlink:href="btz355f6"/></fig><p>For the third experiment, we simulated Scenario B as shown in <xref ref-type="fig" rid="btz355-F2">Figure&#x000a0;2</xref>. Two levels of noise (0 and 0.05) were introduced to the CCFs and 6, 10 and 14% were used as the frequency of ambiguous cases. The goal of this experiment was to investigate the capability of the methods to control the bias toward branching structures. Accordingly, we set small ambiguity levels to leave enough evidence for the true structures and examined whether the methods could still infer branching structures in absence of direct evidence. The branching structure was still supported indirectly due to the two conflicting structures of trees 1 and 2, but there were not enough ambiguous cases to support that structure. <xref ref-type="fig" rid="btz355-F7">Figure&#x000a0;7</xref> shows the results. Because of the low levels of ambiguity, the true positive rates were in general high for all methods. However, CloneEvol and Hintra performed better than Revolver in this experiment. CloneEvol performed stand-alone phylogeny inference and chose one of the two possible topologies (chain and branching) at random. However, Revolver had a bias toward branching structures and preferred that structure whenever it was possible. Hintra had less bias in the topology distribution due to the Bayesian EM approach and opted for the branching structure only whenever it had high probability. Therefore, Hintra controlled the bias effectively for all levels of ambiguity and noise in our experiments. When more samples were used per tumor with a noise of 0.05 and an ambiguity of 14%, all the methods showed improvement. Due to the small ambiguity, more samples improved the evidence for the correct topology and strengthened the information transferred from those cases, which resulted in a better resolution for the ambiguous cases. Overall, Hintra once again outperformed the other methods when multiple samples were used.
</p><fig id="btz355-F7" orientation="portrait" position="float"><label>Fig. 7.</label><caption><p>Results for the synthetic datasets based on Scenario B from <xref ref-type="fig" rid="btz355-F2">Figure&#x000a0;2</xref></p></caption><graphic xlink:href="btz355f7"/></fig></sec><sec><title>3.2 Experiments with real data</title><p>In the absence of ground-truth phylogenetic trees for tumor mutations, performing an objective comparison of the accuracy of Hintra and any other method is difficult. Instead, we evaluated Hintra&#x02019;s performance based on the consistency of the learned parameters with existing biological domain knowledge. We chose Breast Cancer as the subject of study, since it is one of the most studied cancer types for which a rich body of domain knowledge is available. We used a public dataset from <xref rid="btz355-B25" ref-type="bibr">Razavi <italic>et al.</italic> (2018)</xref>, which includes 1756 advanced breast cancer patients. This dataset is the most recently published genomic dataset for Breast Cancer with clinical data.</p><p>In the available clinical data, these patients were stratified according to whether they do or do not express the genes for the receptors for the hormones estrogen and progesterone (HR) and HER2, resulting in the HR+/HER2&#x02212;, HR+/HER2+, HR&#x02212;/HER2+ and TN (Triple Negative) subtypes. We used this information to separate the patients into four corresponding groups and ran Hintra for each group independently to infer tumor progression and phylogenetic trees. We only included tumors having single nucleotide variations (SNVs) and a normal copy number in the considered loci. We considered mutations in breast cancer genes from COSMIC Cancer Gene Census dataset [<email>cancer.sanger.ac.uk</email> (<xref rid="btz355-B13" ref-type="bibr">Harsha <italic>et al.</italic>, 2016</xref>)] and augmented the list by the genes mentioned in the original study (<xref rid="btz355-B25" ref-type="bibr">Razavi <italic>et al.</italic>, 2018</xref>). After limiting to the selected genes and filtering out synonymous mutations, loss of heterozygosity and weak signals (i.e. small read counts and mutations with &#x0003c;1% frequency in each subtype), the number of patients with at least one mutation was reduced to 1348. We also limited the number of mutated genes per tumor to 5 and removed the 47 tumors (3.5%) that did not satisfy this constraint.</p><p>A large subset of the cohort was HR+/HER2&#x02212; cases. In a majority of cases in this subtype, we observed clonal mutation acquisition in signaling cascades (TP53, PIK3CA, AKT, GATA3, PTEN, etc.) as discussed in the original findings (<xref rid="btz355-B25" ref-type="bibr">Razavi <italic>et al.</italic>, 2018</xref>), suggesting that Hintra is able to reliably detect these early mutational associations. Hintra also found that the most likely descendant of TP53 and PIK3CA combinatory events in HR+/HER2&#x02212; subtype is PTEN, which occurs with probability 0.2. We consulted the literature and found some inconsistencies between studies with regarding the relationship of PTEN to PIK3CA. For example, some studies argue that PIK3CA is mutually exclusive to PTEN (<xref rid="btz355-B28" ref-type="bibr">Stemke-Hale <italic>et al.</italic>, 2008</xref>), while others state that PIK3CA could be characterized together with PTEN deletions for HR+ subtypes (<xref rid="btz355-B21" ref-type="bibr">Mukohara, 2015</xref>). In the dataset we used, the mutual exclusivity of PIK3CA and PTEN mutations was observed across the cohort. Our results suggest that TP53 may have some additive effects on PTEN and its association to PIK3CA. This may be a potentially interesting topic since TP53 and PTEN are both tumor suppressors and could provide a tumorigenic advantage to these aggressive subtypes. Consistent with the existing knowledge, Hintra detected TP53 as the most important initiator preceding GATA3, CDH1 and FOXA1, which are commonly associated with invasive lobular carcinoma, a subtype within HR+/HER2&#x02212;. A high proportion of HR+/HER2&#x02212; cases acquire a CDH1 mutation, which is a hallmark of lobular carcinoma. Furthermore, it is known that CDH1 loss and PIK3CA gain of function are highly correlated with these outcomes; however, their order is not accounted for in the literature, and when these mutations are mentioned, they are characterized as a group (<xref rid="btz355-B1" ref-type="bibr">An <italic>et al.</italic>, 2018</xref>). Interestingly, we found that CDH1 is almost three times as likely to be the initiator of this association with PIK3CA, which may provide some insights on the development of lobular carcinoma.</p><p>The limited number of samples in the other three subtypes (HR&#x02212;/HER2+, HR+/HER2+ and TN) resulted in weaker signals. Among the stronger patterns derived from the parameters learned by Hintra, we observed that TP53 is almost twice as likely to be an initiator driver mutation when associated with PIK3CA in HR&#x02212;/HER2+ and TN tumors. This adds to the results of PCAWG studies such as <xref rid="btz355-B11" ref-type="bibr">Gerstung <italic>et al.</italic> (2018)</xref> demonstrating that driver mutations in PIK3CA and TP53 are more likely to be clonal.</p></sec><sec><title>3.3 Computational resources analysis</title><p>The size of the input for collaborative ITH detection can be defined in terms of the CCF discretization hyper-parameter &#x00394;, number of tumors <italic>m</italic>, the number of mutations per tumor and the number of unique mutation profiles referred to as &#x02018;combinations&#x02019;. Here, &#x02018;profile&#x02019; stands for the set of observed mutations for the corresponding tumor. In addition to these factors, the number of utilized Central Processing Unit (CPU) cores can affect the time and memory resources consumed by the different methods.</p><p>To evaluate the effects of these factors, a set of experiments with synthetic data was conducted. The range of values tested and the default values for each of the factors are provided in <xref rid="btz355-T1" ref-type="table">Table&#x000a0;1</xref>. When studying the effect of each factor by changing its value, all other factors were set to their default values. The datasets were generated following the approach in <xref rid="btz355-B5" ref-type="bibr">Caravagna <italic>et al.</italic> (2018)</xref>. Different combinations of mutations were generated based on the assumption that half of the mutations of a new combination should already exist in the previous combinations (each mutation can belong to a different existing combination) and half of them should be new mutations not existing in any of the previous combinations. This mimics the real data distribution in the way that it assigns higher probability of mutation to a few genes and promotes heterogeneity.</p><table-wrap id="btz355-T1" orientation="portrait" position="float"><label>Table 1.</label><caption><p>Problem size factors considered in the running time analysis</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="center" span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1">Factor</th><th rowspan="1" colspan="1">Values</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">Samples (<italic>m</italic>)</td><td rowspan="1" colspan="1">20, <italic>40</italic>, 60</td></tr><tr><td rowspan="1" colspan="1">Mutations per sample</td><td rowspan="1" colspan="1">3, <italic>4</italic>, 5</td></tr><tr><td rowspan="1" colspan="1">Combinations</td><td rowspan="1" colspan="1">1, <italic>5</italic>, 10</td></tr><tr><td rowspan="1" colspan="1">&#x00394;</td><td rowspan="1" colspan="1">0.025, <italic>0.050</italic>, 0.100</td></tr><tr><td rowspan="1" colspan="1">CPU cores</td><td rowspan="1" colspan="1">2, <italic>4</italic>, 6</td></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><p>
<italic>Note</italic>: Default values are italicized.</p></fn></table-wrap-foot></table-wrap><p>Both Hintra and Revolver consist of two phases: preprocessing and EM. During Phase I (preprocessing), Revolver uses ClonEvol to construct and score the trees for each tumor and selects the top trees as candidates. Hintra computes the marginal likelihood using <xref ref-type="disp-formula" rid="E9">Equation (9)</xref>. The results of this phase could be stored in both algorithms to avoid re-computation costs. During Phase II (EM), both algorithms learn the parameters. The maximum number of EM iterations was set to 100 for both Hintra and Revolver in these experiments. We measured the running times for the two phases separately for better interpretation. The results are shown in <xref ref-type="fig" rid="btz355-F8">Figure&#x000a0;8</xref>. According to these results, Revolver performed the first phase more efficiently and was less sensitive to the problem size. This is due to the efficient strategy used in ClonEvol for searching the tree topology space, whereby the search space is pruned based on the consistency of the subtrees with the CCFs, resulting in a considerably smaller search space. On the other hand, the current implementation of Hintra enumerates all possible topologies, whose number is combinatorially related to the number of mutations. Furthermore, unlike Hintra, ClonEvol requires the clonal mutation to be identified in the input and it builds the tree of the rest of the mutations under that clonal mutation. This has the significant effect of reducing the search space by fixing one node.
</p><fig id="btz355-F8" orientation="portrait" position="float"><label>Fig. 8.</label><caption><p>Results of running time and memory analysis</p></caption><graphic xlink:href="btz355f8"/></fig><p>Another important factor affecting the running time of Hintra is &#x00394;. The running time of Hintra contains a term proportional to <inline-formula id="IE48"><mml:math id="IM48"><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:msup><mml:mrow><mml:mi mathvariant="normal">&#x00394;</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mi>x</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math></inline-formula>, where <italic>x</italic> is the number of mutations in a sample. Our experiments (results not shown) indicate that there was no noticeable difference between the accuracy of Hintra when <inline-formula id="IE49"><mml:math id="IM49"><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:math></inline-formula> or <inline-formula id="IE50"><mml:math id="IM50"><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:math></inline-formula> and the latter can be used to improve the speed without sacrificing the accuracy. Yet, using <inline-formula id="IE51"><mml:math id="IM51"><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:math></inline-formula>, our experiment with breast cancer HR+/HER2&#x02212; subtype (see Section 3.2), consisting of 1019 samples with up to 5 mutations, took about 50&#x02009;min. The running time of both methods scales linearly with the number of tumors. In contrast to Revolver, which does not allow parallel processing in Phase I, using more CPU cores improves the running time performance of Hintra (see <xref ref-type="fig" rid="btz355-F8">Fig.&#x000a0;8</xref>).</p><p>In Phase II, Hintra was in general more efficient than Revolver. However, it was more sensitive to the number of mutations. This can be explained by the fact that Hintra integrates over all tree topologies while Revolver focuses only on a set of top trees selected by ClonEvol, the size of which is bounded independently of the number of mutations.</p><p>The running time of Hintra in both Phases I and II can be improved by using alternative approaches. For example, one can use ClonEvol and then integrate only over the selected trees in the probabilistic framework of Hintra. Alternatively, Monte Carlo Markov Chain approaches as in (<xref rid="btz355-B26" ref-type="bibr">Ross and Markowetz, 2016</xref>) can be used to sample high likelihood trees in constant time. These approaches are expected to result in a small loss of accuracy as the density over tree topologies would be concentrated in a small area of the search space. Another way of improving the running time is limiting the summation in <xref ref-type="disp-formula" rid="E9">Equation (9)</xref> to &#x003b8; values close to the observed CCFs. Because these values are associated with larger likelihoods, we expect this approximation to be close to the true value.</p><p>The memory consumption of Hintra is also shown in <xref ref-type="fig" rid="btz355-F8">Figure&#x000a0;8</xref>. Based on these results, the number of mutations per sample is the only important factor for the amount of memory used. This affects the number of possible ancestry sets as well as the total number of mutations <italic>n</italic>. These two values determine the size of the &#x003b2; parameter. Moreover, the number of mutations per sample determines the number of possible topologies, which indicates the number of marginal likelihoods that need to be computed and stored. While Hintra consumes up to about 12&#x02009;MB, Revolver uses about 4&#x02009;GB of memory during its execution (not shown in the figure due to the large magnitude). This may be due to the implementation of Revolver in R, which is very inefficient compared to C++, which we used to implement Hintra.</p></sec></sec><sec><title>4 Conclusions</title><p>We presented Hintra as a new method for collaborative ITH detection. Hintra is a PGM with a novel tree prior probability that considers all the mutations preceding a particular mutation in the phylogenetic tree, instead of only the most recent one. It uses a Bayesian approach to learn its parameters, which mitigates the bias toward branching topologies found in other tools. We compared Hintra&#x02019;s performance using synthetic and real data against both a stand-alone and a collaborative method. In our experiments on synthetic datasets, we demonstrated the effectiveness of both proposed tree prior probability and Bayesian learning method using different scenarios. Similarly, for synthetic data from the literature, Hintra inferred the true phylogenetic trees with more accuracy compared to the state-of-the-art.</p><p>In our experiments on breast cancer data, Hintra&#x02019;s findings were consistent with the existing domain knowledge. Moreover, based on the prognostic parameters learned, Hintra provided new insights of potential interest. We note that the experiments on breast cancer data used only SNVs. CNVs were excluded due to the difficulties that they cause in inferring correct CCFs, which would be later transformed into read counts for phylogeny detection by Hintra. Although there are tools for inferring the CCF values for CNVs [e.g. PyClone (<xref rid="btz355-B27" ref-type="bibr">Roth <italic>et al.</italic>, 2014</xref>)], their accuracy is limited for low-coverage cross-sectional data. Including CNV data will be considered in future work as both the sequencing technologies and CCF inference tools improve.</p><p>In the current implementation of Hintra a limited number of mutations can be considered for each patient. This number depends on the available computational resources. Although in some datasets (e.g. the breast cancer dataset used in Section 3.2) this limitation does not result in a considerable information loss (3.5% of the samples with more than 5 mutations), in general it can limit the findings to only well-known driver genes and a subset of the patients. Part of this problem is resolved by enabling parallel computing. Further improvements in running time can be achieved by using the ideas discussed in Section 3.3 for future implementation.</p><p>Although the presented probabilistic framework of Hintra considers a model for read count data, generalization to other increasingly available data types (e.g. binary data from single-cell sequencing) using appropriate distributions (e.g. Bernoulli) is also possible. Investigating the possibility of an intrinsically unbiased prior probability for phylogenetic trees that is suitable for a collaborative framework is another direction for future work.</p></sec></body><back><ack id="ack1"><title>Acknowledgements</title><p>We thank Dr. Giulio Caravagna for answering our questions and providing the source code for Revolver simulations.</p><p>
<italic>Conflict of Interest</italic>: none declared.</p></ack><ref-list id="ref1"><title>References</title><ref id="btz355-B1"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>An</surname><given-names>Y.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Cdh1 and pik3ca mutations cooperate to induce immune-related invasive lobular carcinoma of the breast</article-title>. <source>Cell Rep</source>., <volume>25</volume>, <fpage>702</fpage>&#x02013;<lpage>714.e6</lpage>.<pub-id pub-id-type="pmid">30332649</pub-id></mixed-citation></ref><ref id="btz355-B2"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Attolini</surname><given-names>C.S.-O.</given-names></name></person-group>
<etal>et al</etal> (<year>2010</year>) 
<article-title>A mathematical framework to determine the temporal sequence of somatic genetic events in cancer</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>107</volume>, <fpage>17604</fpage>&#x02013;<lpage>17609</lpage>.<pub-id pub-id-type="pmid">20864632</pub-id></mixed-citation></ref><ref id="btz355-B3"><mixed-citation publication-type="book">
<person-group person-group-type="author"><name name-style="western"><surname>Beerenwinkel</surname><given-names>N.</given-names></name></person-group>
<etal>et al</etal> (<year>2004</year>). <chapter-title>Learning multiple evolutionary pathways from cross-sectional data</chapter-title> In: <source>Proceedings of the Eighth Annual International Conference on Research in Computational Molecular Biology, RECOMB &#x02019;04</source>, San Diego, California, USA, pp. <fpage>36</fpage>&#x02013;<lpage>44</lpage>. 
<publisher-name>ACM</publisher-name>, 
<publisher-loc>New York, NY</publisher-loc>.</mixed-citation></ref><ref id="btz355-B4"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Beerenwinkel</surname><given-names>N.</given-names></name></person-group>
<etal>et al</etal> (<year>2007</year>) 
<article-title>Conjunctive Bayesian networks</article-title>. <source>Bernoulli</source>, <volume>13</volume>, <fpage>893</fpage>&#x02013;<lpage>909</lpage>.</mixed-citation></ref><ref id="btz355-B5"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Caravagna</surname><given-names>G.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Detecting repeated cancer evolution from multi-region tumor sequencing data</article-title>. <source>Nat. Methods</source>, <volume>15</volume>, <fpage>707</fpage>&#x02013;<lpage>714</lpage>.<pub-id pub-id-type="pmid">30171232</pub-id></mixed-citation></ref><ref id="btz355-B6"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Dang</surname><given-names>H.X.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>ClonEvol: clonal ordering and visualization in cancer sequencing</article-title>. <source>Ann. Oncol</source>., <volume>28</volume>, <fpage>3076</fpage>&#x02013;<lpage>3082</lpage>.<pub-id pub-id-type="pmid">28950321</pub-id></mixed-citation></ref><ref id="btz355-B7"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Deshwar</surname><given-names>A.G.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>PhyloWGS: reconstructing subclonal composition and evolution from whole-genome sequencing of tumors</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>35.</fpage><pub-id pub-id-type="pmid">25786235</pub-id></mixed-citation></ref><ref id="btz355-B8"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Donmez</surname><given-names>N.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Clonality inference from single tumor samples using low-coverage sequence data</article-title>. <source>J. Comput. Biol</source>., <volume>24</volume>, <fpage>515</fpage>&#x02013;<lpage>523</lpage>.<pub-id pub-id-type="pmid">28056180</pub-id></mixed-citation></ref><ref id="btz355-B9"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>El-Kebir</surname><given-names>M.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>Reconstruction of clonal trees and tumor composition from multi-sample sequencing data</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>i62</fpage>&#x02013;<lpage>i70</lpage>.<pub-id pub-id-type="pmid">26072510</pub-id></mixed-citation></ref><ref id="btz355-B10"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Gerstung</surname><given-names>M.</given-names></name></person-group>
<etal>et al</etal> (<year>2009</year>) 
<article-title>Quantifying cancer progression with conjunctive Bayesian networks</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>2809</fpage>&#x02013;<lpage>2815</lpage>.<pub-id pub-id-type="pmid">19692554</pub-id></mixed-citation></ref><ref id="btz355-B11"><mixed-citation publication-type="other">
<person-group person-group-type="author"><name name-style="western"><surname>Gerstung</surname><given-names>M.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>). The evolutionary history of 2, 658 cancers. <italic>bioRxiv</italic>. Doi: 10.1101/161562.</mixed-citation></ref><ref id="btz355-B12"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Hajirasouliha</surname><given-names>I.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>A combinatorial approach for analyzing intra-tumor heterogeneity from high-throughput sequencing data</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>i78</fpage>&#x02013;<lpage>i86</lpage>.<pub-id pub-id-type="pmid">24932008</pub-id></mixed-citation></ref><ref id="btz355-B13"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Harsha</surname><given-names>B.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>COSMIC: somatic cancer genetics at high-resolution</article-title>. <source>Nucleic Acids Res</source>., <volume>45</volume>, <fpage>D777</fpage>&#x02013;<lpage>D783</lpage>.<pub-id pub-id-type="pmid">27899578</pub-id></mixed-citation></ref><ref id="btz355-B14"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Jahn</surname><given-names>K.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>Tree inference for single-cell data</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>86.</fpage><pub-id pub-id-type="pmid">27149953</pub-id></mixed-citation></ref><ref id="btz355-B15"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Jiao</surname><given-names>W.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>Inferring clonal evolution of tumors from single nucleotide somatic mutations</article-title>. <source>BMC Bioinformatics</source>, <volume>15</volume>, <fpage>35.</fpage><pub-id pub-id-type="pmid">24484323</pub-id></mixed-citation></ref><ref id="btz355-B16"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Loohuis</surname><given-names>L.O.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>Inferring tree causal models of cancer progression with probability raising</article-title>. <source>PLoS One</source>, <volume>9</volume>, <fpage>e108358</fpage>.<pub-id pub-id-type="pmid">25299648</pub-id></mixed-citation></ref><ref id="btz355-B17"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Malikic</surname><given-names>S.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>Clonality inference in multiple tumor samples using phylogeny</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>1349</fpage>&#x02013;<lpage>1356</lpage>.<pub-id pub-id-type="pmid">25568283</pub-id></mixed-citation></ref><ref id="btz355-B18"><mixed-citation publication-type="other">
<person-group person-group-type="author"><name name-style="western"><surname>Malikic</surname><given-names>S.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>). Integrative inference of subclonal tumour evolution from single-cell and bulk sequencing data. <italic>bioRxiv</italic>. Doi: 10.1101/234914.</mixed-citation></ref><ref id="btz355-B19"><mixed-citation publication-type="other">
<person-group person-group-type="author"><name name-style="western"><surname>Malikic</surname><given-names>S.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>). PhISCS&#x02014;a combinatorial approach for sub-perfect tumor phylogeny reconstruction via integrative use of single cell and bulk sequencing data. <italic>bioRxiv</italic>. Doi: 10.1101/376996.</mixed-citation></ref><ref id="btz355-B20"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Misra</surname><given-names>N.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>Inferring the paths of somatic evolution in cancer</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>2456</fpage>&#x02013;<lpage>2463</lpage>.<pub-id pub-id-type="pmid">24812340</pub-id></mixed-citation></ref><ref id="btz355-B21"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Mukohara</surname><given-names>T.</given-names></name></person-group> (<year>2015</year>) 
<article-title>Pi3k mutations in breast cancer: prognostic and therapeutic implications</article-title>. <source>Breast Cancer (Dove Med. Press)</source>, <volume>7</volume>, <fpage>111</fpage>&#x02013;<lpage>123</lpage>.<pub-id pub-id-type="pmid">26028978</pub-id></mixed-citation></ref><ref id="btz355-B22"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Pathare</surname><given-names>S.</given-names></name></person-group>
<etal>et al</etal> (<year>2009</year>) 
<article-title>Construction of oncogenetic tree models reveals multiple pathways of oral cancer progression</article-title>. <source>Int. J. Cancer</source>, <volume>124</volume>, <fpage>2864</fpage>&#x02013;<lpage>2871</lpage>.<pub-id pub-id-type="pmid">19267402</pub-id></mixed-citation></ref><ref id="btz355-B23"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Popic</surname><given-names>V.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>Fast and scalable inference of multi-sample cancer lineages</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>91.</fpage><pub-id pub-id-type="pmid">25944252</pub-id></mixed-citation></ref><ref id="btz355-B24"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Ramazzotti</surname><given-names>D.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>CAPRI: efficient inference of cancer progression models from cross-sectional data</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>3016</fpage>&#x02013;<lpage>3026</lpage>.<pub-id pub-id-type="pmid">25971740</pub-id></mixed-citation></ref><ref id="btz355-B25"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Razavi</surname><given-names>P.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>The genomic landscape of endocrine-resistant advanced breast cancers</article-title>. <source>Cancer Cell</source>, <volume>34</volume>, <fpage>427</fpage>&#x02013;<lpage>438.e6</lpage>.<pub-id pub-id-type="pmid">30205045</pub-id></mixed-citation></ref><ref id="btz355-B26"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Ross</surname><given-names>E.M.</given-names></name>, <name name-style="western"><surname>Markowetz</surname><given-names>F.</given-names></name></person-group> (<year>2016</year>) 
<article-title>OncoNEM: inferring tumor evolution from single-cell sequencing data</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>69.</fpage><pub-id pub-id-type="pmid">27083415</pub-id></mixed-citation></ref><ref id="btz355-B27"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Roth</surname><given-names>A.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>PyClone: statistical inference of clonal population structure in cancer</article-title>. <source>Nat. Methods</source>, <volume>11</volume>, <fpage>396</fpage>&#x02013;<lpage>398</lpage>.<pub-id pub-id-type="pmid">24633410</pub-id></mixed-citation></ref><ref id="btz355-B28"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Stemke-Hale</surname><given-names>K.</given-names></name></person-group>
<etal>et al</etal> (<year>2008</year>) 
<article-title>An integrative genomic and proteomic analysis of PIK3CA, PTEN, and AKT mutations in breast cancer</article-title>. <source>Cancer Res</source>., <volume>68</volume>, <fpage>6084</fpage>&#x02013;<lpage>6091</lpage>.<pub-id pub-id-type="pmid">18676830</pub-id></mixed-citation></ref><ref id="btz355-B29"><mixed-citation publication-type="book">
<person-group person-group-type="author"><name name-style="western"><surname>Suppes</surname><given-names>P.</given-names></name></person-group> (<year>1970</year>). <source>A Probabilistic Theory of Causality</source>. 
<publisher-name>North-Holland Publishing Co</publisher-name>, Amsterdam, Netherlands.</mixed-citation></ref><ref id="btz355-B30"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Zafar</surname><given-names>H.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>SiFit: inferring tumor trees from single-cell sequencing data under finite-sites models</article-title>. <source>Genome Biol</source>., <volume>18</volume>, <fpage>178</fpage>.<pub-id pub-id-type="pmid">28927434</pub-id></mixed-citation></ref></ref-list></back></article>