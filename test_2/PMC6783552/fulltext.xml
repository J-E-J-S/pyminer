<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN" "JATS-archivearticle1-mathml3.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nat Commun</journal-id><journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id><journal-title-group><journal-title>Nature Communications</journal-title></journal-title-group><issn pub-type="epub">2041-1723</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6783552</article-id><article-id pub-id-type="publisher-id">12630</article-id><article-id pub-id-type="doi">10.1038/s41467-019-12630-7</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>SCALE method for single-cell ATAC-seq analysis via latent feature extraction</article-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2392-114X</contrib-id><name><surname>Xiong</surname><given-names>Lei</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Xu</surname><given-names>Kui</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Tian</surname><given-names>Kang</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Shao</surname><given-names>Yanqiu</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Tang</surname><given-names>Lei</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Gao</surname><given-names>Ge</given-names></name><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Zhang</surname><given-names>Michael</given-names></name><xref ref-type="aff" rid="Aff4">4</xref><xref ref-type="aff" rid="Aff5">5</xref><xref ref-type="aff" rid="Aff6">6</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3833-4498</contrib-id><name><surname>Jiang</surname><given-names>Tao</given-names></name><xref ref-type="aff" rid="Aff7">7</xref><xref ref-type="aff" rid="Aff8">8</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4913-0338</contrib-id><name><surname>Zhang</surname><given-names>Qiangfeng Cliff</given-names></name><address><email>qczhang@tsinghua.edu.cn</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0662 3178</institution-id><institution-id institution-id-type="GRID">grid.12527.33</institution-id><institution>MOE Key Laboratory of Bioinformatics, Beijing Advanced Innovation Center for Structural Biology, Center for Synthetic and Systems Biology, Tsinghua-Peking Center for Life Sciences, School of Life Sciences, </institution><institution>Tsinghua University, </institution></institution-wrap>100084 Beijing, China </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2256 9319</institution-id><institution-id institution-id-type="GRID">grid.11135.37</institution-id><institution>Beijing Advanced Innovation Center for Genomics (ICG), Biomedical Pioneering Innovation Center (BIOPIC), </institution><institution>Peking University, </institution></institution-wrap>100871 Beijing, China </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2256 9319</institution-id><institution-id institution-id-type="GRID">grid.11135.37</institution-id><institution>State Key Laboratory of Protein and Plant Gene Research, School of Life Sciences, Center for Bioinformatics, </institution><institution>Peking University, </institution></institution-wrap>100871 Beijing, China </aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0662 3178</institution-id><institution-id institution-id-type="GRID">grid.12527.33</institution-id><institution>Bioinformatics Division, BNRist, Department of Automation, </institution><institution>Tsinghua University, </institution></institution-wrap>100084 Beijing, China </aff><aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2151 7939</institution-id><institution-id institution-id-type="GRID">grid.267323.1</institution-id><institution>Department of Biological Sciences, Center for Systems Biology, </institution><institution>The University of Texas, </institution></institution-wrap>Dallas 800 West Campbell Road, RL11, Richardson, TX 75080-3021 USA </aff><aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0662 3178</institution-id><institution-id institution-id-type="GRID">grid.12527.33</institution-id><institution>MOE Key Laboratory of Bioinformatics, Center for Synthetic and Systems Biology, School of Medicine, </institution><institution>Tsinghua University, </institution></institution-wrap>100084 Beijing, China </aff><aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2222 1582</institution-id><institution-id institution-id-type="GRID">grid.266097.c</institution-id><institution>Department of Computer Science and Engineering, </institution><institution>University of California, </institution></institution-wrap>Riverside, CA 92521 USA </aff><aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0662 3178</institution-id><institution-id institution-id-type="GRID">grid.12527.33</institution-id><institution>Bioinformatics Division, BNRIST; Department of Computer Science and Technology, </institution><institution>Tsinghua University, </institution></institution-wrap>100084 Beijing, China </aff></contrib-group><pub-date pub-type="epub"><day>8</day><month>10</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>8</day><month>10</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>10</volume><elocation-id>4576</elocation-id><history><date date-type="received"><day>26</day><month>2</month><year>2019</year></date><date date-type="accepted"><day>20</day><month>9</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2019</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article&#x02019;s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article&#x02019;s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">Single-cell ATAC-seq (scATAC-seq) profiles the chromatin&#x000a0;accessibility landscape at single cell level, thus revealing cell-to-cell variability in gene regulation. However, the high dimensionality and sparsity of scATAC-seq data often complicate the analysis. Here, we introduce a method for analyzing scATAC-seq data, called Single-Cell ATAC-seq analysis via Latent feature Extraction (SCALE). SCALE combines a deep generative framework and a probabilistic Gaussian Mixture Model to learn latent features that accurately characterize scATAC-seq data. We validate SCALE on datasets generated on different platforms with different protocols, and having different overall data qualities. SCALE substantially outperforms the other tools in all aspects of scATAC-seq data analysis, including visualization, clustering, and denoising and imputation. Importantly, SCALE also generates interpretable features that directly link to cell populations, and can potentially reveal batch effects in scATAC-seq experiments.</p></abstract><abstract id="Abs2" abstract-type="web-summary"><p id="Par2">Single-cell ATAC-seq data is challenging to analyse for reasons such as high dimensionality and sparsity. Here, the authors develop SCALE, a deep learning method that leverages latent feature extraction for various tasks of scATACseq data analysis.</p></abstract><kwd-group kwd-group-type="npg-subject"><title>Subject terms</title><kwd>Functional clustering</kwd><kwd>Epigenomics</kwd><kwd>Chromatin</kwd><kwd>Chromatin structure</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100002855</institution-id><institution>Ministry of Science and Technology of the People's Republic of China (Chinese Ministry of Science and Technology)</institution></institution-wrap></funding-source><award-id>2018YFA0107603</award-id><principal-award-recipient><name><surname>Zhang</surname><given-names>Qiangfeng Cliff</given-names></name></principal-award-recipient></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100001809</institution-id><institution>National Natural Science Foundation of China (National Science Foundation of China)</institution></institution-wrap></funding-source><award-id>91740204</award-id><award-id>31761163007</award-id><award-id>31621063</award-id><principal-award-recipient><name><surname>Zhang</surname><given-names>Qiangfeng Cliff</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2019</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Introduction</title><p id="Par3">Accessible regions within chromatin often contain important genomic elements for transcription factor binding and gene regulation<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Assay for Transposase-Accessible Chromatin using sequencing (ATAC-seq) is an efficient method to probe genome-wide open chromatin sites, using the Tn5 transposase to tag them with sequencing adapters<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. In particular, single-cell ATAC-seq (scATAC-seq) reveals chromatin-accessibility variations at the single-cell level, and can be used to uncover the mechanisms regulating cell-to-cell heterogeneity<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR4">4</xref></sup>. However, in an scATAC-seq experiment, each open chromatin site of a diploid-genome single cell only has one or two opportunities to be captured. Normally, only a few thousand distinct reads (versus many thousands of possible open positions) are obtained per cell, thus resulting in many <italic>bona fide</italic> open chromatin sites of the cell that lack sequencing data signals (i.e., peaks). The analysis of scATAC-seq data hence suffers from the curse of &#x0201c;missingness&#x0201d; in addition to high dimensionality<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>.</p><p id="Par4">Many computational approaches have been designed to tackle high-dimensional and sparse genomic sequencing data, especially single-cell RNA-seq (scRNA-Seq) data. Dimensionality reduction techniques such as principal component analysis (PCA)<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> and <italic>t</italic>-distributed stochastic neighbor embedding (<italic>t</italic>-SNE)<sup><xref ref-type="bibr" rid="CR6">6</xref></sup> are frequently employed to map raw data into a lower dimensional space, which is particularly useful for visual inspecting the distribution of input data. Clustering based on the full expression spectrum or extracted features can be performed to identify specific cell types and states, as well as gene sets that share common biological functions<sup><xref ref-type="bibr" rid="CR7">7</xref>&#x02013;<xref ref-type="bibr" rid="CR10">10</xref></sup>. The imputation of missing expression values is also often carried out to mitigate the loss of information caused by dropouts in scRNA-seq data<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR12">12</xref></sup>.</p><p id="Par5">Direct applications of these scRNA-seq analysis methods to scATAC-seq data, however, may not be suitable due to the close-to-binary nature and increased sparsity of the data (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>). A recent method specifically developed for scATAC-seq data analysis, chromVAR<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, evaluates groups of peaks that share the same motifs or functional annotations together. Another method, scABC, weighs cells by sequencing depth and applies weighted <italic>K</italic>-medoid clustering to reduce the impact of missing values<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. To refine the clustering, it then calculates a landmark for each cluster and assigns cells to the closest landmarks based on the Spearman correlation. However, each method suffers notable caveats: chromVAR only analyzes peaks in groups and lacks the resolution of individual peaks, whereas scABC heavily depends on landmark samples with high sequencing depths, and the Spearman rank can be ill-defined for data with many missing values (in particular for scATAC-seq data). Recently a newly developed method called <italic>cis</italic>Topic applied latent Dirichlet allocation to model on scATAC-seq data to identify <italic>cis</italic>-regulatory topics and simultaneously cluster cells and accessible regions based on the cell-topic and region-topic distributions<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>.</p><p id="Par6">Expressive deep generative models have emerged as a powerful framework to model the distribution of high-dimensional data. One of the most popular of such methods, the variational autoencoder (VAE), estimates the data distribution and learns a latent distribution from the observed data through a recognition model (encoder) and a generative model (decoder)<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. It does this by maximizing the similarity of the calibrated data (output by the decoder) with the input data and minimizing the Kullback-Leibler divergence of the approximate from the true posteriors<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. VAE could be applied to data embedding and clustering based on the low-dimensional latent representation of the input high-dimensional data<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. Recently, a method called scVI adapted VAE for scRNA-seq data analysis<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. However, the standard VAE employed by scVI uses a single isotropic multivariable Gaussian distribution over the latent variables and often underfits sparse data<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. A tighter estimation of the posterior distribution could greatly improve the power of VAE in fitting and analyzing sparse data<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. Applying Gaussian Mixture Model (GMM) as the prior over the latent variables has been used in unsupervised clustering and to generate highly realistic samples by learning more disentangled and interpretable latent representations<sup><xref ref-type="bibr" rid="CR20">20</xref>&#x02013;<xref ref-type="bibr" rid="CR22">22</xref></sup>.</p><p id="Par7">Here, we introduce SCALE (Single-Cell ATAC-seq analysis via Latent feature Extraction), a method that combines the VAE framework with the Gaussian Mixture Model (GMM, a probabilistic model to estimate observed data with a mixture of Gaussian distributions). We validated the effectiveness of SCALE in extracting latent features that characterize the distributions of input scATAC-seq data on multiple different datasets generated on different platforms with different protocols, and of different overall data qualities. We then used the latent features to cluster cell mixtures into subpopulations, and to denoise and impute missing values in scATAC-seq data. We compared the performance of SCALE with other widely-used dimensionality reduction techniques, as well as with the state-of-art scRNA-seq and scATAC-seq analysis tools. We found that SCALE substantially outperforms the other tools in all aspects of scATAC-seq data analysis. It is even comparable to sophisticated experimental technologies with additional steps (e.g., Pi-ATAC<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>, which uses protein labeling as an aid in defining cell identifies) in correctly revealing cell types and their specific regulatory motifs in a tumor sample.</p></sec><sec id="Sec2" sec-type="results"><title>Results</title><sec id="Sec3"><title>The SCALE model and validation datasets</title><p id="Par8">SCALE combines the variational autoencoder (VAE) and the Gaussian Mixture Model (GMM) to model the distribution of high-dimensional sparse scATAC-seq data (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>). SCALE models the input scATAC-seq data <bold>x</bold> as a joint distribution <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left( {{\mathbf{x}},{\mathbf{z}},c} \right)$$\end{document}</tex-math><mml:math id="M2"><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12630_Article_IEq1.gif"/></alternatives></inline-formula> where <italic>c</italic> is one of predefined <italic>K</italic> clusters corresponding to a component of GMM, <bold>z</bold> is the latent variable obtained by <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{z}} = {\boldsymbol{\mu }}_z + {\boldsymbol{\sigma }}_z \ast {\boldsymbol{\epsilon}}$$\end{document}</tex-math><mml:math id="M4"><mml:mi mathvariant="bold">z</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:mi mathvariant="bold-italic">&#x003f5;</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12630_Article_IEq2.gif"/></alternatives></inline-formula>, where <italic>&#x003bc;</italic><sub><italic>z</italic></sub> and <italic>&#x003c3;</italic><sub><italic>z</italic></sub> are learned by the encoder network from <bold>x</bold>, and <italic>&#x003b5;</italic> is sampled from <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Bbb N}(0,{\mathbf{I}})$$\end{document}</tex-math><mml:math id="M6"><mml:mi mathvariant="double-struck">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12630_Article_IEq3.gif"/></alternatives></inline-formula><sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. Since <bold>z</bold> is conditioned on <italic>c</italic>, <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left( {{\mathbf{x}},{\mathbf{z}},c} \right)$$\end{document}</tex-math><mml:math id="M8"><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12630_Article_IEq4.gif"/></alternatives></inline-formula> can be written as <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left( {{\mathbf{x}}{\mathrm{|}}{\mathbf{z}}} \right)p\left( {{\mathbf{z}}{\mathrm{|}}c} \right)p(c)$$\end{document}</tex-math><mml:math id="M10"><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="normal">&#x02223;</mml:mi><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:mfenced><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mi mathvariant="normal">&#x02223;</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mfenced><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12630_Article_IEq5.gif"/></alternatives></inline-formula> where <italic>p</italic>(<italic>c</italic>) is a discrete distribution of <italic>K</italic> predefined clusters, <italic>p</italic>(<bold>z</bold>|<italic>c</italic>) follows a mixture of Gaussians distribution with a mean <italic>&#x003bc;</italic><sub><italic>c</italic></sub> and a variance <italic>&#x003c3;</italic><sub><italic>c</italic></sub> for each component corresponding to a cluster <italic>c</italic>, and <italic>p</italic>(<bold>x</bold>|<bold>z</bold>) is a multivariable Bernoulli distribution modeled by the decoder network (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>). In the SCALE framework, each cell <italic>x</italic><sup><italic>i</italic></sup> is first transformed into a <italic>d</italic>-dimensional vector of latent features <italic>z</italic><sup><italic>i</italic></sup> on the GMM manifold by an encoder network and then reconstructed back through a decoder network with the original dimensionality to represent the chromatin openness at each peak in each cell. The latent features that capture the characteristics of scATAC-seq data are then visualized in the low-dimensional space with <italic>t</italic>-SNE, and used to cluster single cells with various clustering methods, e.g., <italic>K</italic>-means.<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of the SCALE framework. SCALE consists of an encoder and a decoder in the VAE framework. The encoder is a four-layer neural network (3200&#x02013;1600&#x02013;800&#x02013;400) and the decoder is a network of only one layer with 10-dimensional latent variables (features) directly connected to the output. The latent variables are on the GMM manifold parameterized by <italic>&#x003bc;</italic><sub><italic>c</italic></sub> and <italic>&#x003c3;</italic><sub><italic>c</italic></sub></p></caption><graphic xlink:href="41467_2019_12630_Fig1_HTML" id="d29e769"/></fig></p><p id="Par9">We constrained the hyper-parameters of SCALE on the Leukemia scATAC-seq dataset and found SCALE is insensitive to the encoder structure and the dimension of latent features (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>). The SCALE model with default parameters can be accessed in the Online Method. We then tested the model by using the GM12878/HEK293T, the GM12878/HL-60, and the InSilico datasets<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR24">24</xref></sup>, and two other recently published Splenocyte and Forebrain datasets<sup><xref ref-type="bibr" rid="CR25">25</xref>,<xref ref-type="bibr" rid="CR26">26</xref></sup>. The Leukemia dataset is derived from a mixture of monocytes (Mono) and lymphoid-primed multipotent progenitors (LMPP) isolated from a healthy human donor, and leukemia stem cells (SU070_LSC, SU353_LSC) and blast cells (SU070_Leuk, SU353_Blast) isolated from two patients with acute myeloid leukemia<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. The GM12878/HEK293T dataset and the GM12878/HL-60 dataset are respective mixtures of two commonly-used cell lines<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. The InSilico dataset is an in silico mixture constructed by computationally combining six individual scATAC-seq experiments that were separately performed on a different cell line<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR11">11</xref></sup>. Note that these four datasets were the same ones used to validate scABC<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. The more recent Splenocyte dataset<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> is derived from a mixture of mouse splenocytes (after red blood cell removal) and the Forebrain dataset<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> is derived from P56 mouse forebrain cells. The six datasets cover scATAC-seq data generated from both microfluidics-based and cellular indexing platforms, and the distributions of the number of peaks in each single cell vary substantially in different datasets (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>). However, they always have a high level of data sparsity compared to the aggregation of peaks from all single cells in each dataset (Supplementary Table.&#x000a0;<xref rid="MOESM1" ref-type="media">2</xref>).</p></sec><sec id="Sec4"><title>SCALE identifies cell types by clustering on latent features</title><p id="Par10">We examined SCALE&#x02019;s ability to uncover features that characterize scATAC-seq data distributions. By default, SCALE extracts 10 features from the input data. For comparison, we also applied PCA, scVI and <italic>cis</italic>Topic to reduce the input data to 10 dimensions. In the comparison, we also included Cicero<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, a scATAC-seq data analysis tool for predicting <italic>cis</italic>-regulatory interactions and building single-cell trajectories from scATAC-seq data, and TF-IDF a transformation for performing dimension reduction and clustering<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. We then visualized the extracted features from these tools as well as the raw data with <italic>t</italic>-SNE. In general, the feature embeddings of SCALE and <italic>cis</italic>Topic were better separated between cell types, whereas the embeddings of PCA, scVI, Cicero, TF-IDF and the raw data overlapped between some cell types (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2a</xref>, Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">2</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><p>Feature embedding and clustering. <bold>a</bold>
<italic>t</italic>-SNE visualization of the raw data and the extracted features from PCA, scVI, <italic>cis</italic>Topic, and SCALE of the Forebrain dataset. For comparison, SCALE, PCA, and scVI all performed dimension reduction to ten dimensions before applying <italic>t</italic>-SNE while the raw data were directly visualized with <italic>t</italic>-SNE. <bold>b</bold> Clustering accuracy was evaluated by confusion matrices between cluster assignments predicted by scABC, SC3, scVI, <italic>cis</italic>Topic and SCALE, and reference cell types. For scABC and SC3, the cluster assignments were directly obtained from the output of the tools; for SCALE and scVI, we applied the <italic>K</italic>-means clustering on the extracted features to get cluster assignments. The Adjusted Rand Index (ARI), the Normalized Mutual Information (NMI), and the F1 scores are shown on the top</p></caption><graphic xlink:href="41467_2019_12630_Fig2_HTML" id="d29e891"/></fig></p><p id="Par11">SCALE can also reveal the distance between different cell subpopulations and sometimes suggested their developmental trajectory in UMAP visualization<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">3</xref>). For example, in the Forebrain dataset the three clusters of excitatory neuron cells (EX1, EX2, and EX3) are close to each other in the latent space. For the Splenocyte dataset, the different T-cell subpopulations are in the neighborhood, the B cells form another bigger group, and the two types of natural killer cells also cluster closely. For the Leukemia dataset, Mono and LMPP cells are the most dissimilar in leukemia evolution and they were indeed the farthest separated. LSCs exhibit strong similarity to LMPPs<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, consistent with that the LSC cells (LSC_SU070, LSC_SU353) were close to the LMPP cells in the embedding. Finally, the blast cells (Blast_SU070 and Blast_SU353) showed a bimodal distribution, with some more differentiated blasts closer to monocytes<sup><xref ref-type="bibr" rid="CR31">31</xref>,<xref ref-type="bibr" rid="CR32">32</xref></sup>.</p><p id="Par12">We then applied <italic>K</italic>-means clustering on the SCALE-extracted latent features and assessed the clustering accuracy by comparing the results with scABC, scVI, <italic>cis</italic>Topic, and SC3<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>, another widely-used clustering method for scRNA-seq data. SCALE displayed the overall best performance on all five real experimental mixture datasets, and was nearly as accurate as scABC and <italic>cis</italic>Topic on the InSilico dataset (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2b</xref>, Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">4</xref>). The newly developed <italic>cis</italic>Topic generally performed pretty well on all datasets, with the overall clustering performance only slightly lower than SCALE, but it misclassified a few clusters on the Splenocyte dataset. We also compared with TF-IDF and Cicero on clustering. TF-IDF performed well on most datasets (although not as good as SCALE) except on the Forebrain dataset. However, Cicero did not perform well on most datasets; indeed, data visualization and clustering are not major goals of Cicero. On the Forebrain dataset, cluster assignments of SCALE were the closest to the reference cell types. Due to the sparsity of data, the Pearson and Spearman correlations were both ill-defined (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">5a</xref>), which directly led to poor clustering for SC3 where most cells collapsed into one group. Although the VAE-based method scVI did not suffer from the problem of ill-defined cell distance, it misclassified three subgroups of cells (<italic>s1, s2, s3</italic> labeled on the confusion matrix. Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">5b</xref>).</p><p id="Par13">To identify the cause of the misclustering by scVI, we searched for the most similar cell types for the three subgroups (<italic>s1</italic>, <italic>s2</italic>, <italic>s3</italic>). We aggregated the peak profiles of each cell type or subgroup to form a representing meta-cell and calculated the similarities among the meta-cells. As expected, <italic>s1</italic> is the most similar to EX2, <italic>s2</italic> the most similar to EX3, and <italic>s3</italic> to AC (astrocyte) in the original data (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">5c</xref>). Both scVI and SCALE model the distribution of scATAC peak profiles to remove noise and to impute missing values (discussed in detail in the next section). We found that, consistent with the clustering results, this data calibration by scVI actually made <italic>s1</italic>, <italic>s2</italic>, and <italic>s3</italic> cells less similar to the original cell types of EX2, EX3, and AC, respectively. On the contrary, SCALE retained the similarities of the three subgroups to their original cell types. Strikingly, when removing the GMM restriction from the overall framework but keeping the other part of the network the same, the degenerated SCALE yield performance was similar to that of a regular VAE, like scVI (Supplementary Fig&#x000a0;<xref rid="MOESM1" ref-type="media">5d</xref>). Thus, introducing GMM as the prior to restrict the data structure provides SCALE with greater power for fitting sparse data than regular VAE using single Gaussian as the prior.</p><p id="Par14">Finally, we tested whether SCALE is robust with respect to data sparsity by randomly dropping scATAC-seq values in the raw datasets down to zero. We compared the clustering accuracy of SCALE and other tools at different dropping rates (10&#x02013;90%), measured by the adjusted Rand Index (ARI), Normalized Mutual Information (NMI) and micro F1 score (Methods). We found that SCALE displayed only a moderate decrease in clustering accuracy with increased data corruption until at about the corruption level of 0.6, and was robust for all datasets (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">6</xref>). In general, scABC, SC3, and scVI also showed robustness to data corruption; however, the overall clustering accuracies were much lower on some datasets (e.g., SC3 failed on the Forebrain dataset and scVI failed on the GM12878/HEK293T and the GM12878/HL-60 datasets). On the Forebrain dataset, the ARI scores of SCALE dropped from 0.668 using the raw data to 0.448 on using the data with 30% corruption, and scABC and scVI dropped from 0.315 to 0.222 and from 0.448 to 0.388, respectively.</p><p id="Par15">Finally we also provide a method to help users choose the optimal number of clusters based on the Tracy-Widom distribution<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> (Methods), which could often produce an estimate of the number of clusters close to that of the references (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">7</xref>) and generate clustering results similar to the reference sets (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">7</xref>).</p></sec><sec id="Sec5"><title>SCALE reduces noise and recovers missing peaks</title><p id="Par16">An important feature of SCALE is the ability to accurately estimate the real distribution of scATAC-seq data, which usually contains both noise and a large number of missing values. The estimate could be used to remove noise and restore missing data (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>). We evaluated the calibration efficiency of SCALE on both real and simulated datasets. Since no such tool is currently available for scATAC-seq data, we compared SCALE with scImpute, SAVER, MAGIC, and scVI, four state-of-the-art scRNA-seq imputation methods (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3a</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><p>Data denoising and imputation efficiency on simulation and real datasets. <bold>a</bold> Comparison of the cell-wise correlations of the raw data and the calibrated data with the meta-cell of each cell type on the Forebrain dataset. <bold>b</bold>
<italic>t</italic>-SNE embedding of 105 significant motifs profile identified by chromVAR (Benjamini-Hochberg corrected Chi-square test <italic>p_value_adj</italic> of variability &#x0003c;0.05), and embeddings of motifs Mafb, Hoxd9, Dlx2, Lhx8, Arx, and Neurog1 colored by deviation scores</p></caption><graphic xlink:href="41467_2019_12630_Fig3_HTML" id="d29e1030"/></fig></p><p id="Par17">We first evaluated the ability of SCALE to remove noise and to recover missing values on real scATAC-seq datasets. A challenge of analyzing real data is that the ground truth data without any corruption is unknown. However, if we average all single cells of the same biological cell type, the resulted meta-cell will be a good approximate to those single cells. SCALE performed better than all scRNA-seq imputation methods in all scATAC-seq datasets, in that it achieved the highest correlation of the single cells with the corresponding meta-cell for each cell type (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3a</xref>, Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">8</xref>), indicating that it obtained a better estimate of the real scATAC-seq data distribution. For most cases, scImpute was very stable and among the best comparing with other scRNA-seq imputation methods, and SAVER performed well on denser datasets (InSilico, Splenocyte) but deteriorated on sparser datasets. MAGIC and scVI might have underfit the sparse input data and the imputed data substantially deviated from it (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">9</xref>), which may reflect that the two powerful tools that are optimized to scRNA-seq data imputation may not fit for scATAC-seq data analysis.</p><p id="Par18">It is important to note that the data calibration of SCALE was obtained at the same time of data modeling and clustering, i.e., without knowing the original type of each cell. So it could not simply average all single cells of the same cell type to reconstruct the peak so that they resemble the reference meta-cell. Also importantly, SCALE achieved a high correlation with the meta-cells while maintaining a similar level of variation within each cell population (see the variation of correlation coefficients in Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3a</xref> and Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">8</xref>). Indeed, SCALE retained the original data structure (intra-correlation within the imputed data) and recovered the original peak profiles (inter-correlation with the raw data) in the process of data regularization by GMM (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">9</xref>).</p><p id="Par19">The imputation of SCALE could strengthen the distinct patterns of cluster-specific peaks by filling missing values and removing potential noise (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">10</xref>), which improves downstream analysis, for example the identification of cell-type-specific motifs and transcription factors by chromVAR. We demonstrated this feature with the Forebrain dataset. We first followed the method used by Cusanovich et. al. to identify differentially accessible sites with the &#x0201c;binomialff&#x0201d; test of Monocle 2 package<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. At 1% FDR threshold, we identified 4100 differential accessible sites across the eight reference clusters of the Forebrain dataset. We then used chromVAR to search for motifs enriched in the differential sites in the raw and the imputed data, respectively. Overall, the patterns of different cell types are more distinct for these differentially accessible sites in the imputed than in the raw data (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">11a</xref>). And embedding on the imputed data shows better-defined clusters (each well corresponds to a subtype with biological definition) than on the raw data (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3b</xref>, Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">11b</xref>).</p><p id="Par20">We found that the imputed data can greatly improve the results of chromVAR analysis by identifying more motifs (increased from 52 motifs to 105). For example, chromVAR analysis on the imputed data, but not on the raw data, identified the motifs Mafb and Hoxd9 enriched in the MG (macroglia) cluster (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">11c&#x02013;d</xref>). It was recently reported that Mafb contributes to the activation of microglia<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. It also identified Hoxd9 enriched in IN (inhibitory neuron) from the imputed but not the raw data. Similarly, we found that Dlx2, Lhx8, Arx, and Neurog1 are much more significantly enriched in the, respectively, clusters in the imputed data (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">11c-d</xref>). Dlx2, Lhx8, and Arx are important components in the MGE (medial ganglionic eminence) pathway of forebrain development<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>, and Neurog1 is required for excitatory neurons in the cerebral cortex<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>.</p><p id="Par21">We then introduced further corruption to the real data by randomly dropping out peaks at different rates (Methods). At all corruption rates, SCALE performed the best, in that the calibrated data most closely correlated with the original meta-cells (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">12</xref>). We observed similar trends for the other scRNA-seq imputation tools as above, confirming the effectiveness of SCALE in enhancing scATAC-seq data. We further tested the impact of missingness on generative model of imputation by calculating the confusion score (Methods) to evaluate the ability to preserve the original structure (inter and intra-correlation of meta-cells) (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">13</xref>). We found that the effect was minimal when the corruption level was lower than about 0.5, and after that threshold, the generative model was less capable of preserving the original structure (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">13b</xref>).</p><p id="Par22">We subsequently tested the calibration accuracy on a simulated dataset. We constructed the dataset by first generating reference scATAC-seq data consisting of three clusters, each containing 100 peaks with no missing values, then randomly dropping out peaks and introducing noise (Methods, Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">14a</xref>). As we knew the ground truth data of each single cell, we could quantify the efficiency of all tools by calculating peak-wise and cell-wise correlations of each calibrated single cell with its original ground truth. At all corruption rates, SCALE recovered the original data most accurately (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">14b&#x02013;c</xref>). On the other hand, although scImpute could also recover the missing values in most cases, it messed up two clusters at the 0.2 corruption rate and was unable to remove the noise. SAVER and scVI smoothed both the signal and noise simultaneously and only recovered missing values to some degree. MAGIC performed very well at low corruption rates, but apparently over-smoothed the data and removed true signals along with noise at high levels of data corruption.</p></sec><sec id="Sec6"><title>SCALE reveals cell types and their specific motifs</title><p id="Par23">Next, we used SCALE to analyze a dataset generated by a recently developed technology, protein-indexed single-cell assay of transposase-accessible chromatin-seq (Pi-ATAC), which uses protein labeling to help define cell identities<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. Dissecting complex cell mixtures of in vivo biological samples may be challenging. By simultaneously characterizing protein markers and epigenetic landscapes in the same individual cells, Pi-ATAC provides an effective approach to tackle the problem. The Breast Tumor dataset is derived from a mouse breast tumor sample, including two plates of tumor cells (Epcam+) and another two plates of tumor-infiltrating immune cells (CD45+), isolated by protein labeling and FACS sorting. In the original study, a set of motifs was used to project the Epcam+ and CD45+ -specific chromatin features with <italic>t</italic>-SNE, and it was difficult to separate these two cell types computationally (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">15a</xref>). However, we found that SCALE was able to separate the two cell types well, better than PCA and scVI in latent embedding (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4a</xref>). On clustering, SCALE also yielded results the closest to the protein-index labels, better than scVI and scABC, whereas SC3 poorly distinguished the two cell types (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4b</xref>). Although <italic>cis</italic>Topic grouped the cells well in the embedding, it misclassified parts of CD45+ cells into Epcam+ cells. SCALE thus can reveal cell types within complex tissues based only on scATAC-seq data, with performance comparable to sophisticated experimental technologies like Pi-ATAC.<fig id="Fig4"><label>Fig. 4</label><caption><p>Application of SCALE on the Breast Tumor dataset from the Pi-ATAC study. <bold>a</bold>
<italic>t</italic>-SNE visualization of the Breast Tumor raw data, and features extracted by PCA, scVI, and SCALE. <bold>b</bold> clustering results by scABC, SC3, scVI, <italic>cis</italic>Topic, and SCALE. <bold>c</bold> Heatmaps of enriched motifs of different transcription factors across CD45+ cells and Epcam+ cells from the mouse breast tumor sample</p></caption><graphic xlink:href="41467_2019_12630_Fig4_HTML" id="d29e1158"/></fig></p><p id="Par24">We validated the biological significance of the cell clusters based on Pi-ATAC peaks. For each cluster, we calculated the top 1000 peaks with the highest specificity score as type-specific peaks (Methods, Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">15b</xref>). We then used Homer<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> to identify transcription factor binding motifs that were enriched in the type-specific peaks. We removed the common motifs enriched in both CD45+ cells and Epcam+ cells, and kept those that were enriched in only one cell type. We found that CD45+ cells were enriched for immune-specific motifs Maz, Pu.1-Irf, Irf8, Runx1, Elk4, Nfy, Elf3, and SpiB binding motifs. These findings are consistent with the role of Runx1 in maintenance of haematopoietic stem cells (HSC) and that knockout of Runx1 results in defective T- and B-lymphocyte development<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>. Nfy promotes the expression of the crucial immune responsive gene Major Histocompatibility Complex (MHC)<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>. Epcam+ cells were enriched for tumor-related motifs Klf14, Mitf, Ets1, Nrf2, and Nrf1 binding motifs. Ets1 is frequently overexpressed in breast cancer and associated with invasiveness<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>, whereas Nrf2 is a key signature for breast cancer cell proliferation and metastasis<sup><xref ref-type="bibr" rid="CR42">42</xref></sup> (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4c</xref>). Thus, SCALE analysis of the Breast Tumor data revealed biologically relevant <italic>cis</italic>-elements for gene regulation.</p></sec><sec id="Sec7"><title>SCALE disentangles biological cell types and batch effects</title><p id="Par25">In addition to tighter estimates of the multimodal input data, by pushing each dimension to learn a separate Gaussian distribution, GMM has another advantage in that it leads to latent representations that are more structured and disentangled, and thus more interpretable<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. In SCALE, as each feature is directly connected with output peaks, it can be assessed by the most weighted connections (Methods, Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">16a</xref>). For example, in the Leukemia dataset, dimensions 9 of the extracted features captured peaks specific to the Mono cell type and enriched regulatory elements related to immune-related &#x0201c;biological process&#x0201d; (BP, Methods) (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">16b</xref>). In the Forebrain dataset, feature 3 characterized the AC (astrocyte) and the OC (oligodendrocyte) cell types, enriched elements related to &#x0201c;glial cell differentiation&#x0201d; (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">16c</xref>). In the Splenocyte dataset, features 4 and 7 portrayed two complementary sets of cell types (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">16d</xref>), with feature 4 enriched with B cell-related processes like &#x0201c;regulation of cell morphogenesis&#x0201d; and &#x0201c;myeloid leukocyte activation and differentiation&#x0201d;, and feature 7 enriched with T cell-related processes such as &#x0201c;immune response&#x0201d; and &#x0201c;regulation of cell killing&#x0201d; (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">16d</xref>). These data suggest that the features learned by the model of SCALE are disentangled and can shed light on the biological significance.</p><p id="Par26">Most interestingly, we found that SCALE could possibly reveal features corresponding to potential batch effects in the input data. For example, the Breast Tumor dataset is derived from experiments performed separately on two plates of Epcam+ tumor cell samples and two plates of CD45+ tumor-infiltrating immune cells. Although SCALE successfully clustered the two cell types, the data structure in the low-dimensional space also revealed bias towards different plates (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5a</xref>). We carefully analyzed the SCALE-extracted features (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5b</xref>) and noticed that while some, e.g., features 1 and 6, were well-correlated to biological cell types, the others, e.g., features 2, 4, 8, and 10, more or less corresponded to independent plates, or, e.g., features 3 and 5, displayed biased distribution not related to cell types. Using the plate-related features (i.e., features 2, 3, 4, 5, 8, and 10) for data embedding, we found that the cells were separated by plates, but not by types. On the other hand, if we used the other plate-independent features (i.e., features 1, 6, 7, and 9), we found that indeed the cells of different plates of the same types more evenly distributed in the cluster (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5a</xref>). We further checked the represented peaks of these features and its biological significance (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">16e</xref>). Most of plate-related features have no biological relevance, except for peaks of feature 8, which appeared in one plate of CD45+ cells and are enriched with biological processes such as &#x0201c;response to cytokine stimulus&#x0201d;. This finding, however, suggests another possibility in interpreting the &#x0201c;plate bias&#x0201d; as a real biological difference in the two separate plates of CD45+ cells that might arise from sorting and cell culture.<fig id="Fig5"><label>Fig. 5</label><caption><p>Batch effects and biological cell types are captured by disentangled latent features. <bold>a</bold>
<italic>t</italic>-SNE visualization of full features, plate-related features (features 2, 3, 4, 5, 8, 10), and plate-independent features (features 1, 6, 7, 9). <bold>b</bold> Heatmap of the ten features learned by SCALE. Different batches (plates) are colored by different colors on the top, plate 1 and 2 are Epcam+ cells, plate 3 and 4 are CD45+ cells</p></caption><graphic xlink:href="41467_2019_12630_Fig5_HTML" id="d29e1247"/></fig></p><p id="Par27">We noticed that GM12878 cells in the InSilico dataset contain four replicates with many peak values much greater than 2. PCA analysis showed that replicates 1 and 3 were separated in the low-dimensional space (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">17a</xref>), suggesting a possible batch effect. However, the differences in the two replicates disappeared after we binarized the data, by masking values greater than 1 to 1 (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">17b</xref>). On the other hand, we observed no particular features corresponding to any batch among the SCALE-extracted features (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">17c</xref>). Consequently, in the embedding and clustering results based on the SCALE-extracted features, the cells of each replicate were distributed evenly in the low-dimensional space (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">17c</xref>). We confirmed this result by checking the top 200 specific peaks for each replicate based on raw data and found no significantly different pattern across replicates (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">17d</xref>). The distinction may reflect the different characters of the two approaches: while PCA is a linear method and sensitive to quantitative variations, SCALE is non-linear and more stable. Lastly, we repeated the analysis on the Splenocyte and the Forebrain datasets&#x02014;the other two datasets that contain different experimental batches, and found no batch-related features, and the cells of different batches were distributed indistinguishably in the low-dimensional space (Supplementary Figs.&#x000a0;<xref rid="MOESM1" ref-type="media">18</xref>, <xref rid="MOESM1" ref-type="media">19</xref>).</p></sec><sec id="Sec8"><title>SCALE is scalable to large datasets</title><p id="Par28">We further examined a mouse single-cell atlas of profiled chromatin accessibility in ~80,000 single cells from 13 adult mouse tissues by sci-ATAC-seq<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> to investigate whether SCALE works for large datasets. The atlas study used a computational pipeline to infer 30 cell types from the dataset by graphic clustering, which were used as &#x0201c;reference&#x0201d; cell types when benchmarking SCALE. SCALE worked well on this big dataset and showed a good agreement with the reference: the overall F1 score was 0.419, and most of the major reference clusters have a corresponding one identified by SCALE. Nevertheless, some large reference clusters were split into two or three small groups (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">20</xref>).</p><p id="Par29">Finally, we benchmarked the running time and memory usage of SCALE on different scales of datasets by downsampling a subset of cells and peaks from the mouse atlas datasets (10,000 peaks and different cell number). We found that SCALE required a little over 1.5&#x02009;h and 2 GB of memory to run a dataset, and importantly the used computational resource only increased slightly with the size of datasets (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">21</xref>).</p></sec></sec><sec id="Sec9" sec-type="discussion"><title>Discussion</title><p id="Par30">Our work shows that SCALE accurately characterizes the distribution of high-dimensional and sparse scATAC-seq data by using a deep generative framework to extract latent features. SCALE is thus a powerful tool for scATAC-seq data analysis, including data visualization, clustering, and denoising and imputation. In all comparisons, SCALE performs much more favorably than scABC and scRNA-seq tools. Based on the better clustering assignments and imputation data, we can improve the discovery of cluster-specific peaks, and regulatory motifs as well, when combined with tools like Homer<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> or chromVAR<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>.</p><p id="Par31">The success of SCALE can be attributed to the powerful deep generative framework and the GMM to accurately model the high-dimensional, sparse, multimodal scATAC-seq data. Similar to SCALE, a recent scRNA-seq analysis tool scVI also learns latent representation of scRNA-seq data by aggregating information across similar cells using a hierarchical Bayesian model<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. However, SCALE also applies a GMM to overcome the increased sparsity of scATAC-seq data and more tightly estimate data distribution, thus achieving higher accuracy than scVI on scATAC-seq data analysis. It highlights the necessity and advantage to develop new methods that are optimized for scATAC-seq data, but not to use scRNA-seq data analysis tools.</p><p id="Par32">An attractive additional observation about SCALE is the interpretability of the GMM model. We showed that SCALE could possibly capture biological cell-type-related and potential batch-effect-related latent features in the low-dimensional space. By excluding batch-related features in embedding and clustering, we are able to reduce batch effects. Nevertheless, SCALE is not specifically designed to identify and remove these artifacts from the input data. In the future, we could improve the model to explicitly incorporate variables that are designated for the discovery and removal of batch effects and other possible technical variations.</p></sec><sec id="Sec10"><title>Methods</title><sec id="Sec11"><title>Data and preprocessing</title><p id="Par33"><italic>Data</italic>: The Leukemia dataset is derived from a mixture of monocytes (Mono) and lymphoid-primed multipotent progenitors (LMPP) isolated from a healthy human donor, and leukemia stem cells (SU070_LSC, SU353_LSC) and blast cells (SU070_Leuk, SU353_Blast) isolated from two patients with acute myeloid leukemia<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. The GM12878/HEK293T dataset and the GM12878/HL-60 dataset are respective mixtures of two commonly-used cell lines<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. The InSilico dataset is an in silico mixture constructed by computationally putting together six individual scATAC-seq experiments separately performed on a different cell line<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR11">11</xref></sup>. The Splenocyte dataset<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> is derived from a mixture of mouse splenocytes (after red blood cells removal) and the Forebrain dataset<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> is derived from P56 mouse forebrain cells. The Breast Tumor dataset<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> is obtained from a mouse breast tumor sample, including two plates of tumor cells (Epcam+) and another two plates of tumor-infiltrating immune cells (CD45+) from protein labeling and FACS sorting.</p><p id="Par34"><italic>Preprocessing</italic>: Similar to scABC<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, we filtered the scATAC-seq count matrix to only keep peaks in10 cells with &#x02265;2 reads for the InSilico dataset, the GM12878/HEK293T dataset, and the GM12878/HL-60 dataset, &#x02265;5 cells with &#x02265;2 reads for the Leukemia dataset, &#x02265;50 cells with &#x02265;2 reads for the Forebrain dataset, and &#x02265;5 cells with &#x02265;1 reads for the Breast Tumor dataset. We kept all the peaks for the Splenocyte dataset. We also only kept cells with read counts &#x02265;(number of filtered peaks/50). For the InSilico dataset, there were still almost 90,000 peaks after filtering. For the efficiency of the SCALE model, similar to SC3<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>, we further removed rare peaks (reads &#x0003e;2 in less than X% of cells) and ubiquitous peaks (reads &#x02265;1 in at least (100&#x02013;X)% of cells).</p></sec><sec id="Sec12"><title>The probabilistic model of SCALE</title><p id="Par35">SCALE combines a variational autoencoder (VAE) and the Gaussian Mixture Model (GMM) to model the input scATAC-seq data <bold>x</bold> through a generative process. Given K clusters, corresponding latent variable <bold>z</bold> can be obtained through the encoder via the reparameterization then to generate sample <bold>x</bold> through the decoder. It can be modeled with a joint distribution <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left( {{\mathbf{x}},{\mathbf{z}},c} \right)$$\end{document}</tex-math><mml:math id="M12"><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12630_Article_IEq6.gif"/></alternatives></inline-formula>, where <bold>z</bold> is the latent variable and <italic>c</italic> is a categorical variable whose probability is Discrete (c|<italic>&#x003c0;</italic>) where <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{P}}\left( {{\mathrm{C}} = {\mathrm{j}}} \right) = \pi _j,\pi \in {\Bbb R}^K$$\end{document}</tex-math><mml:math id="M14"><mml:mi mathvariant="normal">P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x003c0;</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_12630_Article_IEq7.gif"/></alternatives></inline-formula>. <italic>p</italic>(<bold>z</bold>|<italic>c</italic>) is mixture of Gaussians distribution parameterized by <italic>&#x003bc;</italic><sub><italic>c</italic></sub> and <italic>&#x003c3;</italic><sub><italic>c</italic></sub> conditioned on <italic>c</italic>. Given that <bold>x</bold> and <italic>c</italic> are independently conditioned on <bold>z</bold>, then joint probability <italic>p</italic>(<bold>x</bold>, <bold>z</bold>, <italic>c</italic>) can be factorized as:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left( {{\mathbf{x}},{\mathbf{z}},c} \right) = p\left( {{\mathbf{x}}{\mathrm{|}}{\mathbf{z}}} \right)p\left( {{\mathbf{z}}{\mathrm{|}}c} \right)p(c)$$\end{document}</tex-math><mml:math id="M16"><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="normal">&#x02223;</mml:mi><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:mfenced><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mi mathvariant="normal">&#x02223;</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mfenced><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2019_12630_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par36">We define each factorized probability as:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left( c \right) = {\mathrm{Discrete}}\left( {c{\mathrm{|\pi }}} \right)$$\end{document}</tex-math><mml:math id="M18"><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Discrete</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>c</mml:mi><mml:mi mathvariant="normal">&#x02223;&#x003c0;</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2019_12630_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left( {{\mathbf{z}}{\mathrm{|}}c} \right) = {\Bbb N}({\mathbf{z}}|\mu _c,{\boldsymbol{\sigma }}_c^2{\mathbf{I}})$$\end{document}</tex-math><mml:math id="M20"><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mi mathvariant="normal">&#x02223;</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mo>&#x02223;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2019_12630_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left( {{\mathbf{x}}{\mathrm{|}}{\mathbf{z}}} \right) = {\mathrm{Ber}}({\mathbf{x}}|{\it{\mu }}_x)$$\end{document}</tex-math><mml:math id="M22"><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="normal">&#x02223;</mml:mi><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Ber</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>&#x02223;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2019_12630_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par37">The training SCALE is to maximize the log-likelihood of the observed scATAC-seq data:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{log}}p\left( {\mathbf{x}} \right) = {\mathrm{log}}{\int}_z {\mathop {\sum}\nolimits_c {p\left( {x,z,c} \right)dz} }$$\end{document}</tex-math><mml:math id="M24"><mml:mi mathvariant="normal">log</mml:mi><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:msub><mml:mrow><mml:mo>&#x0222b;</mml:mo></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mfenced><mml:mi>d</mml:mi><mml:mi>z</mml:mi></mml:math><graphic xlink:href="41467_2019_12630_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge E_{q({\mathbf{z}},c|{\mathbf{x}})}\left[ {\log \frac{{p\left( {{\mathbf{x}},{\mathbf{z}},c} \right)}}{{q({\mathbf{z}},c|{\mathbf{x}})}}} \right] = {\cal{L}}_{{\mathrm{ELBO}}}({\mathbf{x}})$$\end{document}</tex-math><mml:math id="M26"><mml:mo>&#x02265;</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ELBO</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2019_12630_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>which can be transformed to maximize the evidence lower bound (ELBO). The ELBO can be written with a reconstruction term and a regularization term:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal{L}}_{{\mathrm{ELBO}}}\left( {\mathbf{x}} \right) = E_{q\left( {{\mathbf{z}},c{\mathrm{|}}{\mathbf{x}}} \right)}\left[ {{\mathrm{log}}p({\mathbf{x}}|{\mathbf{z}})} \right] - D_{KL}\left( {q({\mathbf{z}},c|{\mathbf{x}})||p\left( {{\mathbf{z}},c} \right)} \right)$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ELBO</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi mathvariant="normal">&#x02223;</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02223;</mml:mo><mml:mo>&#x02223;</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2019_12630_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par38">The reconstruction term encourages the imputed data to be similar to the input data. The regularization term is a Kullback-Leibeler divergence, which regularizes the latent variable <bold>z</bold> to a GMM manifold. And <italic>q</italic>(<bold>z</bold>, <italic>c</italic>|<bold>x</bold>) and <italic>p</italic>(<bold>x</bold>|<bold>z</bold>) are an encoder and a decoder, respectively, which can be modeled by two neural networks.</p></sec><sec id="Sec13"><title>The overall network architecture of SCALE</title><p id="Par39">SCALE consists of an encoder and a decoder. The encoder is a four-layer neural network (3200&#x02013;1600&#x02013;800&#x02013;400) with the ReLU activation function. The decoder has no hidden layer but directly connects the ten latent variables (features) to the output layer (peaks) with the Sigmoid activation function. A GMM model is used to initialize the parameters <italic>&#x003bc;</italic><sub><italic>c</italic></sub> and <italic>&#x003c3;</italic><sub><italic>c</italic></sub>. The Adam optimizer<sup><xref ref-type="bibr" rid="CR43">43</xref></sup> with a 5e-4 weight decay is used to maximize the ELBO. Mini-batch size is 32. SCALE also provides a quick mode for large datasets with the encoder structure of two layers (1024&#x02013;128), and model training with maximum iterations of 30,000 and early stopping when no improvements in 10 epochs. The GMM models are constructed with the Python &#x0201c;scikit-learn&#x0201d; package, and the neural network is implemented with the &#x0201c;pytorch&#x0201d; package.</p></sec><sec id="Sec14"><title>Visualization</title><p id="Par40">We used <italic>t</italic>-SNE from the Python &#x0201c;scikit-learn&#x0201d; package to project the raw data or latent features to 2-dimension with random state as 124. We used Python package &#x0201c;umap&#x0201d; to visualize the trajectory cell relationships.</p></sec><sec id="Sec15"><title>Clustering</title><p id="Par41">We used the <italic>K</italic>-means clustering method from the Python &#x0201c;scikit-learn&#x0201d; package to cluster the input single cells based on the extracted features. To repeat the result, we set the random seed to 18.</p></sec><sec id="Sec16"><title>Evaluation of clustering results</title><p id="Par42"><italic>Adjusted Rand Index</italic>: The Rand Index (RI) computes similarity score between two clustering assignments by considering matched and unmatched assignments pairs independently of the number of clusters. The Adjusted Rand Index (ARI) score is calculated by &#x0201c;adjust for chance&#x0201d; with RI by:<disp-formula id="Equa"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{ARI}} = \frac{{RI - {\mathrm{Expected}}\_RI}}{{\max \left( {RI} \right) - {\mathrm{Expected}}\_RI}}$$\end{document}</tex-math><mml:math id="M30"><mml:mi mathvariant="normal">ARI</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mi>I</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi mathvariant="normal">Expected</mml:mi><mml:mstyle><mml:mtext>_</mml:mtext></mml:mstyle><mml:mi>R</mml:mi><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>max</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>R</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:mi mathvariant="normal">Expected</mml:mi><mml:mstyle><mml:mtext>_</mml:mtext></mml:mstyle><mml:mi>R</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2019_12630_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par43">If given the contingency table, the ARI can also be represented by:<disp-formula id="Equb"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{ARI}} = \frac{{\mathop {\sum }\nolimits_{ij} \left( {\begin{array}{*{20}{c}} {n_{ij}} \\ 2 \end{array}} \right) - \left[ {\mathop {\sum }\nolimits_i \left( {\begin{array}{*{20}{c}} {a_i} \\ 2 \end{array}} \right)\mathop {\sum }\nolimits_j \left( {\begin{array}{*{20}{c}} {b_j} \\ 2 \end{array}} \right)} \right]/\left( {\begin{array}{*{20}{c}} n \\ 2 \end{array}} \right)}}{{\frac{1}{2}\left[ {\mathop {\sum }\nolimits_i \left( {\begin{array}{*{20}{c}} {a_i} \\ 2 \end{array}} \right) + \mathop {\sum }\nolimits_j \left( {\begin{array}{*{20}{c}} {b_j} \\ 2 \end{array}} \right)} \right] - \left[ {\mathop {\sum }\nolimits_i \left( {\begin{array}{*{20}{c}} {a_i} \\ 2 \end{array}} \right)\mathop {\sum }\nolimits_j \left( {\begin{array}{*{20}{c}} {b_j} \\ 2 \end{array}} \right)} \right]/\left( {\begin{array}{*{20}{c}} n \\ 2 \end{array}} \right)}}$$\end{document}</tex-math><mml:math id="M32"><mml:mi mathvariant="normal">ARI</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>&#x02215;</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo> &#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>&#x02215;</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2019_12630_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par44">The ARI score is 0 for random labeling and 1 for perfectly matching.</p><p id="Par45"><italic>Normalized mutual information</italic>:<disp-formula id="Equc"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{{NMI}}} = \frac{{I(P,T)}}{{\sqrt {{{H}}\left({{P}}\right){{H}}({{T}})} }}$$\end{document}</tex-math><mml:math id="M34"><mml:mi mathvariant="normal">NMI</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:mi>H</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mfenced><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2019_12630_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>where P, T are empirical categorical distributions for the predicted and real clustering, <italic>I</italic> is the mutual entropy, and <italic>H</italic> is the Shannon entropy.</p><p id="Par46"><italic>F1 score</italic>:<disp-formula id="Equd"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{score}} = 2 \ast \left( {{\mathrm{precision}} \ast {\mathrm{recall}}} \right)/({\mathrm{precision}} + {\mathrm{recall}})$$\end{document}</tex-math><mml:math id="M36"><mml:mi mathvariant="normal">score</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>*</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">precision</mml:mi><mml:mo>*</mml:mo><mml:mi mathvariant="normal">recall</mml:mi></mml:mrow></mml:mfenced><mml:mo>&#x02215;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">precision</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">recall</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2019_12630_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="Sec17"><title>Generation and corruption of the simulation dataset</title><p id="Par47">A simulation dataset consisting of 300 cells and 1000 peaks was generated. The peaks formed three clusters, with each cluster containing 100 specific peaks. These specific peaks had a value of 1 or 2 (ratio 1:4) in the cells of the corresponding clusters, and 0 in other cells. Corrupted datasets were generated by randomly dropping out values at different rates from 0.1 to 0.8, followed by introducing random noise by setting values as 1 or 2 (ratio 1:4) with the probability of 0.1.</p></sec><sec id="Sec18"><title>Identifying differentially accessible sites</title><p id="Par48">We followed Cusanovich et al. <sup><xref ref-type="bibr" rid="CR28">28</xref></sup> and used &#x0201c;binomiallf&#x0201d; test implemented in Monocle 2 package<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> to identify differentially accessible peaks. We set a 1% FDR threshold (Benjamini-Hochberg method) to decide the peaks were significant for each cluster.</p></sec><sec id="Sec19"><title>Calculation of the cluster specificity score of a peak</title><p id="Par49">We applied an entropy-based measure to calculate a cluster specificity score for the association of each peak with each cluster. In detail, it is defined by comparing the distribution of the peak pattern with the predefined ideal cluster-specific pattern in which a peak only appears in one cluster:<disp-formula id="Eque"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{score}} = 1 - \sqrt {{\mathrm{Div}}_{{\mathrm{jensen}}}(p,q)}$$\end{document}</tex-math><mml:math id="M38"><mml:mi mathvariant="normal">score</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msqrt><mml:msub><mml:mrow><mml:mi mathvariant="normal">Div</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">jensen</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msqrt></mml:math><graphic xlink:href="41467_2019_12630_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par50">while <italic>p</italic> is the distribution of observed peaks overall samples, and <italic>q</italic> is the distribution of predefined pattern for the cluster <italic>c</italic>,<disp-formula id="Equf"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q = \left( {q_1^{c_1},q_2^{c_2}, \ldots ,q_n^{c_n}} \right)s.t\,q_i^{c_i} = \left\{ {\begin{array}{*{20}{c}} {1,\hfill \quad if \,c_1 = c} \\ {0,\hfill \quad {\mathrm{else}}}\hfill \end{array}} \right.$$\end{document}</tex-math><mml:math id="M40"><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mi>t</mml:mi><mml:mspace width="0.25em"/><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1.0em"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>c</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1.0em"/><mml:mi mathvariant="normal">else</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2019_12630_Article_Equf.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq8"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{Div}}_{{\mathrm{jensen}}}(p,q)$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Div</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">jensen</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12630_Article_IEq8.gif"/></alternatives></inline-formula> is the Jensen divergence distance:<disp-formula id="Equg"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{Div}}_{{\mathrm{Jensen}}}\left( {p,q} \right) = H\left( {\frac{{p + q}}{2}} \right) - \frac{{H\left( p \right) + H(q)}}{2}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Div</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Jensen</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:mi>H</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2019_12630_Article_Equg.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq9"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H\left( p \right)$$\end{document}</tex-math><mml:math id="M46"><mml:mi>H</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12630_Article_IEq9.gif"/></alternatives></inline-formula> is the entropy of peak&#x02019;s distribution:<disp-formula id="Equh"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H\left( p \right) = - \mathop {\sum }\limits_{i = 1}^n p_i{\mathrm{log}}(p_i)$$\end{document}</tex-math><mml:math id="M48"><mml:mi>H</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2019_12630_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par51">This provides the peak-cluster matrix, and the final cluster specificity score is the maximal score overall clusters. By default, we defined the top 200 peaks as the cluster-specific peaks, which were used in the downstream analysis.</p></sec><sec id="Sec20"><title>Binarization</title><p id="Par52">We transformed the float imputed values to binary ones as below:<disp-formula id="Equi"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{imputed}}_{i,j} = \left\{ {\begin{array}{*{20}{c}} {1,\hfill \quad{\mathrm{if}}\,{\mathrm{imputed}}_{i,j} \, &#x0003e; \, {\mathrm{mean}}({\mathrm{raw}}_{i,:})\,{\mathrm{and}} \, &#x0003e; \, {\mathrm{mean}}({\mathrm{raw}}_{:,j})} \\ { 0, \hfill \quad{\mathrm{else}}} \end{array}} \right.$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mi mathvariant="normal">imputed</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1.0em"/><mml:mi mathvariant="normal">if</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi mathvariant="normal">imputed</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mo>&#x0003e;</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">mean</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">raw</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">and</mml:mi><mml:mspace width="0.25em"/><mml:mo>&#x0003e;</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">mean</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">raw</mml:mi></mml:mrow><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1.0em"/><mml:mi mathvariant="normal">else</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2019_12630_Article_Equi.gif" position="anchor"/></alternatives></disp-formula>where imputed is the imputation matrix, raw is the raw data matrix, <italic>i</italic> means the <italic>i</italic>th peak, <italic>j</italic> means the <italic>j</italic>th cell.</p></sec><sec id="Sec21"><title>Confusion score</title><p id="Par53">We first calculated the inter/intra-correlation matrix, then transformed the diagonal values of the correlation matrix to:<disp-formula id="Equj"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{Correlation}}_{{\mathrm{diag}}} = 1 - {\mathrm{Correlation}}_{{\mathrm{diag}}}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Correlation</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">diag</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Correlation</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">diag</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2019_12630_Article_Equj.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par54">Then calculated the mean of the upper triangle of the correlation matrix as the confusion matrix:<disp-formula id="Equk"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{confusion}}\,{\mathrm{score}} = {\mathrm{mean}}({\mathrm{Correlation}}_{{\mathrm{triu}}})$$\end{document}</tex-math><mml:math id="M54"><mml:mi mathvariant="normal">confusion</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">score</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">mean</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Correlation</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">triu</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2019_12630_Article_Equk.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par55">A confusion score of &#x0201c;0&#x0201d; means a perfect preservation of the original population.</p></sec><sec id="Sec22"><title>Features associated peaks</title><p id="Par56">In SCALE, as each feature is directly connected with output peaks, the feature-peak association can be assessed by the weights of links. We approximate the distribution of the weights as a Gaussian distribution, and defined those peaks with weights most deviated from the mean as feature-associated peaks. By default, we set 2.5 standard deviations from the mean as the cutoff.</p></sec><sec id="Sec23"><title>Discovery of enriched TFs</title><p id="Par57">We applied <italic>findMotifsGenomes.pl</italic> from the software Homer with default parameters on the top 1000 specific peaks of the CD45+ and the Epcam+ corresponding single-cell clusters, respectively, to search for transcription factor binding motifs. We only considered the motif occurrences with binomial test <italic>P</italic>-value&#x02009;&#x02264;&#x02009;0.001.</p></sec><sec id="Sec24"><title>Annotation of genomic elements</title><p id="Par58">We used the GREAT<sup><xref ref-type="bibr" rid="CR45">45</xref></sup> algorithm (version 3.0.0) to perform the gene enrichment analysis by including genomic regions of a basal plus an extension (1&#x02009;kb upstream and 0.1&#x02009;kb downstream with up to 500-kb max extension) in the search for elements enriched with the GO &#x02018;biological process&#x02019; terms.</p></sec><sec id="Sec25"><title>Prediction of a suitable number of cluster k</title><p id="Par59">We used the number of the eigenvalues of <bold>X</bold><sup><bold>T</bold></sup><bold>X</bold> that are significantly different as the predicted k, where <bold>X</bold> is the count matrix. We followed SC3 and calculated the mean and the s.d. of the Tracy-Widom distribution to determine the threshold:<disp-formula id="Equl"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{mean}} = \left( {\sqrt {n - 1} + \sqrt p } \right)^2$$\end{document}</tex-math><mml:math id="M56"><mml:mi mathvariant="normal">mean</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msqrt><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:msqrt><mml:mo>+</mml:mo><mml:msqrt><mml:mi>p</mml:mi></mml:msqrt></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><graphic xlink:href="41467_2019_12630_Article_Equl.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equm"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{s.d.}} = \left( {\sqrt {n - 1} + \sqrt p } \right)\left( {\frac{1}{{\sqrt {n - 1} }} + \frac{1}{p}} \right)^{\frac{1}{3}}$$\end{document}</tex-math><mml:math id="M58"><mml:mi mathvariant="normal">s.d.</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msqrt><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:msqrt><mml:mo>+</mml:mo><mml:msqrt><mml:mi>p</mml:mi></mml:msqrt></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msqrt><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:math><graphic xlink:href="41467_2019_12630_Article_Equm.gif" position="anchor"/></alternatives></disp-formula>Where n is the number of peaks and <italic>p</italic> is the number of cells.</p></sec><sec id="Sec26"><title>Reporting summary</title><p id="Par60">Further information on research design is available in the&#x000a0;<xref rid="MOESM3" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p></sec></sec><sec sec-type="supplementary-material"><title>Supplementary information</title><sec id="Sec27"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="41467_2019_12630_MOESM1_ESM.pdf"><caption><p>Supplementary Information</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="41467_2019_12630_MOESM2_ESM.pdf"><caption><p>Peer Review File</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM3"><media xlink:href="41467_2019_12630_MOESM3_ESM.pdf"><caption><p>Reporting Summary</p></caption></media></supplementary-material>
</p></sec></sec></body><back><fn-group><fn><p><bold>Peer review information</bold>
<italic>Nature Communications</italic> thanks Syed Murtuza Baker, Ole Winther and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. Peer reviewer reports are available.</p></fn><fn><p><bold>Publisher&#x02019;s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><sec><title>Supplementary information</title><p><bold>Supplementary information</bold> is available for this paper at 10.1038/s41467-019-12630-7.</p></sec><ack><title>Acknowledgements</title><p>We thank Xinqi Chen for insightful comments on the manuscript and the help with the investigation of the Breast Tumor dataset. We thank Jianbin Wang for helpful suggestions. We thank Mahdi Zamanighomi and Timothy Daley for kindly providing the InSilico and the Leukemia datasets used in the scABC paper. We thank Rongxin Fang for the cell-type labels of the Forebrain dataset in their original paper. We thank Life Science Editors for editing assistance. This project is supported by the Chinese Ministry of Science and Technology (Grant No. 2018YFA0107603 to Q.C.Z.) and the National Natural Science Foundation of China (Grants No. 91740204, 31761163007, and 31621063 to Q.C.Z.), the Beijing Advanced Innovation Center for Structural Biology, the Tsinghua-Peking Joint Center for Life Sciences and the National Thousand Young Talents Program of China to Q.C.Z.</p></ack><notes notes-type="author-contribution"><title>Author contributions</title><p>Q.C.Z. conceived and supervised the project. L.X. designed, implemented, and validated SCALE with the help from K.X., K.T. and Y.S., L.T., G.G., M.Z. and T.J. helped analyzing the data, L.X. and Q.C.Z. wrote the manuscript with inputs from all the authors.</p></notes><notes notes-type="data-availability"><title>Data availability</title><p>The scATAC-seq in silico mixture data are available in Gene Expression Omnibus (GEO) under accession number GSE65360. Single-cell data for leukemia mixture is available at GSE74310, GM12878/HEK293T and GM12878/HL-60 mixtures can be found at GSE68103, Pi-ATAC Breast Tumor data can be obtained at GSE112091. Splenocyte mixture can be accessed at ArrayExpress with accession number E-MTAB-6714 and Forebrain mixture can be accessed at GSE100033. The mouse atlas dataset is available at <ext-link ext-link-type="uri" xlink:href="http://atlas.gs.washington.edu/mouse-atac">http://atlas.gs.washington.edu/mouse-atac</ext-link>. All other relevant data supporting the key findings of this study are available within the article and its Supplementary Information files or from the corresponding author upon reasonable request. A reporting summary for this Article is available as a Supplementary Information file.</p></notes><notes notes-type="data-availability"><title>Code availability</title><p>The SCALE software including documents and tutorial is available on Github (<ext-link ext-link-type="uri" xlink:href="https://github.com/jsxlei/SCALE">https://github.com/jsxlei/SCALE</ext-link>).</p></notes><notes notes-type="COI-statement"><title>Competing interests</title><p id="Par61">The authors declare no competing interests.</p></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsompana</surname><given-names>M</given-names></name><name><surname>Buck</surname><given-names>MJ</given-names></name></person-group><article-title>Chromatin accessibility: a window into the genome</article-title><source>Epigenetics Chromatin</source><year>2014</year><volume>7</volume><fpage>33</fpage><pub-id pub-id-type="doi">10.1186/1756-8935-7-33</pub-id><?supplied-pmid 4253006?><pub-id pub-id-type="pmid">25473421</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buenrostro</surname><given-names>JD</given-names></name><name><surname>Giresi</surname><given-names>PG</given-names></name><name><surname>Zaba</surname><given-names>LC</given-names></name><name><surname>Chang</surname><given-names>HY</given-names></name><name><surname>Greenleaf</surname><given-names>WJ</given-names></name></person-group><article-title>Transposition of native chromatin for fast and sensitive epigenomic profiling of open chromatin, DNA-binding proteins and nucleosome position</article-title><source>Nat. Methods</source><year>2013</year><volume>10</volume><fpage>1213</fpage><lpage>1218</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2688</pub-id><?supplied-pmid 3959825?><pub-id pub-id-type="pmid">24097267</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buenrostro</surname><given-names>JD</given-names></name><etal/></person-group><article-title>Single-cell chromatin accessibility reveals principles of regulatory variation</article-title><source>Nature</source><year>2015</year><volume>523</volume><fpage>486</fpage><lpage>490</lpage><pub-id pub-id-type="doi">10.1038/nature14590</pub-id><?supplied-pmid 4685948?><pub-id pub-id-type="pmid">26083756</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cusanovich</surname><given-names>DA</given-names></name><etal/></person-group><article-title>Multiplex single cell profiling of chromatin accessibility by combinatorial cellular indexing</article-title><source>Science</source><year>2015</year><volume>348</volume><fpage>910</fpage><lpage>914</lpage><pub-id pub-id-type="doi">10.1126/science.aab1601</pub-id><?supplied-pmid 4836442?><pub-id pub-id-type="pmid">25953818</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abdi</surname><given-names>H</given-names></name><name><surname>Williams</surname><given-names>LJ</given-names></name></person-group><article-title>Principal component analysis</article-title><source>WIREs Comput. Stat.</source><year>2010</year><volume>2</volume><fpage>433</fpage><lpage>459</lpage><pub-id pub-id-type="doi">10.1002/wics.101</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Maaten</surname><given-names>L</given-names></name><name><surname>Hinton</surname><given-names>G</given-names></name></person-group><article-title>Visualizing Data using t-SNE</article-title><source>J. Mach. Learn. Res.</source><year>2008</year><volume>9</volume><fpage>2579</fpage><lpage>2605</lpage></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Menon</surname><given-names>Vilas</given-names></name></person-group><article-title>Clustering single cells: a review of approaches on high-and low-depth single-cell RNA-seq data</article-title><source>Briefings in Functional Genomics</source><year>2017</year><volume>17</volume><issue>4</issue><fpage>240</fpage><lpage>245</lpage><pub-id pub-id-type="doi">10.1093/bfgp/elx044</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Macosko</surname><given-names>EZ</given-names></name><etal/></person-group><article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title><source>Cell</source><year>2015</year><volume>161</volume><fpage>1202</fpage><lpage>1214</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id><?supplied-pmid 4481139?><pub-id pub-id-type="pmid">26000488</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shekhar</surname><given-names>K</given-names></name><etal/></person-group><article-title>Comprehensive classification of retinal bipolar neurons by single-cell transcriptomics</article-title><source>Cell</source><year>2016</year><volume>166</volume><fpage>1308</fpage><lpage>1323 e1330</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2016.07.054</pub-id><?supplied-pmid 27565351?><pub-id pub-id-type="pmid">27565351</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tasic</surname><given-names>B</given-names></name><etal/></person-group><article-title>Adult mouse cortical cell taxonomy revealed by single cell transcriptomics</article-title><source>Nat. Neurosci.</source><year>2016</year><volume>19</volume><fpage>335</fpage><lpage>346</lpage><pub-id pub-id-type="doi">10.1038/nn.4216</pub-id><?supplied-pmid 26727548?><pub-id pub-id-type="pmid">26727548</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>WV</given-names></name><name><surname>Li</surname><given-names>JJ</given-names></name></person-group><article-title>An accurate and robust imputation method scImpute for single-cell RNA-seq data</article-title><source>Nat. Commun.</source><year>2018</year><volume>9</volume><fpage>997</fpage><pub-id pub-id-type="doi">10.1038/s41467-018-03405-7</pub-id><?supplied-pmid 29520097?><pub-id pub-id-type="pmid">29520097</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>M</given-names></name><etal/></person-group><article-title>SAVER: gene expression recovery for single-cell RNA sequencing</article-title><source>Nat. Methods</source><year>2018</year><volume>15</volume><fpage>539</fpage><lpage>542</lpage><pub-id pub-id-type="doi">10.1038/s41592-018-0033-z</pub-id><?supplied-pmid 29941873?><pub-id pub-id-type="pmid">29941873</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schep</surname><given-names>AN</given-names></name><name><surname>Wu</surname><given-names>B</given-names></name><name><surname>Buenrostro</surname><given-names>JD</given-names></name><name><surname>Greenleaf</surname><given-names>WJ</given-names></name></person-group><article-title>chromVAR: inferring transcription-factor-associated accessibility from single-cell epigenomic data</article-title><source>Nat. Methods</source><year>2017</year><volume>14</volume><fpage>975</fpage><lpage>978</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4401</pub-id><?supplied-pmid 28825706?><pub-id pub-id-type="pmid">28825706</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zamanighomi</surname><given-names>M</given-names></name><etal/></person-group><article-title>Unsupervised clustering and epigenetic classification of single cells</article-title><source>Nat. Commun.</source><year>2018</year><volume>9</volume><fpage>2410</fpage><pub-id pub-id-type="doi">10.1038/s41467-018-04629-3</pub-id><?supplied-pmid 29925875?><pub-id pub-id-type="pmid">29925875</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bravo Gonzalez-Blas</surname><given-names>C</given-names></name><etal/></person-group><article-title>cisTopic: cis-regulatory topic modeling on single-cell ATAC-seq data</article-title><source>Nat. Methods</source><year>2019</year><volume>16</volume><fpage>397</fpage><lpage>400</lpage><pub-id pub-id-type="doi">10.1038/s41592-019-0367-1</pub-id><?supplied-pmid 30962623?><pub-id pub-id-type="pmid">30962623</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="other">Kingma, D. P. &#x00026; Welling, M. Auto-encoding variational bayes. <italic>arXiv:</italic>1312.6114 (2013).</mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="other">Xie, J., Girshick, R. &#x00026; Farhadi, A. Unsupervised deep embedding for clustering analysis. <italic>arXiv:1511.06335</italic> (2015).</mixed-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lopez</surname><given-names>R</given-names></name><name><surname>Regier</surname><given-names>J</given-names></name><name><surname>Cole</surname><given-names>MB</given-names></name><name><surname>Jordan</surname><given-names>MI</given-names></name><name><surname>Yosef</surname><given-names>N</given-names></name></person-group><article-title>Deep generative modeling for single-cell transcriptomics</article-title><source>Nat. Methods</source><year>2018</year><volume>15</volume><fpage>1053</fpage><lpage>1058</lpage><pub-id pub-id-type="doi">10.1038/s41592-018-0229-2</pub-id><?supplied-pmid 30504886?><pub-id pub-id-type="pmid">30504886</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="other">Krishnan, R. G., Liang, D. &#x00026; Hoffman, M. On the challenges of learning with inference networks on sparse, high-dimensional data. <italic>arXiv:1710.06085</italic> (2017).</mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="other">Jiang, Z., Zheng, Y., Tan, H., Tang, B. &#x00026; Zhou, H. Variational deep embedding: an unsupervised and generative approach to clustering. <italic>arXiv:1611.05148</italic> (2016).</mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="other">Dilokthanakul, N. et al. Deep unsupervised clustering with gaussian mixture variational autoencoders. <italic>arXiv:1611.02648v2</italic> (2016).</mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="other">Gr&#x000f8;nbech, C. H. et al. scVAE: Variational auto-encoders for single-cell gene expression data. <italic>bioRxiv</italic> (2018).</mixed-citation></ref><ref id="CR23"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>X</given-names></name><etal/></person-group><article-title>Joint single-cell DNA accessibility and protein epitope profiling reveals environmental regulation of epigenomic heterogeneity</article-title><source>Nat. Commun.</source><year>2018</year><volume>9</volume><fpage>4590</fpage><pub-id pub-id-type="doi">10.1038/s41467-018-07115-y</pub-id><?supplied-pmid 30389926?><pub-id pub-id-type="pmid">30389926</pub-id></element-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corces</surname><given-names>MR</given-names></name><etal/></person-group><article-title>Lineage-specific and single-cell chromatin accessibility charts human hematopoiesis and leukemia evolution</article-title><source>Nat. Genet.</source><year>2016</year><volume>48</volume><fpage>1193</fpage><lpage>1203</lpage><pub-id pub-id-type="doi">10.1038/ng.3646</pub-id><?supplied-pmid 5042844?><pub-id pub-id-type="pmid">27526324</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Miragaia</surname><given-names>RJ</given-names></name><name><surname>Natarajan</surname><given-names>KN</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name></person-group><article-title>A rapid and robust method for single cell chromatin accessibility profiling</article-title><source>Nat. Commun.</source><year>2018</year><volume>9</volume><fpage>5345</fpage><pub-id pub-id-type="doi">10.1038/s41467-018-07771-0</pub-id><?supplied-pmid 30559361?><pub-id pub-id-type="pmid">30559361</pub-id></element-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Preissl</surname><given-names>S</given-names></name><etal/></person-group><article-title>Single-nucleus analysis of accessible chromatin in developing mouse forebrain reveals cell-type-specific transcriptional regulation</article-title><source>Nat. Neurosci.</source><year>2018</year><volume>21</volume><fpage>432</fpage><lpage>439</lpage><pub-id pub-id-type="doi">10.1038/s41593-018-0079-3</pub-id><?supplied-pmid 29434377?><pub-id pub-id-type="pmid">29434377</pub-id></element-citation></ref><ref id="CR27"><label>27.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pliner</surname><given-names>Hannah A.</given-names></name><name><surname>Packer</surname><given-names>Jonathan S.</given-names></name><name><surname>McFaline-Figueroa</surname><given-names>Jos&#x000e9; L.</given-names></name><name><surname>Cusanovich</surname><given-names>Darren A.</given-names></name><name><surname>Daza</surname><given-names>Riza M.</given-names></name><name><surname>Aghamirzaie</surname><given-names>Delasa</given-names></name><name><surname>Srivatsan</surname><given-names>Sanjay</given-names></name><name><surname>Qiu</surname><given-names>Xiaojie</given-names></name><name><surname>Jackson</surname><given-names>Dana</given-names></name><name><surname>Minkina</surname><given-names>Anna</given-names></name><name><surname>Adey</surname><given-names>Andrew C.</given-names></name><name><surname>Steemers</surname><given-names>Frank J.</given-names></name><name><surname>Shendure</surname><given-names>Jay</given-names></name><name><surname>Trapnell</surname><given-names>Cole</given-names></name></person-group><article-title>Cicero Predicts cis-Regulatory DNA Interactions from Single-Cell Chromatin Accessibility Data</article-title><source>Molecular Cell</source><year>2018</year><volume>71</volume><issue>5</issue><fpage>858-871.e8</fpage><pub-id pub-id-type="doi">10.1016/j.molcel.2018.06.044</pub-id><?supplied-pmid 30078726?><pub-id pub-id-type="pmid">30078726</pub-id></element-citation></ref><ref id="CR28"><label>28.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cusanovich</surname><given-names>Darren A.</given-names></name><name><surname>Hill</surname><given-names>Andrew J.</given-names></name><name><surname>Aghamirzaie</surname><given-names>Delasa</given-names></name><name><surname>Daza</surname><given-names>Riza M.</given-names></name><name><surname>Pliner</surname><given-names>Hannah A.</given-names></name><name><surname>Berletch</surname><given-names>Joel B.</given-names></name><name><surname>Filippova</surname><given-names>Galina N.</given-names></name><name><surname>Huang</surname><given-names>Xingfan</given-names></name><name><surname>Christiansen</surname><given-names>Lena</given-names></name><name><surname>DeWitt</surname><given-names>William S.</given-names></name><name><surname>Lee</surname><given-names>Choli</given-names></name><name><surname>Regalado</surname><given-names>Samuel G.</given-names></name><name><surname>Read</surname><given-names>David F.</given-names></name><name><surname>Steemers</surname><given-names>Frank J.</given-names></name><name><surname>Disteche</surname><given-names>Christine M.</given-names></name><name><surname>Trapnell</surname><given-names>Cole</given-names></name><name><surname>Shendure</surname><given-names>Jay</given-names></name></person-group><article-title>A Single-Cell Atlas of In&#x000a0;Vivo Mammalian Chromatin Accessibility</article-title><source>Cell</source><year>2018</year><volume>174</volume><issue>5</issue><fpage>1309-1324.e18</fpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.06.052</pub-id><?supplied-pmid 30078704?><pub-id pub-id-type="pmid">30078704</pub-id></element-citation></ref><ref id="CR29"><label>29.</label><mixed-citation publication-type="other">McInnes, L., Healy, J. &#x00026; Melville, J. UMAP: Uniform manifold approximation and projection for dimension reduction. <italic>arXiv:1802.03426</italic> (2018).</mixed-citation></ref><ref id="CR30"><label>30.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goardon</surname><given-names>N</given-names></name><etal/></person-group><article-title>Coexistence of LMPP-like and GMP-like leukemia stem cells in acute myeloid leukemia</article-title><source>Cancer Cell.</source><year>2011</year><volume>19</volume><fpage>138</fpage><lpage>152</lpage><pub-id pub-id-type="doi">10.1016/j.ccr.2010.12.012</pub-id><?supplied-pmid 21251617?><pub-id pub-id-type="pmid">21251617</pub-id></element-citation></ref><ref id="CR31"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bennett</surname><given-names>JM</given-names></name><etal/></person-group><article-title>Proposals for the classification of the acute leukaemias. French-American-British (FAB) co-operative group</article-title><source>Br. J. Haematol.</source><year>1976</year><volume>33</volume><fpage>451</fpage><lpage>458</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2141.1976.tb03563.x</pub-id><?supplied-pmid 188440?><pub-id pub-id-type="pmid">188440</pub-id></element-citation></ref><ref id="CR32"><label>32.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van&#x02019;t Veer</surname><given-names>MB</given-names></name></person-group><article-title>The diagnosis of acute leukemia with undifferentiated or minimally differentiated blasts</article-title><source>Ann. Hematol.</source><year>1992</year><volume>64</volume><fpage>161</fpage><lpage>165</lpage><pub-id pub-id-type="doi">10.1007/BF01696217</pub-id><?supplied-pmid 1581403?><pub-id pub-id-type="pmid">1581403</pub-id></element-citation></ref><ref id="CR33"><label>33.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kiselev</surname><given-names>VY</given-names></name><etal/></person-group><article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title><source>Nat. Methods</source><year>2017</year><volume>14</volume><fpage>483</fpage><lpage>486</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4236</pub-id><?supplied-pmid 28346451?><pub-id pub-id-type="pmid">28346451</pub-id></element-citation></ref><ref id="CR34"><label>34.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Price</surname><given-names>AL</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name></person-group><article-title>Population Structure and Eigenanalysis</article-title><source>PLoS. Genet.</source><year>2006</year><volume>2</volume><fpage>e190</fpage><pub-id pub-id-type="doi">10.1371/journal.pgen.0020190</pub-id><?supplied-pmid 17194218?><pub-id pub-id-type="pmid">17194218</pub-id></element-citation></ref><ref id="CR35"><label>35.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tozaki-Saitoh</surname><given-names>H</given-names></name><etal/></person-group><article-title>Transcription factor MafB contributes to the activation of spinal microglia underlying neuropathic pain development</article-title><source>Glia</source><year>2019</year><volume>67</volume><fpage>729</fpage><lpage>740</lpage><pub-id pub-id-type="doi">10.1002/glia.23570</pub-id><?supplied-pmid 30485546?><pub-id pub-id-type="pmid">30485546</pub-id></element-citation></ref><ref id="CR36"><label>36.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nord</surname><given-names>AS</given-names></name><name><surname>Pattabiraman</surname><given-names>K</given-names></name><name><surname>Visel</surname><given-names>A</given-names></name><name><surname>Rubenstein</surname><given-names>JLR</given-names></name></person-group><article-title>Genomic perspectives of transcriptional regulation in forebrain development</article-title><source>Neuron</source><year>2015</year><volume>85</volume><fpage>27</fpage><lpage>47</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.11.011</pub-id><?supplied-pmid 25569346?><pub-id pub-id-type="pmid">25569346</pub-id></element-citation></ref><ref id="CR37"><label>37.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>EJ</given-names></name><etal/></person-group><article-title>Spatiotemporal fate map of neurogenin1 (Neurog1) lineages in the mouse central nervous system</article-title><source>J. Comp. Neurol.</source><year>2011</year><volume>519</volume><fpage>1355</fpage><lpage>1370</lpage><pub-id pub-id-type="doi">10.1002/cne.22574</pub-id><?supplied-pmid 21452201?><pub-id pub-id-type="pmid">21452201</pub-id></element-citation></ref><ref id="CR38"><label>38.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heinz</surname><given-names>S</given-names></name><etal/></person-group><article-title>Simple combinations of lineage-determining transcription factors prime cis-regulatory elements required for macrophage and B cell identities</article-title><source>Mol. Cell</source><year>2010</year><volume>38</volume><fpage>576</fpage><lpage>589</lpage><pub-id pub-id-type="doi">10.1016/j.molcel.2010.05.004</pub-id><?supplied-pmid 2898526?><pub-id pub-id-type="pmid">20513432</pub-id></element-citation></ref><ref id="CR39"><label>39.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Voon</surname><given-names>DC</given-names></name><name><surname>Hor</surname><given-names>YT</given-names></name><name><surname>Ito</surname><given-names>Y</given-names></name></person-group><article-title>The RUNX complex: reaching beyond haematopoiesis into immunity</article-title><source>Immunology</source><year>2015</year><volume>146</volume><fpage>523</fpage><lpage>536</lpage><pub-id pub-id-type="doi">10.1111/imm.12535</pub-id><?supplied-pmid 26399680?><pub-id pub-id-type="pmid">26399680</pub-id></element-citation></ref><ref id="CR40"><label>40.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sachini</surname><given-names>N</given-names></name><name><surname>Papamatheakis</surname><given-names>J</given-names></name></person-group><article-title>NF-Y and the immune response: dissecting the complex regulation of MHC genes</article-title><source>Biochim. Biophys. Acta Gene Regul. Mech.</source><year>2017</year><volume>1860</volume><fpage>537</fpage><lpage>542</lpage><pub-id pub-id-type="doi">10.1016/j.bbagrm.2016.10.013</pub-id><?supplied-pmid 27989934?><pub-id pub-id-type="pmid">27989934</pub-id></element-citation></ref><ref id="CR41"><label>41.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Furlan</surname><given-names>A</given-names></name><etal/></person-group><article-title>Ets-1 controls breast cancer cell balance between invasion and growth</article-title><source>Int. J. Cancer</source><year>2014</year><volume>135</volume><fpage>2317</fpage><lpage>2328</lpage><pub-id pub-id-type="doi">10.1002/ijc.28881</pub-id><?supplied-pmid 24706481?><pub-id pub-id-type="pmid">24706481</pub-id></element-citation></ref><ref id="CR42"><label>42.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>C</given-names></name><etal/></person-group><article-title>NRF2 promotes breast cancer cell proliferation and metastasis by increasing RhoA/ROCK pathway signal transduction</article-title><source>Oncotarget</source><year>2016</year><volume>7</volume><fpage>73593</fpage><lpage>73606</lpage><?supplied-pmid 27713154?><pub-id pub-id-type="pmid">27713154</pub-id></element-citation></ref><ref id="CR43"><label>43.</label><mixed-citation publication-type="other">Kingma, D. P. &#x00026; Ba, J. Adam: A Method for Stochastic Optimization. <italic>arXiv:1412.6980</italic> (2014).</mixed-citation></ref><ref id="CR44"><label>44.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname><given-names>X</given-names></name><etal/></person-group><article-title>Reversed graph embedding resolves complex single-cell trajectories</article-title><source>Nat. Methods</source><year>2017</year><volume>14</volume><fpage>979</fpage><lpage>982</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4402</pub-id><?supplied-pmid 28825705?><pub-id pub-id-type="pmid">28825705</pub-id></element-citation></ref><ref id="CR45"><label>45.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McLean</surname><given-names>CY</given-names></name><etal/></person-group><article-title>GREAT improves functional interpretation of cis-regulatory regions</article-title><source>Nat. Biotechnol.</source><year>2010</year><volume>28</volume><fpage>495</fpage><lpage>501</lpage><pub-id pub-id-type="doi">10.1038/nbt.1630</pub-id><?supplied-pmid 20436461?><pub-id pub-id-type="pmid">20436461</pub-id></element-citation></ref></ref-list></back></article>