<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Genome Biol</journal-id><journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id><journal-title-group><journal-title>Genome Biology</journal-title></journal-title-group><issn pub-type="ppub">1474-7596</issn><issn pub-type="epub">1474-760X</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6734238</article-id><article-id pub-id-type="publisher-id">1806</article-id><article-id pub-id-type="doi">10.1186/s13059-019-1806-0</article-id><article-categories><subj-group subj-group-type="heading"><subject>Method</subject></subj-group></article-categories><title-group><article-title>scBFA: modeling detection patterns to mitigate technical noise in large-scale single-cell genomics data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Li</surname><given-names>Ruoxin</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1716-0153</contrib-id><name><surname>Quon</surname><given-names>Gerald</given-names></name><address><email>gquon@ucdavis.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff3">3</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 9684</institution-id><institution-id institution-id-type="GRID">grid.27860.3b</institution-id><institution>Graduate Group in Biostatistics, </institution><institution>University of California, Davis, </institution></institution-wrap>Davis, CA USA </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 9684</institution-id><institution-id institution-id-type="GRID">grid.27860.3b</institution-id><institution>Genome Center, </institution><institution>University of California, Davis, </institution></institution-wrap>Davis, CA USA </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 9684</institution-id><institution-id institution-id-type="GRID">grid.27860.3b</institution-id><institution>Department of Molecular and Cellular Biology, </institution><institution>University of California, Davis, </institution></institution-wrap>Davis, CA USA </aff></contrib-group><pub-date pub-type="epub"><day>9</day><month>9</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>9</day><month>9</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>20</volume><elocation-id>193</elocation-id><history><date date-type="received"><day>11</day><month>3</month><year>2019</year></date><date date-type="accepted"><day>28</day><month>8</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s). 2019</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">Technical variation in feature measurements, such as gene expression and locus accessibility, is a key challenge of large-scale single-cell genomic datasets. We show that this technical variation in both scRNA-seq and scATAC-seq datasets can be mitigated by analyzing feature detection patterns alone and ignoring feature quantification measurements. This result holds when datasets have low detection noise relative to quantification noise. We demonstrate state-of-the-art performance of detection pattern models using our new framework, scBFA, for both cell type identification and trajectory inference. Performance gains can also be realized in one line of R code in existing pipelines.</p><sec><title>Electronic supplementary material</title><p>The online version of this article (10.1186/s13059-019-1806-0) contains supplementary material, which is available to authorized users.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>scRNA-seq</kwd><kwd>Dimensionality reduction</kwd><kwd>scATAC-seq</kwd><kwd>Technical noise</kwd><kwd>Gene detection</kwd><kwd>Gene quantification</kwd><kwd>Cell type identification</kwd><kwd>Trajectory inference</kwd><kwd>Variable gene selection</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000923</institution-id><institution>Silicon Valley Community Foundation</institution></institution-wrap></funding-source><award-id>2018-182633</award-id><principal-award-recipient><name><surname>Quon</surname><given-names>Gerald</given-names></name></principal-award-recipient></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000153</institution-id><institution>Division of Biological Infrastructure</institution></institution-wrap></funding-source><award-id>1846559</award-id><principal-award-recipient><name><surname>Quon</surname><given-names>Gerald</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2019</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p id="Par2">Single-cell genomics technologies have become a widely used technique for investigating diverse problems related to gene regulation, including the identification of novel cell types and their regulatory signatures, trajectory inference for the analysis of continuous processes such as differentiation, high-resolution analysis of transcriptional dynamics, and characterization of transcriptional heterogeneity within populations of cells [<xref ref-type="bibr" rid="CR1">1</xref>]. Of the different modalities that can be profiled, single-cell RNA sequencing (scRNA-seq) is currently the most mature; diverse scRNA-seq technologies are now available to cater towards specific applications. For instance, droplet-based methods, such as Drop-seq, currently have some of the highest throughput capture of cells and are suitable for rare cell type identification and characterization of tissue heterogeneity. The so-called full-length transcript methods are able to measure alternative splicing and sequence individual cells more deeply, with the limitation of typically sequencing fewer cells.</p><p id="Par3">scRNA-seq technologies are still rapidly evolving [<xref ref-type="bibr" rid="CR2">2</xref>], and one of the most pressing challenges today is to address a large amount of technical noise that can drive approximately 50% of the cell-cell variation in expression measurements [<xref ref-type="bibr" rid="CR3">3</xref>&#x02013;<xref ref-type="bibr" rid="CR5">5</xref>]. Two such expression measurements of interest are gene detection (the identification of the set of all genes truly expressed in a given cell) and gene quantification (the estimation of the relative number of transcripts per gene and cell, also referred to as counts); the fidelity of these measurements for a given technology is termed its sensitivity and accuracy, respectively. Both sensitivity and accuracy vary widely between scRNA-seq technologies [<xref ref-type="bibr" rid="CR6">6</xref>], which is the result of the small quantities of RNA sequenced per cell, reverse transcriptase inefficiency, and amplification bias [<xref ref-type="bibr" rid="CR5">5</xref>], among other features of the scRNA-seq protocols.</p><p id="Par4">Independent of technology choice, scRNA-seq experimental design necessitates a cost trade-off between deeper sequencing of individual cells and sequencing more cells overall. We have observed that as the number of cells sequenced increases, the average gene detection rate decreases, as does the average number of molecules sequenced per cell (Additional&#x000a0;file&#x000a0;1: Figure S1), due to both choice of technology and cost trade-off. We reasoned that when the number of unique molecules drops too low, the signal-noise ratio of the data may be too low to make gene quantification informative [<xref ref-type="bibr" rid="CR7">7</xref>], and therefore, downstream analyses should be adapted to primarily consider only gene detection patterns.</p><p id="Par5">In this paper, we make the key observation that on scRNA-seq datasets exhibiting high technical noise, dimensionality reduction using only the gene detection measurements is superior to the existing state-of-the-art methods that use both detection and quantification measurements [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. We show that our new detection-based model, single-cell binary factor analysis (scBFA), leads to better cell type identification and trajectory inference, more accurate recovery of cell type-specific markers, and is much faster to perform compared to several quantification-based methods. Through simulation experiments, we demonstrate that our gene detection model is superior precisely when quantification noise exceeds detection noise, providing a principled explanation for when and why discarding quantification estimates is advantageous. Finally, we demonstrate the superiority of our detection model in the analysis of single-cell chromatin accessibility data, suggesting detection models may improve downstream analysis of other single-cell genomic modalities in high-throughput datasets.</p></sec><sec id="Sec2"><title>Results</title><sec id="Sec3"><title>scBFA achieves superior performance in cell type identification across diverse benchmarks</title><p id="Par6">We first hypothesized that the performance of scRNA-seq analysis tools that model gene counts (quantification) could be improved by instead modeling only the gene detection patterns when analyzing datasets that have a high degree of technical noise. Our intuition is that it is well established that poorly expressed genes are hard to accurately quantify using single-cell genomics technologies due to technical noise [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. Extrapolating to an entire dataset, we then reasoned that for datasets in which technical noise leads to low gene detection and noisy quantification, modeling differences in small gene counts is challenging and prone to error, and therefore, focusing only on gene detection would be more robust.</p><p id="Par7">To test our hypothesis, we developed single-cell binary factor analysis (scBFA), a method for dimensionality reduction that only uses gene detection patterns. We compared scBFA against seven other approaches that model gene counts and represent the spectrum of approaches to identifying cell types within scRNA-seq datasets (see the &#x0201c;Methods&#x0201d; section): scVI [<xref ref-type="bibr" rid="CR12">12</xref>], SAVER [<xref ref-type="bibr" rid="CR13">13</xref>], sctransform [<xref ref-type="bibr" rid="CR14">14</xref>], scrna2019 [<xref ref-type="bibr" rid="CR15">15</xref>], PCA, ZINB-WaVE [<xref ref-type="bibr" rid="CR8">8</xref>], and scImpute [<xref ref-type="bibr" rid="CR9">9</xref>]. scBFA is designed as a gene detection-based analog of ZINB-WaVE, and so, comparison of scBFA versus ZINB-WaVE is the most direct comparison of gene detection versus quantification-based approaches. In this study, we focus on the task of dimensionality reduction, as it is a nearly ubiquitous first step both for data visualization and analysis [<xref ref-type="bibr" rid="CR16">16</xref>&#x02013;<xref ref-type="bibr" rid="CR18">18</xref>] and many analysis tools have been developed to address it [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. Furthermore, previous work has shown that cell type identification and dimensionality reduction are still possible in scRNA-seq experimental designs favoring high cell counts, with low coverage per cell [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR21">21</xref>&#x02013;<xref ref-type="bibr" rid="CR23">23</xref>].</p><p id="Par8">We evaluated the methods using 14 benchmark datasets for which experimentally defined cell type labels were available (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1) by first learning low dimensional embeddings, then using the embeddings to predict cell type labels in a supervised setting. When using highly variable genes (HVGs) as a gene selection criterion during data preprocessing, we found scBFA was the best, or tied for best, in 13 out of 14 benchmarks (Figs. <xref rid="Fig1" ref-type="fig">1</xref> and <xref rid="Fig2" ref-type="fig">2</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S2-S3). This result was robust to the selection of the hyperparameters of scBFA (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). Surprisingly, we found that the choice of gene selection had a significant impact on our results. Under an alternative gene selection procedure that biases towards highly expressed genes (HEGs) and yields minimal overlap with HVG (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2), scBFA was a top performer in only 9 of 14 of the benchmarks (Additional file 1: Figure S5).
<fig id="Fig1"><label>Fig. 1</label><caption><p>Single-cell binary factor analysis (scBFA) outperforms quantification models. Performance is measured via cross-validation of cell type classifiers trained on scRNA-seq benchmark data in the respective embedding spaces of each method, as a function of the number of latent dimensions specified. scBFA is a top performer in 13 out of 14 datasets. Datasets from left to right, top to bottom: Dendritic, Pancreatic, DC, mESCs, HSPCs, MGE, Intestinal, MEM-T, H7-ESC, LSK, Myeloid, HSCs, PBMC, and LPS (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1 for a detailed description of benchmarks)</p></caption><graphic xlink:href="13059_2019_1806_Fig1_HTML" id="MO1"/></fig>
<fig id="Fig2"><label>Fig. 2</label><caption><p>scBFA improves visualization of cell identity in the MEM-T benchmark of Patil et al. 2D t-SNE visualization of 10-dimensional embeddings generated by the eight methods on the MEM-T benchmark. Cells are colored according to their corresponding cell types and states.</p></caption><graphic xlink:href="13059_2019_1806_Fig2_HTML" id="MO2"/></fig></p></sec><sec id="Sec4"><title>Gene selection shapes cell type identification performance by modulating detection rate and dispersion</title><p id="Par9">We hypothesized the stark difference in performance between the HVG and HEG selection criteria was due to the differences in the overall technical noise in the resulting selected gene sets. For both the HVG and HEG versions of each benchmark, we computed two indirect measures of technical noise, the gene detection rate (GDR) and gene-wise dispersion. Existing approaches to directly estimating technical noise require spike-in standards [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>], and not all datasets we analyzed had incorporated spike-in standards in their protocol. GDR is the average fraction of genes that are detected as expressed in a given cell. Gene-wise dispersion is intuitively the excess variation in the gene expression observed beyond what is expected based on a Poisson model of sampling noise and is driven by both technical noise and biological factors of interest.</p><p id="Par10">When considering individual benchmarks in isolation, HVG selection leads to a systematically lower GDR and higher gene-wise dispersion compared to HEG selection (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Furthermore, HEG selection consistently leads to higher performance in cell type identification for all methods tested (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c), suggesting that HEG selection may be more sensible for cell type identification. This result is intuitive, as the HVG selection procedure identifies genes whose variance is in excess of that predicted by sampling noise, and therefore is likely to be enriched in poorly expressed genes that exhibit significant dropout noise. For scBFA, specifically, the three benchmarks for which HVG outperformed HEG correspond to the benchmarks for which HEG selection led to the highest GDR and HVG selection led to low GDR (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c, d). The poor performance of scBFA combined with HEG selection can therefore be explained by the high GDR.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Relative scBFA performance is positively correlated with dataset size and high technical noise. <bold>a</bold> Gene detection rate as a function of the number of cells for the 14 benchmarks, when processed using either HVG or HEG selection. Group I benchmarks refers to those datasets in which scBFA is a top performer, and group II benchmarks refers to datasets in which scBFA is a poor performer. Note that each of the 14 benchmarks are represented twice (once under each of HEG and HVG selection). Additional&#x000a0;file&#x000a0;1: Table S6 indicates the membership of each benchmark within group I and group II. <bold>b</bold> Same as <bold>a</bold>, except mean-dispersion trends are estimated and visualized for each of the datasets from group I and group II, under HVG and HEG selection criteria. <bold>c</bold> Difference in performance (MCC) of cell type classifiers trained on individual benchmarks and for each method, either using HVG or HEG selection. Performance is assessed through cross-validation of cell type classifiers trained on scRNA-seq data in the respective embedding spaces of each method. Performance is averaged across all number of latent dimensions tested. <bold>d</bold> The corresponding gene detection rate under the two gene selection criteria. Note HEG yields systematically higher GDR compared to HVG.</p></caption><graphic xlink:href="13059_2019_1806_Fig3_HTML" id="MO3"/></fig></p><p id="Par11">Across all benchmarks and gene selection criteria, we found that scBFA outperforms count-based methods for benchmarks with low GDR and high gene-wise dispersion (Figs. <xref rid="Fig1" ref-type="fig">1</xref> and <xref rid="Fig3" ref-type="fig">3</xref>; Additional&#x000a0;file&#x000a0;1: Figure S5, group I benchmarks). This is likely because higher dispersion increases the noise within the gene counts, forcing count-based models and their low-dimensional embeddings to explain more outliers and noise in the data; this is particularly true for count models that share variance parameters across genes [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]. The gene detection pattern is more robust to noise than counts because moderately to highly expressed genes are likely to be equally well detected even in the presence of technical noise. Interestingly, low GDR of a dataset in particular is associated with more sequenced cells regardless of the experimental protocol used (Additional&#x000a0;file&#x000a0;1: Figure S1) and is likely a result of investigators trading off sequencing many cells at the cost of sequencing fewer reads per cell. These results together suggest that scBFA is more appropriate for large-scale dataset analysis than quantification-based methods.</p><p id="Par12">Inversely, high GDR is more typical of smaller datasets (Additional&#x000a0;file&#x000a0;1: Figure S1) and yields poor performance of scBFA. This is because when the GDR reaches close to 100%, every gene is detected in nearly every cell, so there is a limited variation for scBFA to capture in its embedding space. Consistent with these results, we found that the performance of scBFA decreases after imputation (SAVER-scBFA, scImpute-scBFA) relative to before imputation (scBFA) (Additional&#x000a0;file&#x000a0;1: Figure S6), in part because imputation increases GDR by imputing false-positive zero expression. On average, SAVER increased the GDR by 9.6% and scImpute increases GDR by 232.6%.</p></sec><sec id="Sec5"><title>Balance of detection and quantification noise determines the relative performance of detection and count models</title><p id="Par13">We next sought to identify precisely which types of technical noise were responsible for the relative performance of scBFA versus the gene count models. Previous studies found that sensitivity and accuracy (gene detection and quantification) can be affected differently by sequencing depth and other features of the protocols [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR27">27</xref>]. We hypothesized that differences in detection and quantification noise might explain the performance difference between scBFA and quantification-based methods. Because technical noise is difficult to estimate in real datasets without the spike-in standards, we instead generated thousands of simulated scRNA-seq datasets that systematically vary in the relative amount of noise in gene detection and gene counts (quantification).</p><p id="Par14">Our simulation framework extends the ZINB-WaVE statistical model [<xref ref-type="bibr" rid="CR8">8</xref>] to include the parameters that separately influence the noise added to either the gene detection pattern <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left({\sigma}_{\pi}^2\right) $$\end{document}</tex-math><mml:math id="M2" display="inline"><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>&#x003c0;</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq1.gif"/></alternatives></inline-formula> or the gene counts (<inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sigma}_{\mu}^2\Big) $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq2.gif"/></alternatives></inline-formula>in the simulated datasets. We also tuned the global level of gene dispersion that drives variation in gene counts via the parameter <italic>r</italic>, which adds noise specifically to the UMI counts in the dataset and is a key parameter of many dimensionality reduction models [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR28">28</xref>]. Finally, we also tuned the global level of gene dropout observed in the dataset via the parameter <italic>&#x003b4;</italic>, to simulate global differences in gene detection typically observed between different protocols and technologies [<xref ref-type="bibr" rid="CR6">6</xref>].</p><p id="Par15">We first confirmed that our simulation framework generates datasets with similar characteristics to real datasets. For each of the LSK, HSPC, and LPS benchmarks, we first applied the HVG selection procedure and fit the ZINB-WaVE model. Using the ZINB-WaVE-learned parameters and after setting our additional framework parameters <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left({\sigma}_{\mu}^2=0.5,{\sigma}_{\pi}^2=0.5,r=1,\delta =-0.5\right) $$\end{document}</tex-math><mml:math id="M6" display="inline"><mml:mfenced close=")" open="(" separators=",,,"><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>&#x003bc;</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>&#x003c0;</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq3.gif"/></alternatives></inline-formula>, we then simulated the exact same number of cells as was in the original dataset. Upon performing dimensionality reduction and visualization of both simulated and measured cells simultaneously, we found cells clustered by cell type regardless of whether they were from the real or simulated dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S7-S9), confirming our simulation framework generates realistic datasets.</p><p id="Par16">scBFA consistently outperforms the count-based methods in classifying cell types precisely when the gene detection noise is less than the gene count noise <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left({\sigma}_{\pi}^2&#x0003c;{\sigma}_{\mu}^2\right) $$\end{document}</tex-math><mml:math id="M8" display="inline"><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>&#x003c0;</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&#x0003c;</mml:mo><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>&#x003bc;</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq4.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). This observation is robust to the choice of gene dispersion parameter <italic>r</italic> (Additional&#x000a0;file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figures S10-S11) and gene selection procedure (Fig. <xref rid="Fig4" ref-type="fig">4</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S12-S14). On real datasets, we found that scBFA performance increases as the gene detection rate decreases (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a), suggesting that in the real datasets for which GDR is low, the count noise may exceed the detection noise.
<fig id="Fig4"><label>Fig. 4</label><caption><p>scBFA outperforms quantification models when the gene detection noise is less than gene quantification noise. Rows represent different settings of (gene) detection noise (<inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sigma}_{\boldsymbol{\pi}}^2 $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq5.gif"/></alternatives></inline-formula>), and columns represent different settings of (gene) quantification noise (<inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sigma}_{\mu}^2 $$\end{document}</tex-math><mml:math id="M12" display="inline"><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>&#x003bc;</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq6.gif"/></alternatives></inline-formula>). The diagonal represents simulations where the detection noise is equal to the quantification noise (<inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sigma}_{\mu}^2={\sigma}_{\pi}^2 $$\end{document}</tex-math><mml:math id="M14" display="inline"><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>&#x003bc;</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>&#x003c0;</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq7.gif"/></alternatives></inline-formula>), and the plots above the diagonal represent simulations where the detection noise is less than the quantification noise. Each <italic>y</italic>-axis indicates the cross-validation performance (MCC) of cell type predictors trained on embeddings learned from the simulated data, while each <italic>x</italic>-axis represents the gene detection rate that is manipulated by the parameter <italic>&#x003b4;</italic>. Here, the ground truth embedding matrix is obtained by fitting ZINB-WaVE to the LPS benchmark under HVG selection. The dispersion parameter <italic>r</italic> is set to be 1 in these simulations.</p></caption><graphic xlink:href="13059_2019_1806_Fig4_HTML" id="MO4"/></fig></p></sec><sec id="Sec6"><title>scBFA mitigates technical and biological noise in noisy scRNA-seq data</title><p id="Par17">We next tested each method&#x02019;s ability to reduce the effect of technical variation on the learned low-dimensional embeddings by training them on an ERCC-based dataset [<xref ref-type="bibr" rid="CR29">29</xref>] with no variation due to biological factors. In this dataset, ERCC synthetic spike-in RNAs were diluted to a single concentration (1:10) and loaded into the 10&#x000d7; platform in place of biological cells during the generation of the GEMs. This dataset therefore consists of a single &#x0201c;cell type,&#x0201d; with only technical variation present (since the spike-in RNAs were diluted to the same concentration). Additional&#x000a0;file&#x000a0;1: Figure S15 illustrates that both scBFA and Binary PCA yield a low-dimensional embedding with minimal variation between &#x0201c;cells&#x0201d; compared to the other methods, suggesting that gene detection models are systematically more robust to technical noise compared to count models.</p><p id="Par18">We also found that modeling gene detection patterns helps to mitigate the effect of biological confounding factors in the scRNA-seq data. For example, a common data normalization step is to remove low-quality cells for which many reads map to mitochondrial genes, as these cells are suspected of undergoing apoptosis [<xref ref-type="bibr" rid="CR30">30</xref>]. However, finding a clear threshold for discarding cells based on mitochondrial RNA content is challenging (Additional&#x000a0;file&#x000a0;1: Figure S16). We found that low dimensional embeddings learned by count-based methods are clearly influenced by mitochondrial RNA content, but this is not true for scBFA (Additional&#x000a0;file&#x000a0;1: Figures S17-S18), suggesting that scBFA analysis of data will make the downstream analysis more robust to the inclusion of lower-quality cells.</p></sec><sec id="Sec7"><title>scBFA embedding space captures cell type-specific markers</title><p id="Par19">We further hypothesized that scBFA performs well at cell type classification in high-quantification noise data because detection pattern embeddings are purely driven by genes only detected in subsets of cells such as marker genes, while this is less true for count models. Marker genes should always be turned off in unrelated cell types and always be expressed at some measurable level in the relevant cells.</p><p id="Par20">To test our hypothesis, we measured the extent to which learned factor loadings capture established cell type markers on the PBMC, HSCs, and Pancreatic benchmarks, for which clear markers could be identified. For these 3 datasets, we identified 41, 43, and 73 markers, respectively, from the literature (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S3-S5). Gene selection reduced the marker sets further to 30, 24, and 43 markers for HVG and 20, 28, and 47 for HEG, respectively. Figure <xref rid="Fig5" ref-type="fig">5</xref> demonstrates that for these 3 datasets, the embeddings of scBFA are driven by cell type markers more than the quantification-based methods, despite the fact that the cell type markers are not used when learning the embeddings. These results also hold when HEG selection is used instead of HVG (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S19).
<fig id="Fig5"><label>Fig. 5</label><caption><p>scBFA is better informed by cell type markers than quantification models. Each latent factor learned from each method was evaluated based on how much influence established cell type markers exerted on its embeddings, as measured by the area under the curve (AUROC) metric. Each boxplot represents the AUROC of all latent factors for a given method and benchmark. ZINB-WaVE is represented twice, once for the latent dimensions inferred by their gene detection pattern (ZINB-WaVE<sub>dropout</sub>) and once for the latent dimensions inferred from the gene counts (ZINB-WaVE<sub>expr</sub>). <bold>a</bold> PBMC benchmark. <bold>b</bold> HSCs benchmark. <bold>c</bold> Pancreatic benchmark.</p></caption><graphic xlink:href="13059_2019_1806_Fig5_HTML" id="MO5"/></fig></p><p id="Par21">An important conceptual difference between scBFA and quantification-based methods, such as ZINB-WaVE, is that scBFA treats all zero-count measurements as true observations in which a specific gene is truly not expressed in a given cell. In contrast, ZINB-WaVE and others try to statistically distinguish dropout events from true zero-count measurements. As a result, the ZINB-WaVE model has a gene detection-specific feature matrix and gene count-specific feature matrix component, and we compared the performance of each component individually with respect to the cell type marker identification. Figure <xref rid="Fig5" ref-type="fig">5</xref> illustrates that scBFA factor loading matrix outperforms both components of ZINB-WaVE, suggesting the proportion of false-positive (undetected) zero-count measurements is relatively small and hard to infer statistically.</p></sec><sec id="Sec8"><title>Trajectory inference improves with detection modeling</title><p id="Par22">One of the most tantalizing applications of scRNA-seq is trajectory inference for identifying changes in the gene expression during continuous processes such as differentiation [<xref ref-type="bibr" rid="CR31">31</xref>]. There are on the order of at least 45 methods for trajectory inference [<xref ref-type="bibr" rid="CR32">32</xref>]. The first step to many trajectory inference methods is dimensionality reduction, of which PCA is a commonly used method [<xref ref-type="bibr" rid="CR31">31</xref>]. Using a recent benchmark of trajectory inference methods, we identified Slingshot, a top-performing method that uses dimensionality reduction [<xref ref-type="bibr" rid="CR33">33</xref>]. We evaluated Slingshot&#x02019;s performance on a set of 18 &#x0201c;gold standard&#x0201d; trajectory inference benchmarks after we replaced its PCA step with one of the dimensionality reduction methods we have benchmarked [<xref ref-type="bibr" rid="CR32">32</xref>]. We found that substituting scBFA in place of PCA led to a systematically higher performance compared to the other methods (ZINB-WaVE, PCA, scImpute, SAVER, scrna2019, sctransform, scVI) (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). These results are robust to the performance metric (Fig. <xref rid="Fig6" ref-type="fig">6</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S20).
<fig id="Fig6"><label>Fig. 6</label><caption><p>scBFA leads to the most improvement in trajectory inference performance of Slingshot. <bold>a</bold>&#x02013;<bold>c</bold> Slingshot was modified by replacing the PCA step of the original Slingshot method with each of the dimensionality reduction methods tested. The <italic>y</italic>-axis shows the distribution of the overall ranks (higher rank is better) of the modified versions of Slingshot. Methods were evaluated across 18 &#x0201c;gold standard&#x0201d; benchmarks and using 3 different performance metrics, F1<sub>milestone</sub>, NMSE<sub>lm</sub>, and F1<sub>branch</sub>, that measure how well the inferred trajectory matches the ground truth trajectory. F1<sub>milestone</sub> and F1<sub>branch</sub> are based on the quality of clustering of cells in the trajectory, while NMSE<sub>lm</sub> assesses how well the position of a cell in the inferred trajectory predicts the position of the cell in the ground truth trajectory. Across the three evaluation metrics and 18 benchmarks, scBFA yields better overall performance (rank). <bold>d</bold> A 2D scatter plot of scBFA&#x02019;s first two components, visualizing the inferred trajectory corresponding to the embryo development time in the H-embryos dataset.</p></caption><graphic xlink:href="13059_2019_1806_Fig6_HTML" id="MO6"/></fig></p></sec><sec id="Sec9"><title>Detection pattern models are also superior for scATAC-seq data analysis</title><p id="Par23">Several of the features of scRNA-seq protocols thought to drive technical noise are also shared among other single-cell genomic technologies, such as small starting material and amplification bias. We therefore reasoned that detection-based approaches, such as scBFA, are applicable to other types of single-cell genomic data. We measured the ability of scBFA to cluster cells into cell types using scATAC-seq datasets, which also typically produce highly sparse datasets. scATAC-seq datasets are not typically suitable for input into scRNA-seq analysis tools, because the largest values observed in scATAC-seq data correspond to the ploidy of the genome (e.g., two for humans). However, such sparse, small count data means that transformation into a detection pattern matrix suitable for input into a method such as scBFA will not significantly alter the input data, making scBFA potentially more generalizable than other scRNA-seq analysis tools.</p><p id="Par24">We performed dimensionality reduction and cell type classification experiments on several scATAC-seq datasets, analogous to our scRNA-seq analyses above. We benchmarked scBFA against PCA, Binary PCA, Scasat [<xref ref-type="bibr" rid="CR34">34</xref>], Destin [<xref ref-type="bibr" rid="CR35">35</xref>], scABC [<xref ref-type="bibr" rid="CR36">36</xref>], chromVAR [<xref ref-type="bibr" rid="CR37">37</xref>], and SCRAT [<xref ref-type="bibr" rid="CR38">38</xref>]. scBFA systematically outperformed all other methods in our benchmark datasets (Fig. <xref rid="Fig7" ref-type="fig">7</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S21-S24). An important advantage of scBFA over the other scATAC-seq methods is that only scBFA can systematically adjust for the cell-level covariates such as QC measurements (e.g., cell cycle stage) and batch effects. In contrast, other methods, such as Scasat, are unable to remove batch effect in all features since Scasat removes batch effects through removing batch-specific loci, which can be confounded with cell type-specific loci depending on the experimental design. Methods such as Binary PCA cannot directly regress out continuous covariates.
<fig id="Fig7"><label>Fig. 7</label><caption><p>scBFA more accurately recovers cell type identity in scATAC-seq datasets. Clustering accuracy (NMI) of each scATAC-seq method trained on a given benchmark, as a function of the number of latent dimensions specified. <bold>a</bold> GSE96769. <bold>b</bold> GSE74310. <bold>c</bold> GSE107816.</p></caption><graphic xlink:href="13059_2019_1806_Fig7_HTML" id="MO7"/></fig></p></sec><sec id="Sec10"><title>Detection pattern models can be trained efficiently</title><p id="Par25">The size of scRNA-seq datasets is regularly climbing to new scales each year [<xref ref-type="bibr" rid="CR2">2</xref>], as newer technologies increase the throughput of cells. With current datasets occasionally exceeding one million cells, computational efficiency of scRNA-seq analyses becomes challenging as ideally these tools could be run on local machines. We therefore benchmarked methods in terms of their speed of computation. In our comparisons, we also included a fast approximation of scBFA, which we term Binary PCA. Binary PCA is easy to implement in one line of R code (we simply transform the gene counts into the gene detection patterns as a preprocessing step before use of PCA) and provides immediate benefits over standard PCA and other methods with respect to cell type identification (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S25-S26). We found that Binary PCA is tied for the fastest of all methods, while scBFA is still faster than several competing count-based methods (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S27). More specifically, scBFA is a median of ten times faster than ZINB-WaVE. The difference in the execution time between scBFA and ZINB-WaVE is due primarily to the additional burden of modeling gene quantification because the scBFA model structure and parameter learning algorithm were designed to match the gene detection pattern component of ZINB-WaVE as closely as possible. This suggests that gene detection models may help analysis tools scale to larger datasets in the future.</p></sec></sec><sec id="Sec11"><title>Discussion</title><p id="Par26">Our primary result is that when the count (quantification) noise is relatively high in a dataset as is typical in larger datasets, the effects of this noise on the downstream analysis can be mitigated by modeling detection patterns instead of counts. The improvement in the performance of scBFA over ZINB-WaVE in this regime (Figs. <xref rid="Fig1" ref-type="fig">1</xref> and <xref rid="Fig3" ref-type="fig">3</xref>) is particularly informative because the ZINB-WaVE model has two components: one that models gene detection and the other that models gene counts (quantification). The model structure and parameter learning algorithm of scBFA are designed to match the gene detection component of ZINB-WaVE as closely as possible, making the difference in their performance primarily due to whether gene quantification (ZINB-WaVE) or gene detection (scBFA) is modeled.</p><p id="Par27">We show that as the number of cells sequenced increases within a dataset, the technical noise in the data (as measured indirectly by the gene detection rate and gene-wise dispersion) and the relative performance of scBFA generally increase as well. Because many scRNA-seq applications benefit from higher numbers of sequenced cells, there is a steep upward trend of scRNA-seq dataset sizes, with some recent datasets containing nearly a million cells [<xref ref-type="bibr" rid="CR2">2</xref>]. Our results therefore suggest that it is increasingly important that next-generation scRNA-seq analysis tools exploit the advantages of gene detection-only modeling in order to mitigate the effects of technical noise within the data. Also, given the influence of technology and protocol choice on technical noise in scRNA-seq data [<xref ref-type="bibr" rid="CR6">6</xref>], our results imply that future scRNA-seq tools could be designed to take advantage of the specific noise structure implied by different scRNA-seq protocols, as opposed to being relatively protocol-agnostic as they are today.</p><p id="Par28">While it is challenging to measure technical noise in real datasets, we show that the gene detection rate and gene-wise dispersion are easily calculated and serve as good proxies for measuring technical noise. In our results, we found that the performance of scBFA exceeds that of gene count analysis tools in cell type classification when the gene detection rate falls below 90%&#x000a0;and dispersion estimates are&#x000a0;high, therefore providing the community with a general guideline for when detection-based tools, such as scBFA, should be used instead of quantification-based tools. Our R package also has implemented a function, diagnose, to assist users in determining whether scBFA is appropriate for their data. Our results are also consistent with previous work that shows tasks, such as dimensionality reduction, cell type identification, and abundance estimation, can be performed successfully when individual cells are sequenced to shallow depth [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR21">21</xref>&#x02013;<xref ref-type="bibr" rid="CR23">23</xref>] and further provide a complementary analysis approach suitable for these datasets with low per-cell sequencing depth.</p><p id="Par29">There is a plethora of data normalization methods that have been, and continue to be, designed to decrease technical noise within and across cells, in order to better perform both gene detection and quantification, and to make these quantities comparable across cells (see [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR39">39</xref>, <xref ref-type="bibr" rid="CR40">40</xref>] for an overview). The challenge we address here is not mitigated by data normalization methods; however, as we argue that when the number of UMIs sequenced per cell decreases drastically, gene quantification information specifically is not present (or useable) in the data, which is a problem that data normalization cannot mitigate. Data normalization works complementarily to gene detection pattern analysis however, as illustrated by our use of data normalization before gene detection modeling in this work.</p><p id="Par30">Our results also imply that models that statistically distinguish dropout events from genes truly not expressed in a cell may be less fruitful for large datasets. Many gene count-based methods [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR41">41</xref>] model zero counts as a mixture of genes truly turned off (biological signal) and genes that are truly expressed but not detected due to technical artifacts from the experimental protocol (technical noise) [<xref ref-type="bibr" rid="CR41">41</xref>]. On the contrary, gene detection pattern methods, such as scBFA, treat all zeroes as a biological signal, a key feature motivated by the observation that zero measurements driven by technical noise tend to occur for genes that are poorly expressed [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. The superior performance of scBFA when the gene detection rate is low suggests that for these datasets, there is not enough information in the gene counts to reliably detect technical dropout events, and therefore, traditional mixture modeling can be unhelpful for high-throughput datasets where gene detection rates are low overall.</p><p id="Par31">The success of modeling gene detection patterns in scRNA-seq is not tied to a specific model structure. The performance improvement of scBFA over ZINB-WaVE, and Binary PCA over PCA, demonstrates our results hold across multiple model structures and loss functions. In both cases, not only do we observe performance gains for large scRNA-seq datasets, but there is also a substantial speed improvement because detection modeling avoids complex parametric modeling of gene counts, making detection models scalable to larger datasets. Within the class of gene detection-based models, Binary PCA provides a moderately accurate but much faster and simpler implementation scheme that can be achieved in one line of code, making our results readily achievable by the current analysis pipelines.</p><p id="Par32">A surprising finding was that HEG gene selection led to a systematically better cell type identification for every tested method in almost all datasets, compared to HVG selection (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). HVG selection anecdotally is the standard criterion upon which variable genes are typically selected during preprocessing [<xref ref-type="bibr" rid="CR42">42</xref>], suggesting at least for cell type identification, HEG selection may lead to improved performance regardless of the method used.</p><p id="Par33">While single-cell genomic data from different modalities, such as scATAC-seq, have similar data structure as scRNA-seq data, the analysis tools and pipelines developed to date for those two technologies are largely mutually exclusive. Here, we show that scBFA generalizes to other single-cell genomic modalities and outperforms the existing methods for cell type identification for scATAC-seq datasets as well, even those that take advantage of auxiliary data such as transcription factor motifs and distance to transcription start sites [<xref ref-type="bibr" rid="CR35">35</xref>]. We expect our results to generalize to other single-cell genomic modalities such as single-cell methylation or histone modification data.</p></sec><sec id="Sec12"><title>Methods</title><sec id="Sec13"><title>Single-cell binary factor analysis (scBFA) model</title><p id="Par34">scBFA is available as an R package on Bioconductor at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/devel/bioc/html/scBFA.html">https://bioconductor.org/packages/devel/bioc/html/scBFA.html</ext-link>, as well as on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/quon-titative-biology/scBFA">https://github.com/quon-titative-biology/scBFA</ext-link>). The main function to run scBFA is scBFA().</p><p id="Par35">In our notation below, matrices are represented by upper case bold letters, vectors by lower case bold letters, and numeric constants as upper case non-bold letters. Square brackets also indicate a matrix, though represented as a series of column vectors. A matrix subscript with round brackets indicates the index of the corresponding column vector.</p><p id="Par36">The schematic of our single-cell binary factor analysis (scBFA) model is shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S28. The input data to scBFA consists of two matrices, <bold><italic>O</italic></bold> and <bold><italic>X</italic></bold>. <bold><italic>O</italic></bold> is a matrix of counts, consisting of <italic>G</italic> features (genes in the case of scRNA-seq data, or loci in the case of scATAC-seq data) measured in each of <italic>N</italic> samples (cells). From the input data <bold><italic>O</italic></bold>, we compute a matrix <bold><italic>B</italic></bold>, where <italic>B</italic><sub><italic>ij</italic></sub> represents the detection pattern observed for cell <italic>i</italic>&#x000a0;(<italic>i</italic>&#x02009;=&#x02009;1,&#x02009;&#x02026;,&#x02009;<italic>N</italic>) and feature <italic>j</italic>&#x000a0;(<italic>j</italic>&#x02009;=&#x02009;1,&#x02009;&#x02026;,&#x02009;<italic>G</italic>). For scRNA-seq inputs, <italic>B</italic><sub><italic>ij</italic></sub>&#x02009;=&#x02009;1&#x000a0;when <italic>O</italic><sub><italic>ij</italic></sub>&#x02009;&#x02265;&#x02009;1, otherwise <italic>B</italic><sub><italic>ij</italic></sub>&#x02009;=&#x02009;0. Therefore, <italic>B</italic><sub><italic>ij</italic></sub>&#x02009;=&#x02009;1&#x000a0;indicates that at least one read (or UMI) maps to gene <italic>j</italic> in cell <italic>i</italic> and therefore suggests gene expression. Similarly, for scATAC-seq input data, <italic>B</italic><sub><italic>ij</italic></sub>&#x02009;=&#x02009;1&#x000a0;when <italic>O</italic><sub><italic>ij</italic></sub>&#x02009;&#x02265;&#x02009;1, in other words, when at least one read maps to locus <italic>j</italic> in cell <italic>i</italic> (and therefore suggests locus accessibility), otherwise <italic>B</italic><sub><italic>ij</italic></sub>&#x02009;=&#x02009;0. scBFA is adapted from a generalized linear model framework and is therefore capable of adjusting for batch effects and other nuisance cell-level covariates. Input <bold><italic>X</italic></bold>&#x02009;=&#x02009;[<bold><italic>x</italic></bold><sub><bold>1</bold></sub>,&#x02009;<bold><italic>x</italic></bold><sub><bold>2</bold></sub>,&#x02009;&#x02026;,&#x02009;<bold><italic>x</italic></bold><sub><bold><italic>N</italic></bold></sub>]<sup><bold><italic>T</italic></bold></sup> is a <italic>N</italic> &#x000d7; <italic>C</italic> cell-level covariate matrix that enables correction for <italic>C</italic> observed nuisance factors such as batch effects or other cell-specific quality control measurements. If there are no such cell-level covariates that need to be adjusted for, <bold><italic>X</italic></bold> is the null matrix by default.</p><p id="Par37">The intuition behind scBFA is that it performs dimensionality reduction to explain the high-dimensional detection pattern matrix <bold><italic>B</italic></bold> by estimating two lower-dimensional matrices: a <italic>N</italic> &#x000d7; <italic>K</italic> embedding matrix <bold><italic>Z</italic></bold> = [ <bold><italic>z</italic></bold><sub><bold>1</bold></sub>, <bold><italic>z</italic></bold><sub><bold>2</bold></sub>, &#x02026; , <bold><italic>z</italic></bold><sub><bold><italic>N</italic></bold></sub>]<sup><bold><italic>T</italic></bold></sup>,and a <italic>K</italic> &#x000d7; <italic>G</italic> loading matrix <bold><italic>A</italic></bold> = [<bold><italic>a</italic></bold><sub><bold>1</bold></sub>, <bold><italic>a</italic></bold><sub><bold>2</bold></sub>, &#x02026; , <bold><italic>a</italic></bold><sub>G</sub>]. Here, <italic>K</italic> is the number of latent dimensions used to approximate <bold><italic>B</italic></bold><sub><bold><italic>ij</italic></bold></sub>, where where <italic>K</italic> &#x0226a; <italic>G</italic>. <italic>u</italic><sub><italic>i</italic></sub> and <italic>v</italic><sub><italic>i</italic></sub> and represent the <italic>i</italic>th cell-level intercept and <italic>j</italic>th feature-specific intercept, respectively. <bold><italic>u</italic></bold>&#x000a0;is therefore a vector of length <italic>N</italic>, and <bold><italic>v</italic></bold>&#x000a0;is a vector of length <italic>G</italic>. For scRNA-seq, for example, we expect <bold><italic>u</italic></bold> and <bold><italic>v</italic></bold> will implicitly model the variation of gene expression caused by library size. <italic>&#x000b5;</italic><sub>ij</sub> is the mean of the Bernoulli distribution governing whether feature <italic>j</italic> is detected in cell <italic>i</italic> or not.</p><p id="Par38">Formally, scBFA is defined by the following model:
<disp-formula id="Equa"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{logit}\left({\mu}_{ij}\right)={\boldsymbol{x}}_{\boldsymbol{i}}^{\boldsymbol{T}}{\boldsymbol{\beta}}_{\boldsymbol{j}}+{\boldsymbol{z}}_{\boldsymbol{i}}^{\boldsymbol{T}}{\boldsymbol{a}}_{\boldsymbol{j}}+{u}_i+{v}_j $$\end{document}</tex-math><mml:math id="M16" display="block"><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:math><graphic xlink:href="13059_2019_1806_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equb"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ P\left(\boldsymbol{B};\boldsymbol{A},\boldsymbol{Z},\boldsymbol{\beta}, \boldsymbol{X},\boldsymbol{u},\boldsymbol{v}\right)=\prod \limits_{i,j}\mathrm{Bernoulli}\left({B}_{ij}|{\mu}_{ij},\boldsymbol{A},\boldsymbol{Z},\boldsymbol{\beta}, \boldsymbol{X},\boldsymbol{u},\boldsymbol{v}\right) $$\end{document}</tex-math><mml:math id="M18" display="block"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=";,,,,,"><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mtext>Bernoulli</mml:mtext><mml:mfenced close=")" open="(" separators="|,,,,,,"><mml:msub><mml:mi>B</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1806_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par39">We train the scBFA model by optimizing the following penalized likelihood function:
<disp-formula id="Equc"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ f\left(\boldsymbol{B},\boldsymbol{A},\boldsymbol{Z},\boldsymbol{\beta}, \boldsymbol{X},\boldsymbol{u},\boldsymbol{v}\right)=\left[{\sum}_{i,j}\ln\ P\left({B}_{ij};\boldsymbol{A},\boldsymbol{Z},\boldsymbol{\beta}, \boldsymbol{X},\boldsymbol{u},\boldsymbol{v}\right)\right]-{\epsilon}_1{\left\Vert \boldsymbol{A}\right\Vert}_2^2-{\upepsilon}_2{\left\Vert \boldsymbol{Z}\right\Vert}_2^2-{\upepsilon}_3{\left\Vert \boldsymbol{\beta} \right\Vert}_2^2 $$\end{document}</tex-math><mml:math id="M20" display="block"><mml:mi>f</mml:mi><mml:mfenced close=")" open="(" separators=",,,,,,"><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>ln</mml:mo><mml:mspace width="0.25em"/><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=";,,,,,"><mml:msub><mml:mi>B</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003f5;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mfenced close="&#x02016;" open="&#x02016;"><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mfenced><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x003f5;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msubsup><mml:mfenced close="&#x02016;" open="&#x02016;"><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mfenced><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x003f5;</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msubsup><mml:mfenced close="&#x02016;" open="&#x02016;"><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:mfenced><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math><graphic xlink:href="13059_2019_1806_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par40">Here, &#x003f5;<sub>1</sub>, <italic>&#x003f5;</italic><sub>2</sub>, and &#x003f5;<sub>3</sub> are the tunable parameters that control the regularization of the model parameters, where by default <inline-formula id="IEq8"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\upepsilon}_1=\frac{\epsilon_0}{G},{\epsilon}_2=\frac{\upepsilon_0}{N} $$\end{document}</tex-math><mml:math id="M22" display="inline"><mml:msub><mml:mi mathvariant="normal">&#x003f5;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>&#x003f5;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>G</mml:mi></mml:mfrac><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003f5;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi mathvariant="normal">&#x003f5;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>N</mml:mi></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq8.gif"/></alternatives></inline-formula>, <inline-formula id="IEq9"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\epsilon}_3=\frac{\epsilon_0}{G} $$\end{document}</tex-math><mml:math id="M24" display="inline"><mml:msub><mml:mi>&#x003f5;</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>&#x003f5;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>G</mml:mi></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq9.gif"/></alternatives></inline-formula>, and &#x003f5;<sub>0</sub>&#x02009;=&#x02009;max&#x02009;{<italic>N</italic>,&#x02009;<italic>G</italic>}. The optimization is carried out using the L-BFGS-B optimization routine available in the R optim() function. After completing the optimization, we orthogonalize <bold><italic>Z</italic></bold> and <bold><italic>A</italic></bold> using the orthogonalizeTraceNorm() function available in the ZINB-WaVE [<xref ref-type="bibr" rid="CR8">8</xref>] package.</p></sec><sec id="Sec14"><title>Binary PCA model and calculation of the gene detection pattern matrix</title><p id="Par41">Binary PCA describes our fast approximation to scBFA by simply running PCA, with the exception of converting the input count matrix into a detection matrix by converting non-zero values to one. We implemented Binary PCA through the addition of a single line of R code. Suppose that countMatrix is the name of the matrix in R that stores, for example, the UMI counts for each gene in each cell. To run Binary PCA, we first convert the countMatrix into the gene detection pattern matrix before running PCA via the R command:</p><p id="Par42">countMatrix[which(countMatrix&#x0003e;0)] &#x0003c;- 1</p><p id="Par43">We then call PCA using the following command in R:</p><p id="Par44">PCA_results &#x0003c;- prcomp(countMatrix, center=TRUE, scale.=FALSE);</p><p id="Par45">Note that typically, scale is set to TRUE when calling PCA. For Binary PCA, we set it to FALSE because the variance in gene detection is potentially associated with cell types (e.g., genes with higher detection variance are more likely to be marker genes, and therefore should contribute more to the embedding).</p></sec><sec id="Sec15"><title>Execution of scRNA-seq analysis methods</title><p id="Par46">We compared scBFA against scVI [<xref ref-type="bibr" rid="CR12">12</xref>], SAVER [<xref ref-type="bibr" rid="CR13">13</xref>], sctransform [<xref ref-type="bibr" rid="CR14">14</xref>], scrna2019 [<xref ref-type="bibr" rid="CR15">15</xref>], PCA, ZINB-WaVE [<xref ref-type="bibr" rid="CR8">8</xref>], and scImpute [<xref ref-type="bibr" rid="CR9">9</xref>]. These seven methods were selected to represent diverse classes of approaches to scRNA-seq data analysis, including dimensionality reduction methods (PCA, ZINB-WaVE, scVI), preprocessing approaches that can be applied before dimensionality reduction (sctransform, scrna2019), and imputation methods that can be applied before dimensionality reduction (SAVER, scImpute). Of the dimensionality reduction methods, PCA was chosen because of its implementation in popular packages such as Seurat [<xref ref-type="bibr" rid="CR42">42</xref>], and scVI [<xref ref-type="bibr" rid="CR12">12</xref>] is a leading deep learning-based dimensionality reduction method. ZINB-WaVE was chosen specifically because it is a recently developed method, and scBFA is designed as a gene detection-based analog of ZINB-WaVE; therefore, comparing scBFA with ZINB-WaVE is the fairest comparison of gene detection versus quantification-based approaches.</p><p id="Par47">We ran most of the scRNA-seq analysis methods with their default parameter settings, with the exception of scVI and scrna2019.</p><p id="Par48">scVI requires specification of a learning rate and the number of iterations before convergence. During training, we found that scVI performance was heavily influenced by these two parameters. We therefore performed an unbiased grid search by setting the number of iterations to be either 2000 or 4000 and setting the learning rate to be either 1e&#x02212;2, 1e&#x02212;3, or 1e&#x02212;4. We then trained the model with all 6 possible combinations of learning rate and number of iterations, and selected the combination of parameters that gave the lowest loss on the hold-out set. The loss value is provided by scVI during training. During training, the size of the training set is fixed to be 75% of the entire dataset, and the remaining parameters are fixed at their default values. We repeated the above parameter search for the same number of factors as the other methods for all scRNA-seq datasets. For the simulated datasets, given the large number of scenarios tested, we fixed the learning rate to be 0.001 and number of iterations to be 2000.</p><p id="Par49">scrna2019 is a method developed to perform feature selection and GLM-based factor analysis on scRNA-seq [<xref ref-type="bibr" rid="CR15">15</xref>]. The scrna2019 R package (obtained on May 6, 2019, from <ext-link ext-link-type="uri" xlink:href="https://github.com/willtownes/scrna2019">https://github.com/willtownes/scrna2019</ext-link>) offers both a GLM factor analysis model and a corresponding deviance score approximation. We used the deviance score approximation instead of the GLM framework for our experiments because several benchmarks required batch effect correction, which should be addressed using the deviance score approximation as per scrna2019&#x02019;s authors&#x02019; recommendations [<xref ref-type="bibr" rid="CR15">15</xref>]. Also, at the time of the writing of this paper, the GLM implementation produced errors for three of our datasets that prevented us from completing our experiments.</p></sec><sec id="Sec16"><title>Execution of scATAC-seq analysis methods</title><p id="Par50">We compared scBFA against PCA, Binary PCA, Scasat [<xref ref-type="bibr" rid="CR34">34</xref>], Destin [<xref ref-type="bibr" rid="CR35">35</xref>], scABC [<xref ref-type="bibr" rid="CR36">36</xref>], chromVAR [<xref ref-type="bibr" rid="CR37">37</xref>], and SCRAT [<xref ref-type="bibr" rid="CR38">38</xref>]. Scasat and Destin are scATAC-seq analysis tools primarily designed to identify cell types and differential accessibility analysis. Both methods treat dimensionality reduction as a prior step before further clustering distinct cell types. Scasat&#x02019;s embedding space is learned by performing multidimensional scaling (MDS) on a cell-cell Jaccard similarity matrix computed from a binarized chromatin accessibility matrix. Destin developed a weighted principal component analysis approach using distance to transcription start sites and reference regulomic data. scABC is an unsupervised clustering tool of single-cell epigenetic data and performs multi-stage clustering based on the input chromatin accessibility matrix directly. chromVAR aggregates motif position weight matrices (PWM) and chromatin accessibility to uncover cell populations and identify motifs associated with cell type-specific variation. SCRAT summarizes several distinct regulatory genomic data (including prior established gene sets and transcription factor binding motif sites, among others) to identify distinct cell populations from single-cell genomic data.</p><p id="Par51">For SCRAT, we used the regulatory activity feature list provided by SCRATsummary() as the default input features. In addition, we also input the BED files corresponding to the scATAC-seq data as a custom feature as suggested by the SCRAT authors [<xref ref-type="bibr" rid="CR38">38</xref>], which we found to improve the performance.</p></sec><sec id="Sec17"><title>Quantifying the effect of imputation on scBFA</title><p id="Par52">We compared the performance of scBFA before and after imputation on our 14 benchmark datasets under HVG selection. We tested two state-of-the-art imputation methods, SAVER [<xref ref-type="bibr" rid="CR13">13</xref>] and scImpute [<xref ref-type="bibr" rid="CR9">9</xref>]. SAVER estimates library size-normalized posterior means of gene expression levels (<inline-formula id="IEq10"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{\lambda}}_{ij} $$\end{document}</tex-math><mml:math id="M26" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>&#x003bb;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq10.gif"/></alternatives></inline-formula>), which are inappropriate for input into scBFA because they are not sparse. We therefore sampled counts from SAVER&#x02019;s generative model as follows:
<disp-formula id="Equd"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {O}_{ij}\sim \mathrm{Poisson}\left({s}_i{\hat{\lambda}}_{ij}\right) $$\end{document}</tex-math><mml:math id="M28" display="block"><mml:msub><mml:mi>O</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mtext>Poisson</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>&#x003bb;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1806_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq11"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{\lambda}}_{ij} $$\end{document}</tex-math><mml:math id="M30" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>&#x003bb;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq11.gif"/></alternatives></inline-formula> is SAVER&#x02019;s imputed expression level and&#x000a0;<italic>s</italic><sub><italic>i</italic></sub> is the library size for cell <italic>i</italic> divided by the mean library size across cells [<xref ref-type="bibr" rid="CR13">13</xref>]. We generated five separate count matrices <italic>O</italic><sub><italic>ij</italic></sub> based on the SAVER estimates <inline-formula id="IEq12"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{\lambda}}_{ij} $$\end{document}</tex-math><mml:math id="M32" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>&#x003bb;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq12.gif"/></alternatives></inline-formula>. For scImpute, we used its imputed gene counts matrix directly as input for scBFA.</p></sec><sec id="Sec18"><title>Selection of representative datasets to measure gene detection rates</title><p id="Par54">We obtained a total of 36 scRNA-seq datasets from which we calculated gene detection rates as a function of the number of cells in each dataset (Additional&#x000a0;file&#x000a0;1: Figure S1). We obtained these datasets from two sources, the conquer database [<xref ref-type="bibr" rid="CR43">43</xref>] and the Gene Expression Omnibus (GEO) [<xref ref-type="bibr" rid="CR44">44</xref>]. For GEO, we used the search term &#x0201c;((&#x02018;single cell rna-seq&#x02019; OR &#x02018;single cell transcriptomic&#x02019; OR &#x02018;10X&#x02019; OR &#x02018;single cell transcriptome&#x02019;) AND Expression profiling by high throughput sequencing[DataSet Type]) AND (Homo sapiens[Organism] OR Mus musculus[Organism]),&#x0201d; sorted all datasets by size, then selected a similar number of datasets from both the top and bottom of the list (Additional&#x000a0;file&#x000a0;1: Table S7).</p></sec><sec id="Sec19"><title>Computing mean and dispersion curves</title><p id="Par55">We use the DESeq2 [<xref ref-type="bibr" rid="CR28">28</xref>] package to obtain gene-specific dispersion estimates for each dataset, where dispersion is measured across all cells in a dataset. Within the DESeq2 pipeline, gene-wise dispersions are first estimated, a trend line is fit to the gene-wise dispersion estimates, and finally, shrinkage is applied to the gene-wise dispersion estimates (MAP estimates). In Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, we extracted the fitted gene-wise dispersion estimates from the trend line (second step), and we fit these dispersion estimates by local linear regression (LOESS) using the gene-wise mean of transcripts per million (TPM) across all cells as the explanatory variable. To address the border effect of LOESS, we removed the top and bottom 2.5% of genes as ranked by TPM. Note that using the MAP dispersion estimates (final DESeq2 step) or the fitted dispersion estimates from the trended fit (second step) does not materially change our conclusion. The exception is for the dataset PBMC where there are 455 genes with its MAP dispersion estimates staying at their initialized value of 1e&#x02212;8 during optimization, while their fitted dispersion estimates are substantially different. We therefore chose the fitted dispersion estimates to generate Fig. <xref rid="Fig3" ref-type="fig">3</xref>b.</p></sec><sec id="Sec20"><title>Benchmarking dimensionality reduction methods for scRNA-seq</title><p id="Par56">We evaluated each dimensionality reduction method by how well their low dimensional embeddings discriminate experimentally defined cell types. For each dataset and method tested, we first performed dimensionality reduction on the entire dataset to obtain an embedding matrix representing each cell in <italic>K</italic> dimensions (the matrix <bold><italic>Z</italic></bold> described in the scBFA methods section). We then performed fivefold cross-validation in which we trained a non-regularized multi-level logistic classifier on the training embeddings from each method using the a priori known cell type labels, then used the model to predict cell type labels for the test embeddings. For every prediction, using the known cell type labels, we computed a confusion matrix and the corresponding Matthews&#x02019; correlation coefficient (MCC) as a measure of classification accuracy. MCC was calculated using the R package mltools. We repeated the fivefold cross-validation a total of 15 times and reported the mean classification accuracy as the final accuracy.
<disp-formula id="Eque"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{MCC}=\frac{\mathrm{TP}\times \mathrm{TN}-\mathrm{FP}\times \mathrm{FN}}{\sqrt{\Big(\mathrm{TP}+\mathrm{FP}}\left)\sqrt{\Big(\mathrm{TP}+\mathrm{FN}}\right)\sqrt{\Big(\mathrm{TN}+\mathrm{FP}}\left)\ \sqrt{\Big(\mathrm{TN}+\mathrm{FN}}\right)\ } $$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mi>MCC</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>TP</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>TN</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>FP</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>FN</mml:mi></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>TP</mml:mi><mml:mo>+</mml:mo><mml:mi>FP</mml:mi></mml:mrow></mml:msqrt><mml:mo stretchy="true">)</mml:mo><mml:msqrt><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>TP</mml:mi><mml:mo>+</mml:mo><mml:mi>FN</mml:mi></mml:mrow></mml:msqrt><mml:mo stretchy="true">)</mml:mo><mml:msqrt><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>TN</mml:mi><mml:mo>+</mml:mo><mml:mi>FP</mml:mi></mml:mrow></mml:msqrt><mml:mo stretchy="true">)</mml:mo><mml:mspace width="0.25em"/><mml:msqrt><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>TN</mml:mi><mml:mo>+</mml:mo><mml:mi>FN</mml:mi></mml:mrow></mml:msqrt><mml:mo stretchy="true">)</mml:mo><mml:mspace width="0.25em"/></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2019_1806_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par57">In our analysis of the ERCC dataset, we used a different evaluation metric because each &#x0201c;cell&#x0201d; represents technical replicates of the spiked-in RNA diluted at a constant ratio (10:1). Under the assumption that the only variation between &#x0201c;cells&#x0201d; is due to technical factors, we therefore used averaged within-group sum of squares (AWSS) to measure how the low-dimensional embedding learned by each method captured such homogeneity. Given an <italic>N</italic> by <italic>K</italic> embedding matrix <italic>Z</italic>, AWSS was calculated as follows:
<disp-formula id="Equf"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{c}W=\left(Z-\overline{Z}\right)\ \\ {}\mathrm{AWSS}=\frac{\mathrm{trace}\left({W}^TW\right)}{N-1}\\ {}\kern1.75em \end{array}} $$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>Z</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mtext>AWSS</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>trace</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>W</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mspace width="1.75em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1806_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par58">Here, <inline-formula id="IEq13"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overline{Z} $$\end{document}</tex-math><mml:math id="M38" display="inline"><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq13.gif"/></alternatives></inline-formula> is an <italic>N</italic> by <italic>K</italic> matrix for which every row is the column mean of <italic>Z</italic>.</p></sec><sec id="Sec21"><title>Benchmarking cell type identification methods for scATAC-seq</title><p id="Par59">We benchmarked scBFA against existing scATAC-seq analysis tools by evaluating their ability to correctly cluster cell types. We used a different evaluation scheme from that used for the scRNA-seq experiments because one of the existing methods (scABC) does not produce low-dimensional embeddings and instead outputs cluster labels. The methods Scasat and Destin both provide cluster labels directly from their analysis pipeline. For scBFA, PCA, Binary PCA, chromVAR, and SCRAT, we clustered cells based on the learned embedding matrices using R&#x02019;s built-in hierarchical clustering function hclust() with Wald&#x02019;s distance. We compared the accuracy of the clustering results from each method using the metrics normalized mutual information (NMI) and Adjusted Rand Index (ARI), computed using the R package aricode.</p></sec><sec id="Sec22"><title>Simulation of scRNA-seq data</title><p id="Par60">A variation of the ZINB-WaVE model was used to simulate scRNA-seq datasets and is defined as follows (Additional&#x000a0;file&#x000a0;1: Figure S29):
<disp-formula id="Equg"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{z}}_{\boldsymbol{\mu} \left(\boldsymbol{i}\right)}\sim N\left({\hat{\boldsymbol{z}}}_i,{\sigma}_{\mu}^2{\boldsymbol{I}}_{\boldsymbol{K}}\right) $$\end{document}</tex-math><mml:math id="M40" display="block"><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mfenced></mml:mrow></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>&#x003bc;</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mi mathvariant="bold-italic">K</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1806_Article_Equg.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equh"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{z}}_{\boldsymbol{\pi} \left(\boldsymbol{i}\right)}\sim N\left({\hat{\boldsymbol{z}}}_{\boldsymbol{i}},{\sigma}_{\boldsymbol{\pi}}^2{\boldsymbol{I}}_{\boldsymbol{K}}\right) $$\end{document}</tex-math><mml:math id="M42" display="block"><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mfenced></mml:mrow></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mi mathvariant="bold-italic">K</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1806_Article_Equh.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equi"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{logit}\left({\pi}_{ij}\right)=\left({\boldsymbol{z}}_{\boldsymbol{\pi} \left(\boldsymbol{i}\right)}^{\boldsymbol{T}}{\hat{\boldsymbol{a}}}_{\boldsymbol{\pi} \left(\boldsymbol{j}\right)}+{\hat{u}}_{\pi (i)}+{\hat{v}}_{\pi (j)}-\delta \right) $$\end{document}</tex-math><mml:math id="M44" display="block"><mml:mtext>logit</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mfenced></mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mfenced></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mrow><mml:mi>&#x003c0;</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mrow><mml:mi>&#x003c0;</mml:mi><mml:mfenced close=")" open="("><mml:mi>j</mml:mi></mml:mfenced></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003b4;</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1806_Article_Equi.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equj"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \log \left({\mu}_{ij}\right)=\left({\boldsymbol{z}}_{\boldsymbol{\mu} \left(\boldsymbol{i}\right)}^{\boldsymbol{T}}{\hat{\boldsymbol{a}}}_{\boldsymbol{\mu} \left(\boldsymbol{j}\right)}+{\hat{\mu}}_{\mu (i)}+{\hat{v}}_{\mu (j)}\right) $$\end{document}</tex-math><mml:math id="M46" display="block"><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mfenced></mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mfenced></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mrow><mml:mi>&#x003bc;</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mrow><mml:mi>&#x003bc;</mml:mi><mml:mfenced close=")" open="("><mml:mi>j</mml:mi></mml:mfenced></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1806_Article_Equj.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par61">&#x003a0;<sub><italic>ij</italic></sub>&#x02009;&#x0223c;&#x02009;Bernoulli(<italic>&#x003c0;</italic><sub><italic>ij</italic></sub>)
<disp-formula id="Equk"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {O}_{ij}\left\{\begin{array}{c}=0\kern6em \mathrm{if}\ {\Pi}_{ij}=1\\ {}\sim \mathrm{NB}\left({\mu}_{ij},r\right)\kern2.25em \mathrm{if}\ {\Pi}_{ij}=0\end{array}\right. $$\end{document}</tex-math><mml:math id="M48" display="block"><mml:msub><mml:mi>O</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mfenced close="" open="{"><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="6em"/><mml:mtext>if</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="normal">&#x003a0;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mo>&#x0223c;</mml:mo><mml:mi>NB</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mi>r</mml:mi></mml:mfenced><mml:mspace width="2.25em"/><mml:mtext>if</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="normal">&#x003a0;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1806_Article_Equk.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par62">To keep the consistency of the notation, the parameters we used above <inline-formula id="IEq14"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\{\hat{\boldsymbol{Z}},{\hat{\boldsymbol{A}}}_{\boldsymbol{\mu}},{\hat{\boldsymbol{A}}}_{\boldsymbol{\pi}},{\hat{\boldsymbol{u}}}_{\boldsymbol{\mu}},{\hat{\boldsymbol{u}}}_{\boldsymbol{\pi}},{\hat{\boldsymbol{v}}}_{\boldsymbol{\mu}},{\hat{\boldsymbol{v}}}_{\boldsymbol{\pi}}\right\} $$\end{document}</tex-math><mml:math id="M50" display="inline"><mml:mfenced close="}" open="{" separators=",,,,,,"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq14.gif"/></alternatives></inline-formula> respectively correspond to the parameters <inline-formula id="IEq15"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\{\hat{\boldsymbol{W}},{\hat{\boldsymbol{\alpha}}}_{\boldsymbol{\mu}},{\hat{\boldsymbol{\alpha}}}_{\boldsymbol{\pi}},{\hat{\boldsymbol{\gamma}}}_{\boldsymbol{\pi}},{\hat{\boldsymbol{\gamma}}}_{\boldsymbol{\mu}},{\hat{\boldsymbol{\beta}}}_{\boldsymbol{\mu}},{\hat{\boldsymbol{\beta}}}_{\boldsymbol{\pi}}\right\} $$\end{document}</tex-math><mml:math id="M52" display="inline"><mml:mfenced close="}" open="{" separators=",,,,,,"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq15.gif"/></alternatives></inline-formula> used in the original ZINB-WaVE paper. In the first step of our simulations, all parameters with a hat accent are set a priori by fitting the ZINB-WaVE model using its R package [<xref ref-type="bibr" rid="CR8">8</xref>] on a single scRNA-seq dataset in order to use realistic parameters for our simulation. The remaining parameters <inline-formula id="IEq16"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\{\delta, {\sigma}_{\mu}^2,{\sigma}_{\boldsymbol{\pi}}^2,r\right\} $$\end{document}</tex-math><mml:math id="M54" display="inline"><mml:mfenced close="}" open="{" separators=",,,"><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>&#x003bc;</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mi>r</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq16.gif"/></alternatives></inline-formula> are then systematically varied in our simulations to determine their effect on downstream dimensionality reduction methods.&#x000a0;<italic>O</italic><sub><italic>ij</italic></sub>&#x000a0;denotes the gene counts for cell <italic>i</italic>&#x000a0;and feature <italic>j</italic>. As is described in the original ZINB-WaVE paper, <inline-formula id="IEq17"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{\boldsymbol{Z}} = {\left[{\hat{\boldsymbol{z}}}_{\mathbf{1}},{\hat{\boldsymbol{z}}}_{\mathbf{2}},\dots, {\hat{\boldsymbol{z}}}_{\boldsymbol{N}}\right]}^{\boldsymbol{T}} $$\end{document}</tex-math><mml:math id="M56" display="inline"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mspace width="0.25em"/></mml:mrow><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mfenced close="]" open="[" separators=",,,"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mn mathvariant="bold">1</mml:mn></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mn mathvariant="bold">2</mml:mn></mml:msub><mml:mo>&#x02026;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">N</mml:mi></mml:msub></mml:mfenced><mml:mi mathvariant="bold-italic">T</mml:mi></mml:msup><mml:mspace width="0.25em"/></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq17.gif"/></alternatives></inline-formula>is a <italic>N</italic>&#x02009;&#x000d7;&#x02009;<italic>K</italic> embedding matrix, while <inline-formula id="IEq18"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{\boldsymbol{A}}}_{\boldsymbol{\mu}}=\left[{\hat{\boldsymbol{a}}}_{\boldsymbol{\mu} \left(\mathbf{1}\right)},{\hat{\boldsymbol{a}}}_{\boldsymbol{\mu} \left(\mathbf{2}\right)},\dots, {\hat{\boldsymbol{a}}}_{\boldsymbol{\mu} \left(\boldsymbol{G}\right)}\right] $$\end{document}</tex-math><mml:math id="M58" display="inline"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators=",,,"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi><mml:mfenced close=")" open="("><mml:mn mathvariant="bold">1</mml:mn></mml:mfenced></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi><mml:mfenced close=")" open="("><mml:mn mathvariant="bold">2</mml:mn></mml:mfenced></mml:mrow></mml:msub><mml:mo>&#x02026;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mfenced></mml:mrow></mml:msub></mml:mfenced><mml:mspace width="0.25em"/></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq18.gif"/></alternatives></inline-formula> and <inline-formula id="IEq19"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{\boldsymbol{A}}}_{\boldsymbol{\pi}}=\left[{\hat{\boldsymbol{a}}}_{\boldsymbol{\pi} \left(\mathbf{1}\right)},{\hat{\boldsymbol{a}}}_{\boldsymbol{\pi} \left(\mathbf{2}\right)},\dots, {\hat{\boldsymbol{a}}}_{\boldsymbol{\pi} \left(\boldsymbol{G}\right)}\right] $$\end{document}</tex-math><mml:math id="M60" display="inline"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators=",,,"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mfenced close=")" open="("><mml:mn mathvariant="bold">1</mml:mn></mml:mfenced></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mfenced close=")" open="("><mml:mn mathvariant="bold">2</mml:mn></mml:mfenced></mml:mrow></mml:msub><mml:mo>&#x02026;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mfenced></mml:mrow></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq19.gif"/></alternatives></inline-formula> are the corresponding <italic>K</italic>&#x02009;&#x000d7;&#x02009;<italic>G</italic> regression coefficient matrices for the negative binomial and Bernoulli distributions governing the gene count and detection components, respectively. The output of the Bernoulli distribution is the latent variable &#x003a0;<sub><italic>ij</italic></sub>, which decides whether a gene is detected (in which case the observed value <italic>O</italic><sub><italic>ij</italic></sub> is sampled from a negative binomial distribution), or not detected. <inline-formula id="IEq20"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{\boldsymbol{u}}}_{\boldsymbol{\mu}} $$\end{document}</tex-math><mml:math id="M62" display="inline"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq20.gif"/></alternatives></inline-formula> and <inline-formula id="IEq21"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{\boldsymbol{u}}}_{\boldsymbol{\pi}} $$\end{document}</tex-math><mml:math id="M64" display="inline"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq21.gif"/></alternatives></inline-formula> are <italic>N</italic>&#x02009;&#x000d7;&#x02009;1 cell-specific intercepts for the count matrix and detection matrix, respectively. Similarly, <inline-formula id="IEq22"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{\boldsymbol{v}}}_{\boldsymbol{\mu}} $$\end{document}</tex-math><mml:math id="M66" display="inline"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq22.gif"/></alternatives></inline-formula> and <inline-formula id="IEq23"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{\boldsymbol{v}}}_{\boldsymbol{\pi}} $$\end{document}</tex-math><mml:math id="M68" display="inline"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq23.gif"/></alternatives></inline-formula> are <italic>G</italic>&#x02009;&#x000d7;&#x02009;1 gene-specific intercepts for the count matrix and detection matrix, respectively. The number of latent dimensions <italic>K</italic> used to generate the gene expression values was fixed at 5, and we used a total of 2000 highly variable genes as in the original dataset. The LPS dataset does not provide any cell-level covariates, so in these simulations, there are no cell- or gene-wise covariate matrices. For quality control purposes, we filtered out genes that are expressed in fewer than 1% of the cells and then filtered out cells in which less than 1% of genes are expressed.</p><p id="Par63">The distinction between our simulation framework and ZINB-WaVE is that ZINB-WaVE maintains the same cell embedding space <inline-formula id="IEq24"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{\boldsymbol{Z}} $$\end{document}</tex-math><mml:math id="M70" display="inline"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq24.gif"/></alternatives></inline-formula> across both the gene detection and count spaces. In contrast, our framework relaxes this constraint by introducing individual embeddings <bold><italic>Z</italic></bold><sub><bold><italic>&#x003c0;</italic></bold></sub> and <bold><italic>Z</italic></bold><sub><bold><italic>&#x003bc;</italic></bold></sub> that are close to <inline-formula id="IEq25"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{\boldsymbol{Z}} $$\end{document}</tex-math><mml:math id="M72" display="inline"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq25.gif"/></alternatives></inline-formula>. Formally, <bold><italic>Z</italic></bold><sub><bold><italic>&#x003c0;</italic></bold></sub> and <bold><italic>Z</italic></bold><sub><bold><italic>&#x003bc;</italic></bold></sub>&#x000a0;are <italic>N</italic>&#x02009;&#x000d7;&#x02009;<italic>K</italic> embedding matrices for the gene detection and count spaces, respectively. Each row <italic>i</italic> of <bold><italic>Z</italic></bold><sub><bold><italic>&#x003c0;</italic></bold></sub>&#x000a0;and <bold><italic>Z</italic></bold><sub><bold><italic>&#x003c0;</italic></bold></sub> are sampled from respective <italic>K</italic>-multivariate Gaussian distributions with the same mean defined by <inline-formula id="IEq26"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{\boldsymbol{z}}}_i $$\end{document}</tex-math><mml:math id="M74" display="inline"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq26.gif"/></alternatives></inline-formula> and spherical variance parameters <inline-formula id="IEq27"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sigma}_{\boldsymbol{\pi}}^2 $$\end{document}</tex-math><mml:math id="M76" display="inline"><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq27.gif"/></alternatives></inline-formula> and <inline-formula id="IEq28"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sigma}_{\mu}^2 $$\end{document}</tex-math><mml:math id="M78" display="inline"><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>&#x003bc;</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq28.gif"/></alternatives></inline-formula>, respectively.</p><p id="Par64">In our simulations, we varied the simulation parameters <inline-formula id="IEq29"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\{\delta, {\sigma}_{\mu}^2,{\sigma}_{\boldsymbol{\pi}}^2,r\right\} $$\end{document}</tex-math><mml:math id="M80" display="inline"><mml:mfenced close="}" open="{" separators=",,,"><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>&#x003bc;</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mi>r</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq29.gif"/></alternatives></inline-formula> as follows. To influence the total number of gene counts detected (total detection rate), we set <italic>&#x003b4;</italic>&#x02009;&#x02208;&#x02009;{&#x02212;2,&#x02009;&#x02212;0.5,&#x02009;1,&#x02009;2.5,&#x02009;4}. To influence the variance in the gene detection and count embedding spaces, we set <inline-formula id="IEq30"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sigma}_{\pi}^2,{\sigma}_{\mu}^2\in \left\{0.1,0.5,1,2,3\right\} $$\end{document}</tex-math><mml:math id="M82" display="inline"><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>&#x003c0;</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>&#x003bc;</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&#x02208;</mml:mo><mml:mfenced close="}" open="{" separators=",,,,"><mml:mn>0.1</mml:mn><mml:mn>0.5</mml:mn><mml:mn>1</mml:mn><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq30.gif"/></alternatives></inline-formula>. Finally, we varied the common gene dispersion parameter <italic>r</italic>&#x02009;&#x02208;&#x02009;{0.5,1,&#x02009;5}. In total, the number of unique parameter settings we used to simulate scRNA-seq data is 5&#x02009;&#x000d7;&#x02009;5&#x02009;&#x000d7;&#x02009;5&#x02009;&#x000d7;&#x02009;3&#x02009;=&#x02009;375. For each of those scenarios, we simulated 3 replicates, resulted in 375&#x02009;&#x000d7;&#x02009;3&#x02009;=&#x02009;1125 datasets.</p></sec><sec id="Sec23"><title>Quality control of scRNA-seq data</title><p id="Par65">For each scRNA-seq dataset tested, we performed a standardized quality control process. We first removed cells for which mitochondrial genes accounted for over 50% of the total observed counts. Then, we filtered out genes that are expressed in fewer than 1% of cells and removed cells whose library size (total read or UMI count) was less than one-eighth quantile of all cell library sizes. One exception is the MEM-T cell dataset, where we removed an extra 361 cells from the batch labeled &#x0201c;subject16&#x0201d; to remove batches that were confounded with cell types.</p></sec><sec id="Sec24"><title>Preprocessing of scATAC-seq data</title><p id="Par66">We followed the scATAC-seq pipeline for processing and aligning reads used by the Destin method [<xref ref-type="bibr" rid="CR35">35</xref>], obtained from GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/urrutiag/destin">https://github.com/urrutiag/destin</ext-link> on April 22, 2019. This preprocessing pipeline yielded 2779, 576, and 960 BAM files for GSE96769 [<xref ref-type="bibr" rid="CR45">45</xref>], GSE74310 [<xref ref-type="bibr" rid="CR46">46</xref>], and GSE107816 [<xref ref-type="bibr" rid="CR47">47</xref>], respectively. These BAM files form the initial input of Destin, scABC, and SCRAT. The input chromatin accessibility matrix for chromVAR and Scasat was then obtained from Destin&#x02019;s preprocessing pipeline directly.</p><p id="Par67">For GSE96769, we only kept cells and genomic loci that are used in the original paper&#x02019;s analysis. The indices for genome loci and cells that passed quality control are supplied in the supplementary files of the original paper. Beyond that, we selected a subset of frozen cells from five patients, excluding patient BM0106, and a subset of pDC cells from patient BM1137 to keep as many samples as possible while removing the part of the batches confounded with cell types. This enabled us to construct a design matrix to correct for patient-specific effects. We furthermore excluded cells that are labeled as unknown by the original author.</p><p id="Par68">For each scATAC-seq dataset tested, we only kept genomic loci that are accessible in at least 1% of cells and then removed cells with a total number of accessible sites that deviates more than 3 standard errors to the mean (in either direction) across all cells. The number of retained cells used as input in our downstream analysis was 1358 for GSE96769, 572 for GSE74310, and 929 for GSE108716. We found that SCRAT and chromVAR&#x02019;s preprocessing pipeline generated NA values, and so for these tools, we filtered out additional cells. For SCRAT, this yielded 1375 cells for GSE96769, 534 cells for GSE74310, and 815 cells for GSE108716. For chromVAR, this yielded 1358 cells for GSE96769, 529 cells for GSE74310, and 811 cells for GSE108716.</p></sec><sec id="Sec25"><title>Defining cell type labels in benchmark datasets</title><p id="Par69">Most benchmark datasets used in our analyses were selected because the cell types were already defined in the original study by either known experimental condition or via cell surface markers. However, for the PBMC dataset, Stoeckius et al. [<xref ref-type="bibr" rid="CR48">48</xref>] collected single-cell antibody-derived tag (ADT) data as well as scRNA-seq using CITE-seq [<xref ref-type="bibr" rid="CR48">48</xref>]. ADTs can be viewed as a digital readout of cell surface protein abundance. We defined the cell types within this dataset by performing Louvain clustering on the Jaccard similarity matrix constructed based on the normalized ADT levels, similar to Stoeckius et al. [<xref ref-type="bibr" rid="CR48">48</xref>]. Louvain clustering was performed using the &#x0201c;cluster_louvain&#x0201d; function implemented in the igraph R package. Clustering identified 10 cell types automatically. Note that the quality control standard for this dataset is different compared to the other scRNA-seq datasets used in our analysis, as cells were required to pass both scRNA-seq-specific filters (minimum of 800 reads) and ADT-specific filters (minimum of 50 ADT counts).</p></sec><sec id="Sec26"><title>Normalization of scRNA-seq data</title><p id="Par70">For each method, we also normalized cells to control for differences in library size. For PCA, we normalize the counts by setting <inline-formula id="IEq31"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overset{\sim }{O}}_{ij}=\log \left(\frac{O_{ij}}{c_i}+1\right) $$\end{document}</tex-math><mml:math id="M84" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>O</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:msub><mml:mi>O</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq31.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq32"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overset{\sim }{O}}_{ij} $$\end{document}</tex-math><mml:math id="M86" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>O</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq32.gif"/></alternatives></inline-formula> is the normalized gene count for cell <italic>i</italic> and gene <italic>j</italic>, <italic>O</italic><sub><italic>ij</italic></sub>&#x000a0;is the original gene count for cell <italic>i</italic> and gene <italic>j</italic>, and <inline-formula id="IEq33"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {c}_i={\sum}_j{O}_{ij} $$\end{document}</tex-math><mml:math id="M88" display="inline"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>O</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq33.gif"/></alternatives></inline-formula> is library size for cell <italic>i</italic>. ZINB-WaVE directly accounts for library size via their cell-specific intercept. For scImpute, we used the total number of imputed counts per cell as their corresponding library size and normalized in the same way as PCA. For scBFA, we estimated the feature-specific intercepts and cell-specific intercepts to implicitly model the effect of library size. SAVER uses the library size divided by the median library size across all cells to adjust for cell size. sctransform uses the log of the library size in its model. scrna2019 outputs a transformed deviance score matrix that does not depend on library size as input.</p></sec><sec id="Sec27"><title>Normalization of scATAC-seq data</title><p id="Par71">For PCA, we performed a log transformation <inline-formula id="IEq34"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overset{\sim }{O}}_{ij}=\log \left({O}_{ij}+1\right) $$\end{document}</tex-math><mml:math id="M90" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>O</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq34.gif"/></alternatives></inline-formula> to adjust the counts within scATAC-seq, where <italic>O</italic><sub><italic>ij</italic></sub>&#x000a0;is the original read count for cell <italic>i</italic> and locus <italic>j</italic>. For scBFA, Scasat, Destin, scABC, Binary PCA, chromVAR, and SCRAT, no extra normalization was applied.</p></sec><sec id="Sec28"><title>Gene selection in scRNA-seq data</title><p id="Par72">Highly variable genes (HVG) selection was performed to identify the most overdispersed genes, that is, genes that exhibit more variance than expected based on their mean. The HVG selection was performed using the FindVariableFeatures command implemented in Seurat 3.0. By default, Seurat selected the top 2000 genes. Highly expressed gene (HEG) selection was performed to identify the genes that exhibit the highest variance across cells, regardless of their mean, and is therefore expected to capture genes with higher mean expression compared to HVGs. To identify HEGs, we calculated the gene-specific variance in the gene count space and select the top 2000 genes to make the set size comparable to HVGs.</p><p id="Par73">The gene detection rate (the average fraction of cells in which a gene is detected as expressed) and gene-wise dispersion of each dataset calculated in Fig. <xref rid="Fig3" ref-type="fig">3</xref>b is based on these 2000 most variant genes under both the HVG and HEG selection criteria. For the timing experiment, we only selected the top 1000 genes under the HVG criterion for computational speed.</p></sec><sec id="Sec29"><title>Batch effect correction</title><p id="Par74">For both scRNA-seq and scATAC-seq datasets, we performed two types of batch effect correction, depending on how the cell types are distributed across the batches in the dataset. For datasets where all cell types are represented in all batches (e.g., replicates, patients), such as the HSC dataset, we used those cell-level covariates to define the <italic>N</italic>&#x02009;&#x000d7;&#x02009;<italic>C</italic>&#x000a0;design matrix <bold><italic>X</italic></bold> (see the scBFA model details above). For ZINB-WaVE, scBFA, and scVI, we regressed <bold><italic>X</italic></bold> out within the model structure. Since PCA does not offer a framework to regress out nuisance factors, we first regressed <bold><italic>X</italic></bold> directly from the normalized counts <inline-formula id="IEq35"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overset{\sim }{O}}_{ij} $$\end{document}</tex-math><mml:math id="M92" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>O</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq35.gif"/></alternatives></inline-formula> using a linear model. We then applied PCA on the residual matrix and obtained the corresponding embeddings and factor loading matrix. For Binary PCA, scImpute, SAVER, sctransform, and scrna2019, we also regressed out <bold><italic>X</italic></bold> from the binary entries and imputed values separately, then used the residual matrix in the same way as for PCA.</p><p id="Par75">For other datasets (MEM-T, Pancreatic, MGE in scRNA-seq, and GSE96769 and GSE74310 in scATAC-seq), some batches were missing a subset of cell types, resulting in a design matrix <bold><italic>X</italic></bold> that cannot be directly used to estimate all batch effects. In this scenario, our strategy for modifying the dataset to address batch effects is as follows. Note that we use the same parametrization used to define the scBFA model earlier, except that we define a new observation matrix <bold><italic>M</italic></bold> as a <italic>N</italic>&#x02009;&#x000d7;&#x02009;<italic>G</italic> matrix, where observations can either correspond to measured expressed levels <bold><italic>O</italic></bold>, inferred binary detection pattern <bold><italic>B</italic></bold>, or imputed read counts. Except for minor differences in parameterization, the GLM-based dimensionality reduction methods scBFA and ZINB-WaVE can be summarized in the following framework, where <italic>g</italic> is the link function, <italic>P</italic> is a probability measure, and <italic>&#x003bc;</italic>&#x000a0;is the expectation over the probability measure. In the case of ZINB-WaVE, <italic>P</italic> is a zero-inflated negative binomial distribution. In the case of scBFA, <italic>P</italic> is a Bernoulli distribution.
<disp-formula id="Equl"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ g\left({\mu}_{ij}\right)=\left({\boldsymbol{x}}_{\boldsymbol{i}}^{\boldsymbol{T}}{\boldsymbol{\beta}}_{\boldsymbol{j}}+{\boldsymbol{z}}_{\boldsymbol{i}}^{\boldsymbol{T}}{\boldsymbol{a}}_{\boldsymbol{j}}+{u}_i+{v}_j\right) $$\end{document}</tex-math><mml:math id="M94" display="block"><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi><mml:mi mathvariant="bold-italic">T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi><mml:mi mathvariant="bold-italic">T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1806_Article_Equl.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equm"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {M}_{ij}\sim P\left({\mu}_{ij}\right) $$\end{document}</tex-math><mml:math id="M96" display="block"><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1806_Article_Equm.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par76">We first identify the largest subset of cell types that are represented in all batches within a given dataset. Define <bold><italic>M</italic></bold><sub>sub</sub> as the submatrix of <italic>N</italic><sup>&#x02032;</sup> observations (<italic>N</italic><sup>&#x02032;</sup>&#x02009;&#x0003c;&#x02009;<italic>N</italic>)&#x000a0;corresponding to this subset of cell types and similarly define the submatrices <bold><italic>X</italic></bold><sub>sub</sub>, <bold><italic>Z</italic></bold><sub>sub</sub>, <bold><italic>A</italic></bold><sub>sub</sub> and&#x000a0;<bold><italic>u</italic></bold><sub>sub</sub>, where <italic>i</italic><sup>&#x02032;</sup>&#x02009;=&#x02009;1, &#x02026;, <italic>N</italic><sup>&#x02032;</sup>. We ran each dimensionality reduction method once to obtain an estimate of <inline-formula id="IEq36"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{\boldsymbol{\beta}} $$\end{document}</tex-math><mml:math id="M98" display="inline"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq36.gif"/></alternatives></inline-formula> by optimizing the likelihood of the following model:
<disp-formula id="Equn"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{M}}_{\mathrm{sub}\left({i}^{\prime },j\right)}\sim P\left({g}^{-1}\left({\boldsymbol{x}}_{\mathrm{sub}\left({\boldsymbol{i}}^{\prime}\right)}^{\boldsymbol{T}}{\boldsymbol{\beta}}_{\boldsymbol{j}}+{\boldsymbol{z}}_{\mathrm{sub}\left({\boldsymbol{i}}^{\prime}\right)}^{\boldsymbol{T}}{\boldsymbol{a}}_{\boldsymbol{j}}+{u}_{\mathrm{sub}\left({i}^{\prime}\right)}+{v}_j\right)\right) $$\end{document}</tex-math><mml:math id="M100" display="block"><mml:msub><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mrow><mml:mi>sub</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>j</mml:mi></mml:mfenced></mml:mrow></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>sub</mml:mi><mml:mfenced close=")" open="("><mml:msup><mml:mi mathvariant="bold-italic">i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mfenced></mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mi>sub</mml:mi><mml:mfenced close=")" open="("><mml:msup><mml:mi mathvariant="bold-italic">i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mfenced></mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>sub</mml:mi><mml:mfenced close=")" open="("><mml:msup><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mfenced></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1806_Article_Equn.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par77"><inline-formula id="IEq37"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{\boldsymbol{\beta}} $$\end{document}</tex-math><mml:math id="M102" display="inline"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq37.gif"/></alternatives></inline-formula> learns the variance induced by different batches only. Then, we use <inline-formula id="IEq38"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{\boldsymbol{\beta}} $$\end{document}</tex-math><mml:math id="M104" display="inline"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq38.gif"/></alternatives></inline-formula> as a plug-in estimate of <bold><italic>&#x003b2;</italic></bold>, and performed each dimensionality method on the full dataset to obtain estimates of all other parameters. Note since both ZINB-WaVE and scBFA regularize their coefficient matrix <bold><italic>&#x003b2;</italic></bold>,&#x000a0;<bold><italic>X</italic></bold><sub>sub</sub> and <bold><italic>X</italic></bold> are both standardized. For PCA, scImpute, SAVER, sctransform, scrna2019, SCRAT, and chromVAR, we used a similar strategy to obtain <inline-formula id="IEq39"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{\boldsymbol{\beta}} $$\end{document}</tex-math><mml:math id="M106" display="inline"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq39.gif"/></alternatives></inline-formula> by using linear regression to regress out <bold><italic>X</italic></bold><sub>sub</sub> from the observation matrix corresponding to the largest subset of cell types represented in all batches. Then, we calculated the residuals <italic>R</italic><sub><italic>ij</italic></sub>&#x02009;=&#x02009;<italic>M</italic><sub><italic>ij</italic></sub>&#x02009;&#x02212;&#x02009;<bold><italic>X&#x003b2;</italic></bold><sup><bold><italic>T</italic></bold></sup> on the full dataset with <inline-formula id="IEq40"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \boldsymbol{\beta} =\hat{\boldsymbol{\beta}} $$\end{document}</tex-math><mml:math id="M108" display="block"><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq40.gif"/></alternatives></inline-formula> fixed and performed PCA on the residual matrix <bold><italic>R</italic></bold>. For scVI, we were unable to modify the model framework to adjust for batch effects when they were confounded with cell types, as was the case in MEM-T, Pancreatic, and MGE. Therefore, we measured the scVI performance when we did not correct for batch effect, as well as when we performed na&#x000ef;ve batch effect correction ignoring the confounding, and then reported the best performance for scVI.</p><p id="Par78">Scasat handles batch effects through the removal of batch-specific loci. However, for datasets GSE96769 and GSE74310, the batch effect is confounded with cell types. Therefore, we ran Scasat without batch effect correction because batch-specific loci would be indistinguishable from cell type-specific loci. Destin and scABC cannot adjust batch effect on their own, and so we ran them without batch effect correction on these two datasets.</p></sec><sec id="Sec30"><title>Identification of marker genes</title><p id="Par79">We evaluated the extent to which the inferred dimensions for each method recover known marker genes (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). For each method, we first obtained the <italic>K</italic>&#x02009;&#x000d7;&#x02009;<italic>G</italic> factor loading matrix indicating which genes are contributing to each of the <italic>K</italic> factors. Then, for every loading matrix and given number of factors, we ranked the absolute value of each gene in each factor and calculated the area under the receiver-operator curve (AUROC) to measure the extent to which the known marker genes contribute more to a factor than expected by chance.</p><p id="Par80">Note that ZINB-WaVE has two loading matrices corresponding to the gene detection and gene count components, respectively, and therefore appears twice in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. In ZINB-WaVE, <italic>&#x003c0;</italic><sub><italic>ij</italic></sub> models whether a gene has been detected or not, and <italic>&#x003bc;</italic><sub><italic>ij</italic></sub> models the mean for the read counts under negative binomial distribution. As in the previous section, we used the parameters <inline-formula id="IEq41"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\{\hat{\boldsymbol{Z}},{\hat{\boldsymbol{A}}}_{\boldsymbol{\mu}},{\hat{\boldsymbol{A}}}_{\boldsymbol{\pi}},{\hat{\boldsymbol{u}}}_{\boldsymbol{\mu}},{\hat{\boldsymbol{u}}}_{\boldsymbol{\pi}},{\hat{\boldsymbol{v}}}_{\boldsymbol{\mu}},{\hat{\boldsymbol{v}}}_{\boldsymbol{\pi}}\right\} $$\end{document}</tex-math><mml:math id="M110" display="inline"><mml:mfenced close="}" open="{" separators=",,,,,,"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq41.gif"/></alternatives></inline-formula> to replace the parameters <inline-formula id="IEq42"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\{\hat{\boldsymbol{W}},{\hat{\boldsymbol{\alpha}}}_{\boldsymbol{\mu}},{\hat{\boldsymbol{\alpha}}}_{\boldsymbol{\pi}},{\hat{\boldsymbol{\gamma}}}_{\boldsymbol{\pi}},{\hat{\boldsymbol{\gamma}}}_{\boldsymbol{\mu}},{\hat{\boldsymbol{\beta}}}_{\boldsymbol{\mu}},{\hat{\boldsymbol{\beta}}}_{\boldsymbol{\pi}}\right\} $$\end{document}</tex-math><mml:math id="M112" display="inline"><mml:mfenced close="}" open="{" separators=",,,,,,"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mo stretchy="true">&#x0005e;</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1806_Article_IEq42.gif"/></alternatives></inline-formula> used y:
<disp-formula id="Equo"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \kern0.5em \mathrm{logit}\left({\pi}_{ij}\right)=\left({\boldsymbol{z}}_{\boldsymbol{\pi} \left(\boldsymbol{i}\right)}^{\boldsymbol{T}}{\boldsymbol{a}}_{\boldsymbol{\pi} \left(\boldsymbol{j}\right)}+{\boldsymbol{x}}_{\boldsymbol{i}}^{\boldsymbol{T}}{\boldsymbol{\beta}}_{\boldsymbol{\pi} \left(\boldsymbol{j}\right)}+{u}_{\pi (i)}+{v}_{\pi (j)}\right) $$\end{document}</tex-math><mml:math id="M114" display="block"><mml:mspace width="0.5em"/><mml:mtext>logit</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mfenced></mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mfenced></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi><mml:mi mathvariant="bold-italic">T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mfenced></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>&#x003c0;</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>&#x003c0;</mml:mi><mml:mfenced close=")" open="("><mml:mi>j</mml:mi></mml:mfenced></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1806_Article_Equo.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equp"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \kern0.5em \log \left({\mu}_{ij}\right)=\left({\boldsymbol{z}}_{\boldsymbol{\mu} \left(\boldsymbol{i}\right)}^{\boldsymbol{T}}{\boldsymbol{a}}_{\boldsymbol{\mu} \left(\boldsymbol{j}\right)}+{\boldsymbol{x}}_{\boldsymbol{i}}^{\boldsymbol{T}}{\boldsymbol{\beta}}_{\boldsymbol{\mu} \left(\boldsymbol{j}\right)}+{u}_{\mu (i)}+{v}_{\mu (j)}\right) $$\end{document}</tex-math><mml:math id="M116" display="block"><mml:mspace width="0.5em"/><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mfenced></mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mfenced></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi><mml:mi mathvariant="bold-italic">T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mfenced></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>&#x003bc;</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>&#x003bc;</mml:mi><mml:mfenced close=")" open="("><mml:mi>j</mml:mi></mml:mfenced></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1806_Article_Equp.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par81">The loading matrix <bold><italic>a</italic></bold><sub><bold><italic>&#x003c0;</italic></bold></sub> that models the gene detection component (<italic>&#x003c0;</italic>) is denoted as <italic>ZINB-WaVE</italic><sub>dropout</sub>, and the loading matrix <bold><italic>a</italic></bold><sub><bold>&#x003bc;</bold></sub> that models gene counts&#x000a0;is denoted <italic>ZINB-WaVE</italic><sub>mean</sub>.</p></sec><sec id="Sec31"><title>Trajectory inference</title><p id="Par82">To evaluate the performance gains of scBFA in the context of trajectory inference, we used a recently published platform, dynverse, for which &#x0201c;gold standard&#x0201d; scRNA-seq datasets were already obtained and preprocessed, and scripts and performance metrics have already been defined to evaluate trajectory inference [<xref ref-type="bibr" rid="CR32">32</xref>]. Gold standard datasets refer to those datasets in which experimental (non-computational) methods were used to annotate a dataset with trajectory information such as cell type clusters (milestones) and connections between cell type clusters (milestone networks). From the 27 datasets available on June 12, 2019, that met this gold standard status and were real (not synthetic), we filtered out datasets that had less than 170 cells, yielding a total of 20 benchmark datasets. As with our previous experiments, we used the HVG selection criterion to identify the top 2000 varying genes for dimensionality reduction.</p><p id="Par83">Our strategy for benchmarking trajectory inference was to identify an existing, top-performing trajectory inference method that also uses dimensionality reduction in its pipeline then replace that dimensionality reduction step with one of the methods we tested in our study. The dynverse paper identified Slingshot as a top performer [<xref ref-type="bibr" rid="CR32">32</xref>]. To evaluate scBFA and the other methods, we substituted the PCA step of Slingshot with each dimensionality reduction method (scBFA, ZINB-WaVE, PCA, scImpute, SAVER, scrna2019, sctransform, scVI) and used dynverse to measure the performance of each modified version of Slingshot. The number of input latent dimensions was set to 10. Because the Slingshot implementation throws NA in cases where it is uncertain of the assignment of cells to a particular lineage, we removed two datasets from further evaluation because the number of NAs produced prevented calculation of the performance metrics (germline-human-both_guo.rds, mESC-differentiation_hayashi.rds). For each of the 18 benchmarks (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S8), we used dynverse to compute three performance metrics with respect to the experimentally gathered trajectory information: F1<sub>milestones</sub>, F1<sub>branches</sub>, and NMSE<sub>lm</sub>. F1<sub>milestones</sub> measures the similarity between clustering membership of two trajectories. F1<sub>branches</sub> compares the similarity between the assignment of two branches. NMSE<sub>lm</sub> is a measurement of how well the position of a cell in the inferred trajectory predicts the position of the cell in the ground truth trajectory under linear regression. Larger values of F1<sub>milestones</sub>, F1<sub>branches</sub>, and NMSE<sub>lm</sub> correspond to better performance. We obtained F1<sub>milestones</sub>, F1<sub>branches</sub>, and NMSE<sub>lm</sub> via dynverse&#x02019;s calculate_mapping and calculate_position_predict functions within the dyneval package and converted raw values to ranks for Fig. <xref rid="Fig6" ref-type="fig">6</xref>. The wrapper function to obtain the results from Slingshot is adapted from the internal function <ext-link ext-link-type="uri" xlink:href="https://github.com/dynverse/ti_slingshot/blob/master/package/R/ti_slingshot.R">https://github.com/dynverse/ti_slingshot/blob/master/package/R/ti_slingshot.R</ext-link>.</p></sec><sec id="Sec32"><title>Visualization</title><p id="Par84">After we obtain the embedding matrix from every method, we use the <italic>t</italic>-distributed stochastic embedding [<xref ref-type="bibr" rid="CR49">49</xref>] method to project the embedding matrix onto two dimensions for visualization as a scatterplot. In all visualizations, the number of factors used as input to t-SNE in each visualization is 10.</p></sec><sec id="Sec33"><title>Timing experiments</title><p id="Par85">In the timing experiment (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S27), we randomly subsampled 1k, 10k, 50k, and 100k cells from the 1.3 million 10&#x000d7; brain cell dataset from E18 mice and recorded the single-core execution time (in seconds) of all methods (PCA, ZINB-WaVE, scImpute, SAVER, sctransform, scrna2019, and Binary PCA) on the same machine. Due to the non-convex nature of ZINB-WaVE&#x02019;s objective function and different optimization scheme, we cannot strictly match the convergence criterion of ZINB-WaVE to scBFA. Therefore, we use the same number of iterations for each method that was used to generate the results in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Because scImpute requires specification of the number of cell clusters, we set the number of cell clusters to seven, similar to a previous study [<xref ref-type="bibr" rid="CR50">50</xref>] that used seven as an underestimate of the true number of cell types.</p></sec></sec><sec sec-type="supplementary-material"><title>Additional files</title><sec id="Sec34"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="13059_2019_1806_MOESM1_ESM.docx"><label>Additional file 1:</label><caption><p>Contains supplementary figures and tables, <bold>Figures S1&#x02013;S29.</bold>, <bold>Tables S1&#x02013;S8.</bold> (DOCX 3090 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="13059_2019_1806_MOESM2_ESM.docx"><label>Additional file 2:</label><caption><p>Review history. (DOCX 3950 kb)</p></caption></media></supplementary-material>
</p></sec></sec></body><back><fn-group><fn><p><bold>Publisher&#x02019;s Note</bold></p><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><ack><title>Acknowledgements</title><p>Not applicable.</p><sec id="FPar2"><title>Review history</title><p id="Par86">The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p></sec></ack><notes notes-type="author-contribution"><title>Authors&#x02019; contributions</title><p>RL and GQ conceived the study, analyzed and interpreted the data, and wrote the manuscript. RL wrote the code for scBFA. Both authors read and approved the final manuscript.</p></notes><notes notes-type="funding-information"><title>Funding</title><p>This project has been made possible in part by grant number 2018-182633 from the Chan Zuckerberg Initiative DAF, an advised fund of Silicon Valley Community Foundation. Funding was also provided by NSF CAREER award 1846559 to GQ.</p></notes><notes notes-type="data-availability"><title>Availability of data and materials</title><p>The source code implementing scBFA is available on a Bioconductor at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/devel/bioc/html/scBFA.html">https://bioconductor.org/packages/devel/bioc/html/scBFA.html</ext-link>, as well as in a GitHub repository at <ext-link ext-link-type="uri" xlink:href="https://github.com/quon-titative-biology/scBFA">https://github.com/quon-titative-biology/scBFA</ext-link>[<xref ref-type="bibr" rid="CR51">51</xref>]. scBFA is released under Apache License 2.0.</p><p>All datasets analyzed in this study with accession numbers and references are included in the published article and Additional file <xref rid="MOESM1" ref-type="media">1</xref>. Benchmark datasets used for cell type identification in scRNA-seq are GSE48968 [<xref ref-type="bibr" rid="CR52">52</xref>], GSE104157 [<xref ref-type="bibr" rid="CR53">53</xref>], GSE100426 [<xref ref-type="bibr" rid="CR54">54</xref>], GSE62270 [<xref ref-type="bibr" rid="CR55">55</xref>], GSE106540 [<xref ref-type="bibr" rid="CR56">56</xref>], GSE81076 [<xref ref-type="bibr" rid="CR57">57</xref>], GSE100866 [<xref ref-type="bibr" rid="CR48">48</xref>], GSE89232 [<xref ref-type="bibr" rid="CR58">58</xref>], GSE123025 [<xref ref-type="bibr" rid="CR59">59</xref>], GSE94383 [<xref ref-type="bibr" rid="CR60">60</xref>], GSE100037 [<xref ref-type="bibr" rid="CR61">61</xref>], GSE81682 [<xref ref-type="bibr" rid="CR62">62</xref>], E-MTAB-2805 [<xref ref-type="bibr" rid="CR63">63</xref>], and SRP073808 [<xref ref-type="bibr" rid="CR64">64</xref>] (Additional&#x000a0;file&#x000a0;1: Table S1). Benchmark datasets used for cell type identification in scATAC-seq are GSE96769 [<xref ref-type="bibr" rid="CR45">45</xref>], GSE74310 [<xref ref-type="bibr" rid="CR46">46</xref>], and GSE107816 [<xref ref-type="bibr" rid="CR47">47</xref>]. Benchmark datasets used for trajectory inference in scRNA-seq are GSE59114 [<xref ref-type="bibr" rid="CR65">65</xref>], E-MTAB-2805 [<xref ref-type="bibr" rid="CR63">63</xref>], GSE60781 [<xref ref-type="bibr" rid="CR66">66</xref>], GSE86146 [<xref ref-type="bibr" rid="CR67">67</xref>], GSE70240 [<xref ref-type="bibr" rid="CR68">68</xref>], GSE70243 [<xref ref-type="bibr" rid="CR68">68</xref>], GSE70244 [<xref ref-type="bibr" rid="CR68">68</xref>], GSE70236 [<xref ref-type="bibr" rid="CR67">67</xref>], E-MTAB-3929 [<xref ref-type="bibr" rid="CR69">69</xref>], GSE52529 [<xref ref-type="bibr" rid="CR16">16</xref>], GSE74596 [<xref ref-type="bibr" rid="CR70">70</xref>], GSE87375 [<xref ref-type="bibr" rid="CR71">71</xref>], GSE99951 [<xref ref-type="bibr" rid="CR72">72</xref>], GSE48968 [<xref ref-type="bibr" rid="CR52">52</xref>], and GSE85066 [<xref ref-type="bibr" rid="CR73">73</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S8). Representative scRNA-seq datasets used for observational study in Additional&#x000a0;file&#x000a0;1: Figure S1 are GSE101601 [<xref ref-type="bibr" rid="CR74">74</xref>], GSE106707 [<xref ref-type="bibr" rid="CR75">75</xref>], GSE110558 [<xref ref-type="bibr" rid="CR76">76</xref>], GSE110692 [<xref ref-type="bibr" rid="CR76">76</xref>], GSE119097 [<xref ref-type="bibr" rid="CR77">77</xref>], GSE56638 [<xref ref-type="bibr" rid="CR78">78</xref>], GSE72056 [<xref ref-type="bibr" rid="CR79">79</xref>], GSE81682 [<xref ref-type="bibr" rid="CR62">62</xref>], GSE85527 [<xref ref-type="bibr" rid="CR80">80</xref>], GSE86977 [<xref ref-type="bibr" rid="CR81">81</xref>], GSE95432 [<xref ref-type="bibr" rid="CR82">82</xref>], GSE98816 [<xref ref-type="bibr" rid="CR83">83</xref>], GSE95315 [<xref ref-type="bibr" rid="CR84">84</xref>], GSE95752 [<xref ref-type="bibr" rid="CR84">84</xref>], GSE76381 [<xref ref-type="bibr" rid="CR85">85</xref>], GSE110679 [<xref ref-type="bibr" rid="CR76">76</xref>], GSE99888 [<xref ref-type="bibr" rid="CR86">86</xref>], GSE52529 [<xref ref-type="bibr" rid="CR16">16</xref>], GSE60749 [<xref ref-type="bibr" rid="CR87">87</xref>], GSE63818 [<xref ref-type="bibr" rid="CR88">88</xref>], GSE71982 [<xref ref-type="bibr" rid="CR89">89</xref>], GSE57872 [<xref ref-type="bibr" rid="CR90">90</xref>], GSE102299, GSE48968 [<xref ref-type="bibr" rid="CR52">52</xref>], GSE104157 [<xref ref-type="bibr" rid="CR53">53</xref>], GSE100426 [<xref ref-type="bibr" rid="CR54">54</xref>], GSE62270 [<xref ref-type="bibr" rid="CR55">55</xref>], GSE106540 [<xref ref-type="bibr" rid="CR56">56</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7).</p></notes><notes><title>Ethics approval and consent to participate</title><p id="Par87">Not applicable.</p></notes><notes><title>Consent for publication</title><p id="Par88">Not applicable.</p></notes><notes notes-type="COI-statement"><title>Competing interests</title><p id="Par89">The authors declare that they have no competing interests.</p></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hwang</surname><given-names>B</given-names></name><name><surname>Lee</surname><given-names>JH</given-names></name><name><surname>Bang</surname><given-names>D</given-names></name></person-group><article-title>Single-cell RNA sequencing technologies and bioinformatics pipelines</article-title><source>Exp. Mol. Med.</source><year>2018</year><volume>50</volume><fpage>96</fpage><pub-id pub-id-type="doi">10.1038/s12276-018-0071-8</pub-id><pub-id pub-id-type="pmid">30089861</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Svensson</surname><given-names>V</given-names></name><name><surname>Vento-Tormo</surname><given-names>R</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name></person-group><article-title>Exponential scaling of single-cell RNA-seq in the past decade</article-title><source>Nat Protoc</source><year>2018</year><volume>13</volume><fpage>599</fpage><lpage>604</lpage><pub-id pub-id-type="doi">10.1038/nprot.2017.149</pub-id><pub-id pub-id-type="pmid">29494575</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hicks</surname><given-names>SC</given-names></name><name><surname>Townes</surname><given-names>FW</given-names></name><name><surname>Teng</surname><given-names>M</given-names></name><name><surname>Irizarry</surname><given-names>RA</given-names></name></person-group><article-title>Missing data and technical variability in single-cell RNA-sequencing experiments</article-title><source>Biostatistics</source><year>2018</year><volume>19</volume><fpage>562</fpage><lpage>578</lpage><pub-id pub-id-type="doi">10.1093/biostatistics/kxx053</pub-id><pub-id pub-id-type="pmid">29121214</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jaitin</surname><given-names>DA</given-names></name><etal/></person-group><article-title>Massively parallel single cell RNA-Seq for marker-free decomposition of tissues into cell types</article-title><source>Science</source><year>2014</year><volume>343</volume><fpage>776</fpage><lpage>779</lpage><pub-id pub-id-type="doi">10.1126/science.1247651</pub-id><pub-id pub-id-type="pmid">24531970</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vallejos</surname><given-names>CA</given-names></name><name><surname>Risso</surname><given-names>D</given-names></name><name><surname>Scialdone</surname><given-names>A</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name></person-group><article-title>Normalizing single-cell RNA sequencing data: challenges and opportunities</article-title><source>Nat. Methods</source><year>2017</year><volume>14</volume><fpage>565</fpage><lpage>571</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4292</pub-id><pub-id pub-id-type="pmid">28504683</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ziegenhain</surname><given-names>Christoph</given-names></name><name><surname>Vieth</surname><given-names>Beate</given-names></name><name><surname>Parekh</surname><given-names>Swati</given-names></name><name><surname>Reinius</surname><given-names>Bj&#x000f6;rn</given-names></name><name><surname>Guillaumet-Adkins</surname><given-names>Amy</given-names></name><name><surname>Smets</surname><given-names>Martha</given-names></name><name><surname>Leonhardt</surname><given-names>Heinrich</given-names></name><name><surname>Heyn</surname><given-names>Holger</given-names></name><name><surname>Hellmann</surname><given-names>Ines</given-names></name><name><surname>Enard</surname><given-names>Wolfgang</given-names></name></person-group><article-title>Comparative Analysis of Single-Cell RNA Sequencing Methods</article-title><source>Molecular Cell</source><year>2017</year><volume>65</volume><issue>4</issue><fpage>631-643.e4</fpage><pub-id pub-id-type="doi">10.1016/j.molcel.2017.01.023</pub-id><pub-id pub-id-type="pmid">28212749</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dueck</surname><given-names>HR</given-names></name><etal/></person-group><article-title>Assessing characteristics of RNA amplification methods for single cell RNA sequencing</article-title><source>BMC Genomics</source><year>2016</year><volume>17</volume><fpage>966</fpage><pub-id pub-id-type="doi">10.1186/s12864-016-3300-3</pub-id><pub-id pub-id-type="pmid">27881084</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="other">Risso D, Perraudeau F, Gribkova S, Dudoit S, Vert J-P. A general and flexible method for signal extraction from single-cell RNA-seq data. <italic>Nat Commun</italic>. 2018;9.</mixed-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>WV</given-names></name><name><surname>Li</surname><given-names>JJ</given-names></name></person-group><article-title>An accurate and robust imputation method scImpute for single-cell RNA-seq data</article-title><source>Nat Commun</source><year>2018</year><volume>9</volume><fpage>997</fpage><pub-id pub-id-type="doi">10.1038/s41467-018-03405-7</pub-id><pub-id pub-id-type="pmid">29520097</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pierson</surname><given-names>E</given-names></name><name><surname>Yau</surname><given-names>C</given-names></name></person-group><article-title>ZIFA: Dimensionality reduction for zero-inflated single-cell gene expression analysis</article-title><source>Genome Biology</source><year>2015</year><volume>16</volume><fpage>241</fpage><pub-id pub-id-type="doi">10.1186/s13059-015-0805-z</pub-id><pub-id pub-id-type="pmid">26527291</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramsk&#x000f6;ld</surname><given-names>D</given-names></name><etal/></person-group><article-title>Full-length mRNA-Seq from single-cell levels of RNA and individual circulating tumor cells</article-title><source>Nat. Biotechnol.</source><year>2012</year><volume>30</volume><fpage>777</fpage><lpage>782</lpage><pub-id pub-id-type="doi">10.1038/nbt.2282</pub-id><pub-id pub-id-type="pmid">22820318</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lopez</surname><given-names>R</given-names></name><name><surname>Regier</surname><given-names>J</given-names></name><name><surname>Cole</surname><given-names>MB</given-names></name><name><surname>Jordan</surname><given-names>MI</given-names></name><name><surname>Yosef</surname><given-names>N</given-names></name></person-group><article-title>Deep generative modeling for single-cell transcriptomics</article-title><source>Nature Methods</source><year>2018</year><volume>15</volume><fpage>1053</fpage><pub-id pub-id-type="doi">10.1038/s41592-018-0229-2</pub-id><pub-id pub-id-type="pmid">30504886</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>M</given-names></name><etal/></person-group><article-title>SAVER: gene expression recovery for single-cell RNA sequencing</article-title><source>Nat. Methods</source><year>2018</year><volume>15</volume><fpage>539</fpage><lpage>542</lpage><pub-id pub-id-type="doi">10.1038/s41592-018-0033-z</pub-id><pub-id pub-id-type="pmid">29941873</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="other">Hafemeister, C. &#x00026; Satija, R. Normalization and variance stabilization of single-cell RNA-seq data using regularized negative binomial regression. <italic>bioRxiv</italic> 576827 (2019). doi:10.1101/576827</mixed-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="other">Townes, F. W., Hicks, S. C., Aryee, M. J. &#x00026; Irizarry, R. A. Feature selection and dimension reduction for single cell RNA-Seq based on a multinomial model. <italic>bioRxiv</italic> 574574 (2019). doi:10.1101/574574</mixed-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><etal/></person-group><article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title><source>Nat Biotech</source><year>2014</year><volume>32</volume><fpage>381</fpage><lpage>386</lpage><pub-id pub-id-type="doi">10.1038/nbt.2859</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haghverdi</surname><given-names>L</given-names></name><name><surname>Buettner</surname><given-names>F</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>Diffusion maps for high-dimensional single-cell analysis of differentiation data</article-title><source>Bioinformatics</source><year>2015</year><volume>31</volume><fpage>2989</fpage><lpage>2998</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btv325</pub-id><pub-id pub-id-type="pmid">26002886</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giecold</surname><given-names>Gregory</given-names></name><name><surname>Marco</surname><given-names>Eugenio</given-names></name><name><surname>Garcia</surname><given-names>Sara P.</given-names></name><name><surname>Trippa</surname><given-names>Lorenzo</given-names></name><name><surname>Yuan</surname><given-names>Guo-Cheng</given-names></name></person-group><article-title>Robust lineage reconstruction from high-dimensional single-cell data</article-title><source>Nucleic Acids Research</source><year>2016</year><volume>44</volume><issue>14</issue><fpage>e122</fpage><lpage>e122</lpage><pub-id pub-id-type="doi">10.1093/nar/gkw452</pub-id><pub-id pub-id-type="pmid">27207878</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>B</given-names></name><name><surname>Zhu</surname><given-names>J</given-names></name><name><surname>Pierson</surname><given-names>E</given-names></name><name><surname>Ramazzotti</surname><given-names>D</given-names></name><name><surname>Batzoglou</surname><given-names>S</given-names></name></person-group><article-title>Visualization and analysis of single-cell RNA-seq data by kernel-based similarity learning</article-title><source>Nat. Methods</source><year>2017</year><volume>14</volume><fpage>414</fpage><lpage>416</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4207</pub-id><pub-id pub-id-type="pmid">28263960</pub-id></element-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ding</surname><given-names>J</given-names></name><name><surname>Condon</surname><given-names>A</given-names></name><name><surname>Shah</surname><given-names>SP</given-names></name></person-group><article-title>Interpretable dimensionality reduction of single cell transcriptome data with deep generative models</article-title><source>Nat Commun</source><year>2018</year><volume>9</volume><fpage>2002</fpage><pub-id pub-id-type="doi">10.1038/s41467-018-04368-5</pub-id><pub-id pub-id-type="pmid">29784946</pub-id></element-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pollen</surname><given-names>Alex A</given-names></name><name><surname>Nowakowski</surname><given-names>Tomasz J</given-names></name><name><surname>Shuga</surname><given-names>Joe</given-names></name><name><surname>Wang</surname><given-names>Xiaohui</given-names></name><name><surname>Leyrat</surname><given-names>Anne A</given-names></name><name><surname>Lui</surname><given-names>Jan H</given-names></name><name><surname>Li</surname><given-names>Nianzhen</given-names></name><name><surname>Szpankowski</surname><given-names>Lukasz</given-names></name><name><surname>Fowler</surname><given-names>Brian</given-names></name><name><surname>Chen</surname><given-names>Peilin</given-names></name><name><surname>Ramalingam</surname><given-names>Naveen</given-names></name><name><surname>Sun</surname><given-names>Gang</given-names></name><name><surname>Thu</surname><given-names>Myo</given-names></name><name><surname>Norris</surname><given-names>Michael</given-names></name><name><surname>Lebofsky</surname><given-names>Ronald</given-names></name><name><surname>Toppani</surname><given-names>Dominique</given-names></name><name><surname>Kemp</surname><given-names>Darnell W</given-names></name><name><surname>Wong</surname><given-names>Michael</given-names></name><name><surname>Clerkson</surname><given-names>Barry</given-names></name><name><surname>Jones</surname><given-names>Brittnee N</given-names></name><name><surname>Wu</surname><given-names>Shiquan</given-names></name><name><surname>Knutsson</surname><given-names>Lawrence</given-names></name><name><surname>Alvarado</surname><given-names>Beatriz</given-names></name><name><surname>Wang</surname><given-names>Jing</given-names></name><name><surname>Weaver</surname><given-names>Lesley S</given-names></name><name><surname>May</surname><given-names>Andrew P</given-names></name><name><surname>Jones</surname><given-names>Robert C</given-names></name><name><surname>Unger</surname><given-names>Marc A</given-names></name><name><surname>Kriegstein</surname><given-names>Arnold R</given-names></name><name><surname>West</surname><given-names>Jay A A</given-names></name></person-group><article-title>Low-coverage single-cell mRNA sequencing reveals cellular heterogeneity and activated signaling pathways in developing cerebral cortex</article-title><source>Nature Biotechnology</source><year>2014</year><volume>32</volume><issue>10</issue><fpage>1053</fpage><lpage>1058</lpage><pub-id pub-id-type="doi">10.1038/nbt.2967</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heimberg</surname><given-names>G</given-names></name><name><surname>Bhatnagar</surname><given-names>R</given-names></name><name><surname>El-Samad</surname><given-names>H</given-names></name><name><surname>Thomson</surname><given-names>M</given-names></name></person-group><article-title>Low dimensionality in gene expression data enables the accurate extraction of transcriptional programs from shallow sequencing</article-title><source>cels</source><year>2016</year><volume>2</volume><fpage>239</fpage><lpage>250</lpage></element-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="other">Zhang, M. J., Ntranos, V. &#x00026; Tse, D. One read per cell per gene is optimal for single-cell RNA-Seq. <italic>bioRxiv</italic> 389296 (2018). doi:10.1101/389296</mixed-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>JK</given-names></name><etal/></person-group><article-title>Characterizing noise structure in single-cell RNA-seq distinguishes genuine from technical stochastic allelic expression</article-title><source>Nat Commun</source><year>2015</year><volume>6</volume><fpage>8687</fpage><pub-id pub-id-type="doi">10.1038/ncomms9687</pub-id><pub-id pub-id-type="pmid">26489834</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brennecke</surname><given-names>P</given-names></name><etal/></person-group><article-title>Accounting for technical noise in single-cell RNA-seq experiments</article-title><source>Nat. Methods</source><year>2013</year><volume>10</volume><fpage>1093</fpage><lpage>1095</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2645</pub-id><pub-id pub-id-type="pmid">24056876</pub-id></element-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="other">Finak G, et al. MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data. <italic>Genome Biol</italic>. 2015;16.</mixed-citation></ref><ref id="CR27"><label>27.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Svensson</surname><given-names>V</given-names></name><etal/></person-group><article-title>Power analysis of single-cell RNA-sequencing experiments</article-title><source>Nat. Methods</source><year>2017</year><volume>14</volume><fpage>381</fpage><lpage>387</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4220</pub-id><pub-id pub-id-type="pmid">28263961</pub-id></element-citation></ref><ref id="CR28"><label>28.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Love</surname><given-names>MI</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name><name><surname>Anders</surname><given-names>S</given-names></name></person-group><article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title><source>Genome Biol.</source><year>2014</year><volume>15</volume><fpage>550</fpage><pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id><pub-id pub-id-type="pmid">25516281</pub-id></element-citation></ref><ref id="CR29"><label>29.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>GXY</given-names></name><etal/></person-group><article-title>Massively parallel digital transcriptional profiling of single cells</article-title><source>Nat Commun</source><year>2017</year><volume>8</volume><fpage>14049</fpage><pub-id pub-id-type="doi">10.1038/ncomms14049</pub-id><pub-id pub-id-type="pmid">28091601</pub-id></element-citation></ref><ref id="CR30"><label>30.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Islam</surname><given-names>S</given-names></name><etal/></person-group><article-title>Quantitative single-cell RNA-seq with unique molecular identifiers</article-title><source>Nat. Methods</source><year>2014</year><volume>11</volume><fpage>163</fpage><lpage>166</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2772</pub-id><pub-id pub-id-type="pmid">24363023</pub-id></element-citation></ref><ref id="CR31"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cannoodt</surname><given-names>R</given-names></name><name><surname>Saelens</surname><given-names>W</given-names></name><name><surname>Saeys</surname><given-names>Y</given-names></name></person-group><article-title>Computational methods for trajectory inference from single-cell transcriptomics</article-title><source>Eur. J. Immunol.</source><year>2016</year><volume>46</volume><fpage>2496</fpage><lpage>2506</lpage><pub-id pub-id-type="doi">10.1002/eji.201646347</pub-id><pub-id pub-id-type="pmid">27682842</pub-id></element-citation></ref><ref id="CR32"><label>32.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saelens</surname><given-names>W</given-names></name><name><surname>Cannoodt</surname><given-names>R</given-names></name><name><surname>Todorov</surname><given-names>H</given-names></name><name><surname>Saeys</surname><given-names>Y</given-names></name></person-group><article-title>A comparison of single-cell trajectory inference methods</article-title><source>Nat. Biotechnol.</source><year>2019</year><volume>37</volume><fpage>547</fpage><lpage>554</lpage><pub-id pub-id-type="doi">10.1038/s41587-019-0071-9</pub-id><pub-id pub-id-type="pmid">30936559</pub-id></element-citation></ref><ref id="CR33"><label>33.</label><mixed-citation publication-type="other">Street K, et al. Slingshot: cell lineage and pseudotime inference for single-cell transcriptomics. <italic>BMC Genomics</italic>. 2018;19.</mixed-citation></ref><ref id="CR34"><label>34.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baker</surname><given-names>SM</given-names></name><name><surname>Rogerson</surname><given-names>C</given-names></name><name><surname>Hayes</surname><given-names>A</given-names></name><name><surname>Sharrocks</surname><given-names>AD</given-names></name><name><surname>Rattray</surname><given-names>M</given-names></name></person-group><article-title>Classifying cells with Scasat, a single-cell ATAC-seq analysis tool</article-title><source>Nucleic Acids Res.</source><year>2019</year><volume>47</volume><fpage>e10</fpage><pub-id pub-id-type="doi">10.1093/nar/gky950</pub-id><pub-id pub-id-type="pmid">30335168</pub-id></element-citation></ref><ref id="CR35"><label>35.</label><mixed-citation publication-type="other">Urrutia E, Chen L, Zhou H, Jiang Y. Destin: toolkit for single-cell analysis of chromatin accessibility. <italic>Bioinformatics</italic>. 10.1093/bioinformatics/btz141.</mixed-citation></ref><ref id="CR36"><label>36.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zamanighomi</surname><given-names>M</given-names></name><etal/></person-group><article-title>Unsupervised clustering and epigenetic classification of single cells</article-title><source>Nature Communications</source><year>2018</year><volume>9</volume><fpage>2410</fpage><pub-id pub-id-type="doi">10.1038/s41467-018-04629-3</pub-id></element-citation></ref><ref id="CR37"><label>37.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schep</surname><given-names>AN</given-names></name><name><surname>Wu</surname><given-names>B</given-names></name></person-group><article-title>Buenrostro, J. D. &#x00026; Greenleaf, W. J. chromVAR: inferring transcription-factor-associated accessibility from single-cell epigenomic data. <italic>Nat</italic></article-title><source>Methods</source><year>2017</year><volume>14</volume><fpage>975</fpage><lpage>978</lpage></element-citation></ref><ref id="CR38"><label>38.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ji</surname><given-names>Z</given-names></name><name><surname>Zhou</surname><given-names>W</given-names></name><name><surname>Ji</surname><given-names>H</given-names></name></person-group><article-title>Single-cell regulome data analysis by SCRAT</article-title><source>Bioinformatics</source><year>2017</year><volume>33</volume><fpage>2930</fpage><lpage>2932</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btx315</pub-id><pub-id pub-id-type="pmid">28505247</pub-id></element-citation></ref><ref id="CR39"><label>39.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arzalluz-Luque</surname><given-names>&#x000c1;</given-names></name><name><surname>Devailly</surname><given-names>G</given-names></name><name><surname>Mantsoki</surname><given-names>A</given-names></name><name><surname>Joshi</surname><given-names>A</given-names></name></person-group><article-title>Delineating biological and technical variance in single cell expression data</article-title><source>Int. J. Biochem. Cell Biol.</source><year>2017</year><volume>90</volume><fpage>161</fpage><lpage>166</lpage><pub-id pub-id-type="doi">10.1016/j.biocel.2017.07.006</pub-id><pub-id pub-id-type="pmid">28716546</pub-id></element-citation></ref><ref id="CR40"><label>40.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stegle</surname><given-names>O</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name></person-group><article-title>Computational and analytical challenges in single-cell transcriptomics</article-title><source>Nat. Rev. Genet.</source><year>2015</year><volume>16</volume><fpage>133</fpage><lpage>145</lpage><pub-id pub-id-type="doi">10.1038/nrg3833</pub-id><pub-id pub-id-type="pmid">25628217</pub-id></element-citation></ref><ref id="CR41"><label>41.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kharchenko</surname><given-names>PV</given-names></name><name><surname>Silberstein</surname><given-names>L</given-names></name><name><surname>Scadden</surname><given-names>DT</given-names></name></person-group><article-title>Bayesian approach to single-cell differential expression analysis</article-title><source>Nat. Methods</source><year>2014</year><volume>11</volume><fpage>740</fpage><lpage>742</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2967</pub-id><pub-id pub-id-type="pmid">24836921</pub-id></element-citation></ref><ref id="CR42"><label>42.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stuart</surname><given-names>Tim</given-names></name><name><surname>Butler</surname><given-names>Andrew</given-names></name><name><surname>Hoffman</surname><given-names>Paul</given-names></name><name><surname>Hafemeister</surname><given-names>Christoph</given-names></name><name><surname>Papalexi</surname><given-names>Efthymia</given-names></name><name><surname>Mauck</surname><given-names>William M.</given-names></name><name><surname>Hao</surname><given-names>Yuhan</given-names></name><name><surname>Stoeckius</surname><given-names>Marlon</given-names></name><name><surname>Smibert</surname><given-names>Peter</given-names></name><name><surname>Satija</surname><given-names>Rahul</given-names></name></person-group><article-title>Comprehensive Integration of Single-Cell Data</article-title><source>Cell</source><year>2019</year><volume>177</volume><issue>7</issue><fpage>1888-1902.e21</fpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id><pub-id pub-id-type="pmid">31178118</pub-id></element-citation></ref><ref id="CR43"><label>43.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soneson</surname><given-names>C</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name></person-group><article-title>Bias, robustness and scalability in single-cell differential expression analysis</article-title><source>Nat. Methods</source><year>2018</year><volume>15</volume><fpage>255</fpage><lpage>261</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4612</pub-id><pub-id pub-id-type="pmid">29481549</pub-id></element-citation></ref><ref id="CR44"><label>44.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clough</surname><given-names>E</given-names></name><name><surname>Barrett</surname><given-names>T</given-names></name></person-group><article-title>The Gene Expression Omnibus database</article-title><source>Methods Mol Biol</source><year>2016</year><volume>1418</volume><fpage>93</fpage><lpage>110</lpage><pub-id pub-id-type="doi">10.1007/978-1-4939-3578-9_5</pub-id><pub-id pub-id-type="pmid">27008011</pub-id></element-citation></ref><ref id="CR45"><label>45.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buenrostro</surname><given-names>Jason D.</given-names></name><name><surname>Corces</surname><given-names>M. Ryan</given-names></name><name><surname>Lareau</surname><given-names>Caleb A.</given-names></name><name><surname>Wu</surname><given-names>Beijing</given-names></name><name><surname>Schep</surname><given-names>Alicia N.</given-names></name><name><surname>Aryee</surname><given-names>Martin J.</given-names></name><name><surname>Majeti</surname><given-names>Ravindra</given-names></name><name><surname>Chang</surname><given-names>Howard Y.</given-names></name><name><surname>Greenleaf</surname><given-names>William J.</given-names></name></person-group><article-title>Integrated Single-Cell Analysis Maps the Continuous Regulatory Landscape of Human Hematopoietic Differentiation</article-title><source>Cell</source><year>2018</year><volume>173</volume><issue>6</issue><fpage>1535-1548.e16</fpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.03.074</pub-id><pub-id pub-id-type="pmid">29706549</pub-id></element-citation></ref><ref id="CR46"><label>46.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corces</surname><given-names>MR</given-names></name><etal/></person-group><article-title>Lineage-specific and single-cell chromatin accessibility charts human hematopoiesis and leukemia evolution</article-title><source>Nat. Genet.</source><year>2016</year><volume>48</volume><fpage>1193</fpage><lpage>1203</lpage><pub-id pub-id-type="doi">10.1038/ng.3646</pub-id><pub-id pub-id-type="pmid">27526324</pub-id></element-citation></ref><ref id="CR47"><label>47.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Satpathy</surname><given-names>AT</given-names></name><etal/></person-group><article-title>Transcript-indexed ATAC-seq for precision immune profiling</article-title><source>Nat. Med.</source><year>2018</year><volume>24</volume><fpage>580</fpage><lpage>590</lpage><pub-id pub-id-type="doi">10.1038/s41591-018-0008-8</pub-id><pub-id pub-id-type="pmid">29686426</pub-id></element-citation></ref><ref id="CR48"><label>48.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stoeckius</surname><given-names>M</given-names></name><etal/></person-group><article-title>Simultaneous epitope and transcriptome measurement in single cells</article-title><source>Nat. Methods</source><year>2017</year><volume>14</volume><fpage>865</fpage><lpage>868</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4380</pub-id><pub-id pub-id-type="pmid">28759029</pub-id></element-citation></ref><ref id="CR49"><label>49.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Maaten</surname><given-names>L</given-names></name><name><surname>Hinton</surname><given-names>G</given-names></name></person-group><article-title>Visualizing data using t-SNE</article-title><source>Journal of Machine Learning Research</source><year>2008</year><volume>9</volume><fpage>2579</fpage><lpage>2605</lpage></element-citation></ref><ref id="CR50"><label>50.</label><mixed-citation publication-type="other">Bhaduri A, Nowakowski TJ, Pollen AA, Kriegstein AR. Identification of cell types in a mouse brain single-cell atlas using low sampling coverage. <italic>BMC Biol</italic>. 2018;16.</mixed-citation></ref><ref id="CR51"><label>51.</label><mixed-citation publication-type="other">Li R. Quon G.scBFA R code. Zenodo. 10.5281/zenodo.3372766.</mixed-citation></ref><ref id="CR52"><label>52.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shalek</surname><given-names>AK</given-names></name><etal/></person-group><article-title>Single-cell RNA-seq reveals dynamic paracrine control of cellular variation</article-title><source>Nature</source><year>2014</year><volume>510</volume><fpage>363</fpage><lpage>369</lpage><pub-id pub-id-type="doi">10.1038/nature13437</pub-id><pub-id pub-id-type="pmid">24919153</pub-id></element-citation></ref><ref id="CR53"><label>53.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mayer</surname><given-names>C</given-names></name><etal/></person-group><article-title>Developmental diversification of cortical inhibitory interneurons</article-title><source>Nature</source><year>2018</year><volume>555</volume><fpage>457</fpage><lpage>462</lpage><pub-id pub-id-type="doi">10.1038/nature25999</pub-id><pub-id pub-id-type="pmid">29513653</pub-id></element-citation></ref><ref id="CR54"><label>54.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mann</surname><given-names>Mati</given-names></name><name><surname>Mehta</surname><given-names>Arnav</given-names></name><name><surname>de Boer</surname><given-names>Carl G.</given-names></name><name><surname>Kowalczyk</surname><given-names>Monika S.</given-names></name><name><surname>Lee</surname><given-names>Kevin</given-names></name><name><surname>Haldeman</surname><given-names>Pearce</given-names></name><name><surname>Rogel</surname><given-names>Noga</given-names></name><name><surname>Knecht</surname><given-names>Abigail R.</given-names></name><name><surname>Farouq</surname><given-names>Daneyal</given-names></name><name><surname>Regev</surname><given-names>Aviv</given-names></name><name><surname>Baltimore</surname><given-names>David</given-names></name></person-group><article-title>Heterogeneous Responses of Hematopoietic Stem Cells to Inflammatory Stimuli Are Altered with Age</article-title><source>Cell Reports</source><year>2018</year><volume>25</volume><issue>11</issue><fpage>2992-3005.e5</fpage><pub-id pub-id-type="doi">10.1016/j.celrep.2018.11.056</pub-id><pub-id pub-id-type="pmid">30540934</pub-id></element-citation></ref><ref id="CR55"><label>55.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gr&#x000fc;n</surname><given-names>D</given-names></name><etal/></person-group><article-title>Single-cell messenger RNA sequencing reveals rare intestinal cell types</article-title><source>Nature</source><year>2015</year><volume>525</volume><fpage>251</fpage><lpage>255</lpage><pub-id pub-id-type="doi">10.1038/nature14966</pub-id><pub-id pub-id-type="pmid">26287467</pub-id></element-citation></ref><ref id="CR56"><label>56.</label><mixed-citation publication-type="other">Patil VS, et al. Precursors of human CD4+ cytotoxic T lymphocytes identified by single-cell transcriptome analysis. <italic>Sci Immunol</italic>. 2018;3.</mixed-citation></ref><ref id="CR57"><label>57.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gr&#x000fc;n</surname><given-names>D</given-names></name><etal/></person-group><article-title>De novo prediction of stem cell identity using single-cell transcriptome data</article-title><source>Cell Stem Cell</source><year>2016</year><volume>19</volume><fpage>266</fpage><lpage>277</lpage><pub-id pub-id-type="doi">10.1016/j.stem.2016.05.010</pub-id><pub-id pub-id-type="pmid">27345837</pub-id></element-citation></ref><ref id="CR58"><label>58.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breton</surname><given-names>G</given-names></name><etal/></person-group><article-title>Human dendritic cells (DCs) are derived from distinct circulating precursors that are precommitted to become CD1c+ or CD141+ DCs</article-title><source>J. Exp. Med.</source><year>2016</year><volume>213</volume><fpage>2861</fpage><lpage>2870</lpage><pub-id pub-id-type="doi">10.1084/jem.20161135</pub-id><pub-id pub-id-type="pmid">27864467</pub-id></element-citation></ref><ref id="CR59"><label>59.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Qingyun</given-names></name><name><surname>Cheng</surname><given-names>Zuolin</given-names></name><name><surname>Zhou</surname><given-names>Lu</given-names></name><name><surname>Darmanis</surname><given-names>Spyros</given-names></name><name><surname>Neff</surname><given-names>Norma F.</given-names></name><name><surname>Okamoto</surname><given-names>Jennifer</given-names></name><name><surname>Gulati</surname><given-names>Gunsagar</given-names></name><name><surname>Bennett</surname><given-names>Mariko L.</given-names></name><name><surname>Sun</surname><given-names>Lu O.</given-names></name><name><surname>Clarke</surname><given-names>Laura E.</given-names></name><name><surname>Marschallinger</surname><given-names>Julia</given-names></name><name><surname>Yu</surname><given-names>Guoqiang</given-names></name><name><surname>Quake</surname><given-names>Stephen R.</given-names></name><name><surname>Wyss-Coray</surname><given-names>Tony</given-names></name><name><surname>Barres</surname><given-names>Ben A.</given-names></name></person-group><article-title>Developmental Heterogeneity of Microglia and Brain Myeloid Cells Revealed by Deep Single-Cell RNA Sequencing</article-title><source>Neuron</source><year>2019</year><volume>101</volume><issue>2</issue><fpage>207-223.e10</fpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.12.006</pub-id><pub-id pub-id-type="pmid">30606613</pub-id></element-citation></ref><ref id="CR60"><label>60.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lane</surname><given-names>Keara</given-names></name><name><surname>Van Valen</surname><given-names>David</given-names></name><name><surname>DeFelice</surname><given-names>Mialy M.</given-names></name><name><surname>Macklin</surname><given-names>Derek N.</given-names></name><name><surname>Kudo</surname><given-names>Takamasa</given-names></name><name><surname>Jaimovich</surname><given-names>Ariel</given-names></name><name><surname>Carr</surname><given-names>Ambrose</given-names></name><name><surname>Meyer</surname><given-names>Tobias</given-names></name><name><surname>Pe'er</surname><given-names>Dana</given-names></name><name><surname>Boutet</surname><given-names>St&#x000e9;phane C.</given-names></name><name><surname>Covert</surname><given-names>Markus W.</given-names></name></person-group><article-title>Measuring Signaling and RNA-Seq in the Same Cell Links Gene Expression to Dynamic Patterns of NF-&#x003ba;B Activation</article-title><source>Cell Systems</source><year>2017</year><volume>4</volume><issue>4</issue><fpage>458-469.e5</fpage><pub-id pub-id-type="doi">10.1016/j.cels.2017.03.010</pub-id><pub-id pub-id-type="pmid">28396000</pub-id></element-citation></ref><ref id="CR61"><label>61.</label><mixed-citation publication-type="other">Herman, J. S., Sagar, null &#x00026; Gr&#x000fc;n, D. FateID infers cell fate bias in multipotent progenitors from single-cell RNA-seq data. <italic>Nat. Methods</italic> 15, 379&#x02013;386 (2018).</mixed-citation></ref><ref id="CR62"><label>62.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nestorowa</surname><given-names>S</given-names></name><etal/></person-group><article-title>A single-cell resolution map of mouse hematopoietic stem and progenitor cell differentiation</article-title><source>Blood</source><year>2016</year><volume>128</volume><fpage>e20</fpage><lpage>e31</lpage><pub-id pub-id-type="doi">10.1182/blood-2016-05-716480</pub-id><pub-id pub-id-type="pmid">27365425</pub-id></element-citation></ref><ref id="CR63"><label>63.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buettner</surname><given-names>F</given-names></name><etal/></person-group><article-title>Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</article-title><source>Nat. Biotechnol.</source><year>2015</year><volume>33</volume><fpage>155</fpage><lpage>160</lpage><pub-id pub-id-type="doi">10.1038/nbt.3102</pub-id><pub-id pub-id-type="pmid">25599176</pub-id></element-citation></ref><ref id="CR64"><label>64.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koh</surname><given-names>PW</given-names></name><etal/></person-group><article-title>An atlas of transcriptional, chromatin accessibility, and surface marker changes in human mesoderm development</article-title><source>Sci Data</source><year>2016</year><volume>3</volume><fpage>160109</fpage><pub-id pub-id-type="doi">10.1038/sdata.2016.109</pub-id><pub-id pub-id-type="pmid">27996962</pub-id></element-citation></ref><ref id="CR65"><label>65.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kowalczyk</surname><given-names>MS</given-names></name><etal/></person-group><article-title>Single-cell RNA-seq reveals changes in cell cycle and differentiation programs upon aging of hematopoietic stem cells</article-title><source>Genome Res.</source><year>2015</year><volume>25</volume><fpage>1860</fpage><lpage>1872</lpage><pub-id pub-id-type="doi">10.1101/gr.192237.115</pub-id><pub-id pub-id-type="pmid">26430063</pub-id></element-citation></ref><ref id="CR66"><label>66.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schlitzer</surname><given-names>A</given-names></name><etal/></person-group><article-title>Identification of cDC1- and cDC2-committed DC progenitors reveals early lineage priming at the common DC progenitor stage in the bone marrow</article-title><source>Nat. Immunol.</source><year>2015</year><volume>16</volume><fpage>718</fpage><lpage>728</lpage><pub-id pub-id-type="doi">10.1038/ni.3200</pub-id><pub-id pub-id-type="pmid">26054720</pub-id></element-citation></ref><ref id="CR67"><label>67.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Li</given-names></name><name><surname>Dong</surname><given-names>Ji</given-names></name><name><surname>Yan</surname><given-names>Liying</given-names></name><name><surname>Yong</surname><given-names>Jun</given-names></name><name><surname>Liu</surname><given-names>Xixi</given-names></name><name><surname>Hu</surname><given-names>Yuqiong</given-names></name><name><surname>Fan</surname><given-names>Xiaoying</given-names></name><name><surname>Wu</surname><given-names>Xinglong</given-names></name><name><surname>Guo</surname><given-names>Hongshan</given-names></name><name><surname>Wang</surname><given-names>Xiaoye</given-names></name><name><surname>Zhu</surname><given-names>Xiaohui</given-names></name><name><surname>Li</surname><given-names>Rong</given-names></name><name><surname>Yan</surname><given-names>Jie</given-names></name><name><surname>Wei</surname><given-names>Yuan</given-names></name><name><surname>Zhao</surname><given-names>Yangyu</given-names></name><name><surname>Wang</surname><given-names>Wei</given-names></name><name><surname>Ren</surname><given-names>Yixin</given-names></name><name><surname>Yuan</surname><given-names>Peng</given-names></name><name><surname>Yan</surname><given-names>Zhiqiang</given-names></name><name><surname>Hu</surname><given-names>Boqiang</given-names></name><name><surname>Guo</surname><given-names>Fan</given-names></name><name><surname>Wen</surname><given-names>Lu</given-names></name><name><surname>Tang</surname><given-names>Fuchou</given-names></name><name><surname>Qiao</surname><given-names>Jie</given-names></name></person-group><article-title>Single-Cell RNA-Seq Analysis Maps Development of Human Germline Cells and Gonadal Niche Interactions</article-title><source>Cell Stem Cell</source><year>2017</year><volume>20</volume><issue>6</issue><fpage>858-873.e4</fpage><pub-id pub-id-type="doi">10.1016/j.stem.2017.05.009</pub-id><pub-id pub-id-type="pmid">28457750</pub-id></element-citation></ref><ref id="CR68"><label>68.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olsson</surname><given-names>A</given-names></name><etal/></person-group><article-title>Single-cell analysis of mixed-lineage states leading to a binary cell fate choice</article-title><source>Nature</source><year>2016</year><volume>537</volume><fpage>698</fpage><lpage>702</lpage><pub-id pub-id-type="doi">10.1038/nature19348</pub-id><pub-id pub-id-type="pmid">27580035</pub-id></element-citation></ref><ref id="CR69"><label>69.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petropoulos</surname><given-names>S</given-names></name><etal/></person-group><article-title>Single-cell RNA-Seq reveals lineage and X chromosome dynamics in human preimplantation embryos</article-title><source>Cell</source><year>2016</year><volume>165</volume><fpage>1012</fpage><lpage>1026</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2016.03.023</pub-id><pub-id pub-id-type="pmid">27062923</pub-id></element-citation></ref><ref id="CR70"><label>70.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Engel</surname><given-names>I</given-names></name><etal/></person-group><article-title>Innate-like functions of natural killer T cell subsets result from highly divergent gene programs</article-title><source>Nat. Immunol.</source><year>2016</year><volume>17</volume><fpage>728</fpage><lpage>739</lpage><pub-id pub-id-type="doi">10.1038/ni.3437</pub-id><pub-id pub-id-type="pmid">27089380</pub-id></element-citation></ref><ref id="CR71"><label>71.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname><given-names>Wei-Lin</given-names></name><name><surname>Zhang</surname><given-names>Yu-Wei</given-names></name><name><surname>Feng</surname><given-names>Ye</given-names></name><name><surname>Li</surname><given-names>Lin-Chen</given-names></name><name><surname>Yang</surname><given-names>Liu</given-names></name><name><surname>Xu</surname><given-names>Cheng-Ran</given-names></name></person-group><article-title>Deciphering Pancreatic Islet &#x003b2; Cell and &#x003b1; Cell Maturation Pathways and Characteristic Features at the Single-Cell Level</article-title><source>Cell Metabolism</source><year>2017</year><volume>25</volume><issue>5</issue><fpage>1194-1205.e4</fpage><pub-id pub-id-type="doi">10.1016/j.cmet.2017.04.003</pub-id><pub-id pub-id-type="pmid">28467935</pub-id></element-citation></ref><ref id="CR72"><label>72.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sloan</surname><given-names>Steven A.</given-names></name><name><surname>Darmanis</surname><given-names>Spyros</given-names></name><name><surname>Huber</surname><given-names>Nina</given-names></name><name><surname>Khan</surname><given-names>Themasap A.</given-names></name><name><surname>Birey</surname><given-names>Fikri</given-names></name><name><surname>Caneda</surname><given-names>Christine</given-names></name><name><surname>Reimer</surname><given-names>Richard</given-names></name><name><surname>Quake</surname><given-names>Stephen R.</given-names></name><name><surname>Barres</surname><given-names>Ben A.</given-names></name><name><surname>Pa&#x0015f;ca</surname><given-names>Sergiu P.</given-names></name></person-group><article-title>Human Astrocyte Maturation Captured in 3D Cerebral Cortical Spheroids Derived from Pluripotent Stem Cells</article-title><source>Neuron</source><year>2017</year><volume>95</volume><issue>4</issue><fpage>779-790.e6</fpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.07.035</pub-id><pub-id pub-id-type="pmid">28817799</pub-id></element-citation></ref><ref id="CR73"><label>73.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loh</surname><given-names>KM</given-names></name><etal/></person-group><article-title>Mapping the pairwise choices leading from pluripotency to human bone, heart, and other mesoderm cell types</article-title><source>Cell</source><year>2016</year><volume>166</volume><fpage>451</fpage><lpage>467</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2016.06.011</pub-id><pub-id pub-id-type="pmid">27419872</pub-id></element-citation></ref><ref id="CR74"><label>74.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hochgerner</surname><given-names>H</given-names></name><etal/></person-group><article-title>STRT-seq-2i: dual-index 5&#x02019; single cell and nucleus RNA-seq on an addressable microwell array</article-title><source>Sci Rep</source><year>2017</year><volume>7</volume><fpage>16327</fpage><pub-id pub-id-type="doi">10.1038/s41598-017-16546-4</pub-id><pub-id pub-id-type="pmid">29180631</pub-id></element-citation></ref><ref id="CR75"><label>75.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mu&#x000f1;oz-Manchado</surname><given-names>Ana B.</given-names></name><name><surname>Bengtsson Gonzales</surname><given-names>Carolina</given-names></name><name><surname>Zeisel</surname><given-names>Amit</given-names></name><name><surname>Munguba</surname><given-names>Hermany</given-names></name><name><surname>Bekkouche</surname><given-names>Bo</given-names></name><name><surname>Skene</surname><given-names>Nathan G.</given-names></name><name><surname>L&#x000f6;nnerberg</surname><given-names>Peter</given-names></name><name><surname>Ryge</surname><given-names>Jesper</given-names></name><name><surname>Harris</surname><given-names>Kenneth D.</given-names></name><name><surname>Linnarsson</surname><given-names>Sten</given-names></name><name><surname>Hjerling-Leffler</surname><given-names>Jens</given-names></name></person-group><article-title>Diversity of Interneurons in the Dorsal Striatum Revealed by Single-Cell RNA Sequencing and PatchSeq</article-title><source>Cell Reports</source><year>2018</year><volume>24</volume><issue>8</issue><fpage>2179-2190.e7</fpage><pub-id pub-id-type="doi">10.1016/j.celrep.2018.07.053</pub-id><pub-id pub-id-type="pmid">30134177</pub-id></element-citation></ref><ref id="CR76"><label>76.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zemmour</surname><given-names>D</given-names></name><etal/></person-group><article-title>Single-cell gene expression reveals a landscape of regulatory T cell phenotypes shaped by the TCR</article-title><source>Nat. Immunol.</source><year>2018</year><volume>19</volume><fpage>291</fpage><lpage>301</lpage><pub-id pub-id-type="doi">10.1038/s41590-018-0051-0</pub-id><pub-id pub-id-type="pmid">29434354</pub-id></element-citation></ref><ref id="CR77"><label>77.</label><mixed-citation publication-type="other">Tian, L. <italic>et al.</italic> SIS-seq, a molecular &#x02018;time machine&#x02019;, connects single cell fate with gene programs. <italic>bioRxiv</italic> 403113 (2018). doi:10.1101/403113</mixed-citation></ref><ref id="CR78"><label>78.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dueck</surname><given-names>H</given-names></name><etal/></person-group><article-title>Deep sequencing reveals cell-type-specific patterns of single-cell transcriptome variation</article-title><source>Genome Biol.</source><year>2015</year><volume>16</volume><fpage>122</fpage><pub-id pub-id-type="doi">10.1186/s13059-015-0683-4</pub-id><pub-id pub-id-type="pmid">26056000</pub-id></element-citation></ref><ref id="CR79"><label>79.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tirosh</surname><given-names>I</given-names></name><etal/></person-group><article-title>Dissecting the multicellular ecosystem of metastatic melanoma by single-cell RNA-seq</article-title><source>Science</source><year>2016</year><volume>352</volume><fpage>189</fpage><lpage>196</lpage><pub-id pub-id-type="doi">10.1126/science.aad0501</pub-id><pub-id pub-id-type="pmid">27124452</pub-id></element-citation></ref><ref id="CR80"><label>80.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Long</surname><given-names>S. A.</given-names></name><name><surname>Thorpe</surname><given-names>J.</given-names></name><name><surname>DeBerg</surname><given-names>H. A.</given-names></name><name><surname>Gersuk</surname><given-names>V.</given-names></name><name><surname>Eddy</surname><given-names>J. A.</given-names></name><name><surname>Harris</surname><given-names>K. M.</given-names></name><name><surname>Ehlers</surname><given-names>M.</given-names></name><name><surname>Herold</surname><given-names>K. C.</given-names></name><name><surname>Nepom</surname><given-names>G. T.</given-names></name><name><surname>Linsley</surname><given-names>P. S.</given-names></name></person-group><article-title>Partial exhaustion of CD8 T cells and clinical response to teplizumab in new-onset type 1 diabetes</article-title><source>Science Immunology</source><year>2016</year><volume>1</volume><issue>5</issue><fpage>eaai7793</fpage><lpage>eaai7793</lpage><pub-id pub-id-type="doi">10.1126/sciimmunol.aai7793</pub-id><pub-id pub-id-type="pmid">28664195</pub-id></element-citation></ref><ref id="CR81"><label>81.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yao</surname><given-names>Z</given-names></name><etal/></person-group><article-title>A single-cell roadmap of lineage bifurcation in human ESC models of embryonic brain development</article-title><source>Cell Stem Cell</source><year>2017</year><volume>20</volume><fpage>120</fpage><lpage>134</lpage><pub-id pub-id-type="doi">10.1016/j.stem.2016.09.011</pub-id><pub-id pub-id-type="pmid">28094016</pub-id></element-citation></ref><ref id="CR82"><label>82.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pal</surname><given-names>B</given-names></name><etal/></person-group><article-title>Construction of developmental lineage relationships in the mouse mammary gland by single-cell RNA profiling</article-title><source>Nat Commun</source><year>2017</year><volume>8</volume><fpage>1627</fpage><pub-id pub-id-type="doi">10.1038/s41467-017-01560-x</pub-id><pub-id pub-id-type="pmid">29158510</pub-id></element-citation></ref><ref id="CR83"><label>83.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vanlandewijck</surname><given-names>M</given-names></name><etal/></person-group><article-title>A molecular atlas of cell types and zonation in the brain vasculature</article-title><source>Nature</source><year>2018</year><volume>554</volume><fpage>475</fpage><lpage>480</lpage><pub-id pub-id-type="doi">10.1038/nature25739</pub-id><pub-id pub-id-type="pmid">29443965</pub-id></element-citation></ref><ref id="CR84"><label>84.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hochgerner</surname><given-names>H</given-names></name><name><surname>Zeisel</surname><given-names>A</given-names></name><name><surname>L&#x000f6;nnerberg</surname><given-names>P</given-names></name><name><surname>Linnarsson</surname><given-names>S</given-names></name></person-group><article-title>Conserved properties of dentate gyrus neurogenesis across postnatal development revealed by single-cell RNA sequencing</article-title><source>Nat. Neurosci.</source><year>2018</year><volume>21</volume><fpage>290</fpage><lpage>299</lpage><pub-id pub-id-type="doi">10.1038/s41593-017-0056-2</pub-id><pub-id pub-id-type="pmid">29335606</pub-id></element-citation></ref><ref id="CR85"><label>85.</label><mixed-citation publication-type="other">La Manno, G. <italic>et al.</italic> Molecular diversity of midbrain development in mouse, human, and stem cells. <italic>Cell</italic> 167, 566-580.e19 (2016).</mixed-citation></ref><ref id="CR86"><label>86.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>KD</given-names></name><etal/></person-group><article-title>Classes and continua of hippocampal CA1 inhibitory neurons revealed by single-cell transcriptomics</article-title><source>PLoS Biol.</source><year>2018</year><volume>16</volume><fpage>e2006387</fpage><pub-id pub-id-type="doi">10.1371/journal.pbio.2006387</pub-id><pub-id pub-id-type="pmid">29912866</pub-id></element-citation></ref><ref id="CR87"><label>87.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kumar</surname><given-names>RM</given-names></name><etal/></person-group><article-title>Deconstructing transcriptional heterogeneity in pluripotent stem cells</article-title><source>Nature</source><year>2014</year><volume>516</volume><fpage>56</fpage><lpage>61</lpage><pub-id pub-id-type="doi">10.1038/nature13920</pub-id><pub-id pub-id-type="pmid">25471879</pub-id></element-citation></ref><ref id="CR88"><label>88.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>F</given-names></name><etal/></person-group><article-title>The Transcriptome and DNA methylome landscapes of human primordial germ cells</article-title><source>Cell</source><year>2015</year><volume>161</volume><fpage>1437</fpage><lpage>1452</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.05.015</pub-id><pub-id pub-id-type="pmid">26046443</pub-id></element-citation></ref><ref id="CR89"><label>89.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burns</surname><given-names>JC</given-names></name><name><surname>Kelly</surname><given-names>MC</given-names></name><name><surname>Hoa</surname><given-names>M</given-names></name><name><surname>Morell</surname><given-names>RJ</given-names></name><name><surname>Kelley</surname><given-names>MW</given-names></name></person-group><article-title>Single-cell RNA-Seq resolves cellular complexity in sensory organs from the neonatal inner ear</article-title><source>Nat Commun</source><year>2015</year><volume>6</volume><fpage>8557</fpage><pub-id pub-id-type="doi">10.1038/ncomms9557</pub-id><pub-id pub-id-type="pmid">26469390</pub-id></element-citation></ref><ref id="CR90"><label>90.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patel</surname><given-names>AP</given-names></name><etal/></person-group><article-title>Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma</article-title><source>Science</source><year>2014</year><volume>344</volume><fpage>1396</fpage><lpage>1401</lpage><pub-id pub-id-type="doi">10.1126/science.1254257</pub-id><pub-id pub-id-type="pmid">24925914</pub-id></element-citation></ref></ref-list></back></article>