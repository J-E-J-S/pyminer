<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Med Genomics</journal-id><journal-id journal-id-type="iso-abbrev">BMC Med Genomics</journal-id><journal-title-group><journal-title>BMC Medical Genomics</journal-title></journal-title-group><issn pub-type="epub">1755-8794</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6679440</article-id><article-id pub-id-type="publisher-id">557</article-id><article-id pub-id-type="doi">10.1186/s12920-019-0557-9</article-id><article-categories><subj-group subj-group-type="heading"><subject>Technical Advance</subject></subj-group></article-categories><title-group><article-title>Identification of single nucleotide variants using position-specific error estimation in deep sequencing data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Kleftogiannis</surname><given-names>Dimitrios</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff6">6</xref></contrib><contrib contrib-type="author"><name><surname>Punta</surname><given-names>Marco</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Jayaram</surname><given-names>Anuradha</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Sandhu</surname><given-names>Shahneen</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Wong</surname><given-names>Stephen Q.</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Gasi Tandefelt</surname><given-names>Delila</given-names></name><xref ref-type="aff" rid="Aff4">4</xref></contrib><contrib contrib-type="author"><name><surname>Conteduca</surname><given-names>Vincenza</given-names></name><xref ref-type="aff" rid="Aff5">5</xref></contrib><contrib contrib-type="author"><name><surname>Wetterskog</surname><given-names>Daniel</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Attard</surname><given-names>Gerhardt</given-names></name><address><email>g.attard@ucl.ac.uk</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4472-6893</contrib-id><name><surname>Lise</surname><given-names>Stefano</given-names></name><address><email>Stefano.Lise@icr.ac.uk</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 1271 4623</institution-id><institution-id institution-id-type="GRID">grid.18886.3f</institution-id><institution>Centre for Evolution and Cancer, </institution><institution>The Institute of Cancer Research, </institution></institution-wrap>London, UK </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000000121901201</institution-id><institution-id institution-id-type="GRID">grid.83440.3b</institution-id><institution>UCL Cancer Institute, University College London, </institution></institution-wrap>London, UK </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000000403978434</institution-id><institution-id institution-id-type="GRID">grid.1055.1</institution-id><institution>Peter MacCallum Cancer Centre and University of Melbourne, </institution></institution-wrap>Melbourne, Victoria Australia </aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9919 9582</institution-id><institution-id institution-id-type="GRID">grid.8761.8</institution-id><institution>Department of Urology, Sahlgrenska Academy, </institution><institution>University of Gothenburg, </institution></institution-wrap>Gothenburg, Sweden </aff><aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1755 9177</institution-id><institution-id institution-id-type="GRID">grid.419563.c</institution-id><institution>Department of Medical Oncology, </institution><institution>Istituto Scientifico Romagnolo per lo Studio e la Cura dei Tumori (IRST) IRCCS, </institution></institution-wrap>47014 Meldola, Italy </aff><aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0620 715X</institution-id><institution-id institution-id-type="GRID">grid.418377.e</institution-id><institution>Present address: Genome Institute of Singapore (GIS), Agency of Science Research and Technology (A*STAR), </institution></institution-wrap>Singapore, 138672 Singapore </aff></contrib-group><pub-date pub-type="epub"><day>2</day><month>8</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>2</day><month>8</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>12</volume><elocation-id>115</elocation-id><history><date date-type="received"><day>21</day><month>11</month><year>2018</year></date><date date-type="accepted"><day>15</day><month>7</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s). 2019</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p id="Par1">Targeted deep sequencing is a highly effective technology to identify known and novel single nucleotide variants (SNVs) with many applications in translational medicine, disease monitoring and cancer profiling. However, identification of SNVs using deep sequencing data is a challenging computational problem as different sequencing artifacts limit the analytical sensitivity of SNV detection, especially at low variant allele frequencies (VAFs).</p></sec><sec><title>Methods</title><p id="Par2">To address the problem of relatively high noise levels in amplicon-based deep sequencing data (e.g. with the Ion AmpliSeq technology) in the context of SNV calling, we have developed a new bioinformatics tool called AmpliSolve. AmpliSolve uses a set of normal samples to model position-specific, strand-specific and nucleotide-specific background artifacts (noise), and deploys a Poisson model-based statistical framework for SNV detection.</p></sec><sec><title>Results</title><p id="Par3">Our tests on both synthetic and real data indicate that AmpliSolve achieves a good trade-off between precision and sensitivity, even at VAF below 5% and as low as 1%. We further validate AmpliSolve by applying it to the detection of SNVs in 96 circulating tumor DNA samples at three clinically relevant genomic positions and compare the results to digital droplet PCR experiments.</p></sec><sec><title>Conclusions</title><p id="Par4">AmpliSolve is a new tool for <italic>in-silico</italic> estimation of background noise and for detection of low frequency SNVs in targeted deep sequencing data. Although AmpliSolve has been specifically designed for and tested on amplicon-based libraries sequenced with the Ion Torrent platform it can, in principle, be applied to other sequencing platforms as well. AmpliSolve is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/dkleftogi/AmpliSolve">https://github.com/dkleftogi/AmpliSolve</ext-link>.</p></sec><sec><title>Electronic supplementary material</title><p>The online version of this article (10.1186/s12920-019-0557-9) contains supplementary material, which is available to authorized users.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Next generation sequencing (NGS)</kwd><kwd>Cancer genomics</kwd><kwd>Variant calling</kwd><kwd>Deep sequencing</kwd><kwd>Targeted sequencing</kwd><kwd>Ion torrent</kwd><kwd>Liquid biopsies</kwd><kwd>Error correction</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004440</institution-id><institution>Wellcome Trust</institution></institution-wrap></funding-source><award-id>105104/Z/14/</award-id></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000771</institution-id><institution>Prostate Cancer UK</institution></institution-wrap></funding-source><award-id>PG12-49</award-id><principal-award-recipient><name><surname>Attard</surname><given-names>Gerhardt</given-names></name></principal-award-recipient></award-group></funding-group><funding-group><award-group><funding-source><institution>Cancer Research UK</institution></funding-source><award-id>A13239</award-id><principal-award-recipient><name><surname>Attard</surname><given-names>Gerhardt</given-names></name></principal-award-recipient></award-group></funding-group><funding-group><award-group><funding-source><institution>European Society of Medical Oncology</institution></funding-source></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000265</institution-id><institution>Medical Research Council</institution></institution-wrap></funding-source></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100011264</institution-id><institution>FP7 People: Marie-Curie Actions</institution></institution-wrap></funding-source></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2019</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p id="Par20">Targeted next-generation sequencing (NGS) is a powerful technology to identify known and novel variants in selected genomic regions of interest [<xref ref-type="bibr" rid="CR1">1</xref>]. It allows achieving high coverage levels (i.e., higher than 1000x) and, in principle, to confidently identify variants even when they occur at low allele frequencies. This is particularly important in cancer research and has many clinical applications, e.g. in relation to disease management. Typically, tumors are heterogeneous consisting of multiple clones and sub-clones the relative abundance of which can change over time depending on several factors, including treatment [<xref ref-type="bibr" rid="CR2">2</xref>]. Identification of low frequency mutations is clinically relevant, among other reasons, for early diagnosis, disease monitoring and timely detection of the emergence of resistance clones under treatment [<xref ref-type="bibr" rid="CR3">3</xref>].</p><p id="Par21">Over the past years, it has been established that cancer patients&#x02019; circulating free DNA (cfDNA) contains tumor-derived DNA fragments (ctDNA) that can be used as an alternative to solid biopsies in clinical settings [<xref ref-type="bibr" rid="CR4">4</xref>]. However, identifying cancer-specific mutations in liquid biopsy samples is challenging, as the relative proportion of ctDNA in cfDNA can be low, especially at cancer&#x02019;s early stages. There are also several sources of sequencing errors including PCR artifacts, often reaching up to 1% Variant Allele Frequency (VAF), that reduce further the analytical sensitivity for detecting cancer-associated mutations [<xref ref-type="bibr" rid="CR4">4</xref>]. Error correction techniques can be incorporated into NGS assays enabling ultra-sensitive single nucleotide variant (SNV) detection (VAF ~&#x02009;0.1%) but at a significant extra cost [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. Thus, there is a need to reliably detect SNVs in more conventional deep sequencing data.</p><p id="Par22">In-silico identification of SNVs from NGS data is a well-studied problem [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. However, the majority of existing variant calling programs have been designed for whole-exome and whole-genome experiments sequenced at coverage of approximately 30x to 100x. At the same time, available variant calling software for targeted deep sequencing experiments have been typically developed for and tested on Illumina data [<xref ref-type="bibr" rid="CR9">9</xref>].</p><p id="Par23">Compared to Illumina, Ion Torrent sequencing has a higher per base error rate and an associated lower accuracy in identifying mutations [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. However, it has the advantage of requiring lower amounts of input DNA and it offers both reduced cost and turnaround time. Thus, it is a cost-effective strategy for screening large cohorts of patients and it is particularly suited for point-of-care clinical applications [<xref ref-type="bibr" rid="CR1">1</xref>], for example in conjunction with the Ion AmpliSeq Cancer Hotspot Panel. Given its translational potential, there is a real need to improve the variant calling workflow and recently a number of methods have been developed to deal specifically with Ion Torrent data [<xref ref-type="bibr" rid="CR12">12</xref>&#x02013;<xref ref-type="bibr" rid="CR14">14</xref>].</p><p id="Par24">Here we introduce AmpliSolve, a new bioinformatics method to detect SNVs in targeted deep sequencing data. It combines <italic>in-silico</italic> background error estimation with statistical modeling and it is particularly suited to deal with data of comparatively high noise levels, similar to the ones produced by the Ion AmpliSeq library preparation. In order to estimate background noise levels per position, strand and nucleotide substitution, AmpliSolve takes as input deep-sequencing data from a set of normal samples. This information is then fed to a Poisson model for the identification of SNVs. Experimental results using normal samples (self-consistency test), synthetic variants and clinical data sequenced with a custom Ion AmpliSeq gene panel, demonstrate that AmpliSolve achieves a good trade-off between precision and sensitivity, even for VAF values below 5% and as low as 1%.</p></sec><sec id="Sec2"><title>Methods</title><sec id="Sec3"><title>Method overview</title><p id="Par25">AmpliSolve consists of two main programs written in C++: AmpliSolveErrorEstimation and AmpliSolveVariantCalling. AmpliSolveErrorEstimation requires the availability of a set of normal samples processed with the deep sequencing platform and panel of choice. Here, we focus on the Ion Torrent Personal Genome Machine (PGM) and a custom AmpliSeq panel, a technology known to have relatively high rates of sequencing error compared to others. The program uses the normal samples to infer position-specific, nucleotide specific and strand-specific background sequencing error levels (noise) across the targeted regions. Execution of AmpliSolveErrorEstimation is performed only once per panel design. Error estimates are then used as input to the AmpliSolveVariantCalling program for SNVs&#x02019; detection. The procedures for <italic>in-silico</italic> noise estimation and SNV identification are described below. In Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> we present a graphical overview of the AmpliSolve computational workflow.<fig id="Fig1"><label>Fig. 1</label><caption><p>Graphical representation of AmpliSolve&#x02019;s workflow for estimating the noise levels and detecting SNVs. The workflow comprises the following steps: <bold>a</bold> Screening the available normal samples to identify reads supporting alleles other than the reference. <bold>b</bold> Error estimation per position, per nucleotide and per strand for all positions in the gene panel based on the distribution of alternative allele counts in (<bold>a</bold>); only alternative counts corresponding to VAF&#x02009;&#x0003c;&#x02009;5% are taken into consideration; <bold>c</bold> For each genomic position in a tumor sample, the method identifies the total coverage of the position and the number of reads supporting the alternative alleles, if any. <bold>d</bold> Given the information from steps <bold>b</bold> and <bold>c</bold> the method applies a Poisson distribution-based model to compute the <italic>p</italic>-value that the variant (red line) is real. This <italic>p</italic>-value is then transformed to a quality score that is used by AmpliSolve together with additional quality criteria to identify SNVs</p></caption><graphic xlink:href="12920_2019_557_Fig1_HTML" id="MO1"/></fig></p></sec><sec id="Sec4"><title><italic>In-silico</italic> identification of the background sequencing error</title><p id="Par26">Our strategy for estimating background error levels, implemented in the AmpliSolveErrorEstimation program, is based on the assumption that alternative alleles observed at VAF&#x02009;&#x0003c;&#x02009;5% in normal samples are, in the majority of cases, the result of sequencing errors (see Additional&#x000a0;file&#x000a0;<xref rid="MOESM2" ref-type="media">2</xref>: Figure S1 for the distribution of non-reference allele frequencies in normal samples showing the separation between heterozygous germline variants and lower frequency &#x02018;noise&#x02019; variants). Accordingly, we utilize a set of normal samples to estimate background noise in our custom panel. Notably, we estimate error levels separately for each genomic position, each nucleotide (alternative allele) and each of the two (forward and reverse) strands. In particular, for each genomic position we generate six error estimates (i.e. two each for the three alternative alleles). Error estimates are fed to a Poisson model, which is then used to calculate the <italic>p</italic>-value of the observed substitutions representing true variants versus them being noise. The detailed implementation is as follows. We first extract &#x0201c;raw&#x0201d; counts for each position, alternative allele and strand from the BAM files [<xref ref-type="bibr" rid="CR15">15</xref>] of a set of N normal samples using the ASEQ software [<xref ref-type="bibr" rid="CR16">16</xref>]. We run ASEQ with the quality parameters suggested by the authors of a previous study based on Ion AmpliSeq data [<xref ref-type="bibr" rid="CR17">17</xref>], namely: minimum base quality&#x02009;=&#x02009;20, minimum read quality&#x02009;=&#x02009;20 and minimum read coverage&#x02009;=&#x02009;20. At every genomic position, we estimate the background error <italic>s</italic> separately for each alternative allele <italic>&#x003b1;</italic> and strand (<italic>+</italic> or <italic>-</italic>) by calculating the fraction of reads carrying the alternative allele on a given strand across all normal samples. More specifically we use the following formula:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {s}^{\alpha, +/-}=\frac{Er^{\alpha, +/-}}{{Er d}^{+/-}}+C $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mo>/</mml:mo><mml:mo>&#x02212;</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi mathvariant="italic">Er</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mo>/</mml:mo><mml:mo>&#x02212;</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="italic">Erd</mml:mi><mml:mrow><mml:mo>+</mml:mo><mml:mo>/</mml:mo><mml:mo>&#x02212;</mml:mo></mml:mrow></mml:msup></mml:mfrac><mml:mo>+</mml:mo><mml:mi>C</mml:mi></mml:math><graphic xlink:href="12920_2019_557_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par27">with<disp-formula id="Equ2"><label>1a</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {Er}^{\alpha, +/-}=\sum \limits_{i=1}^N{R}_i^{\alpha, +/-} $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:msup><mml:mi mathvariant="italic">Er</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mo>/</mml:mo><mml:mo>&#x02212;</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msubsup><mml:mi>R</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mo>/</mml:mo><mml:mo>&#x02212;</mml:mo></mml:mrow></mml:msubsup></mml:math><graphic xlink:href="12920_2019_557_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par28">and<disp-formula id="Equ3"><label>1b</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {Erd}^{+/-}=\sum \limits_{i=1}^N{RD}_i^{+/-} $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:msup><mml:mi mathvariant="italic">Erd</mml:mi><mml:mrow><mml:mo>+</mml:mo><mml:mo>/</mml:mo><mml:mo>&#x02212;</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msubsup><mml:mi mathvariant="italic">RD</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo>+</mml:mo><mml:mo>/</mml:mo><mml:mo>&#x02212;</mml:mo></mml:mrow></mml:msubsup></mml:math><graphic xlink:href="12920_2019_557_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par29">We denote with R<sub>i</sub><sup>&#x003b1;,+</sup> and R<sub>i</sub><sup>&#x003b1;,-</sup> the number of reads supporting the alternative allele &#x003b1; on the forward and reverse strand, respectively, in normal sample <italic>i</italic>. We denote with RD<sub>i</sub><sup>+</sup> and RD<sub>i</sub><sup>&#x02212;</sup> the total number of reads (read depth) at the genomic position of interest on the forward and reverse strand, respectively, in normal sample <italic>i</italic>. Summations are taken over all normal samples utilized for the error estimation. C in eq. (<xref rid="Equ1" ref-type="">1</xref>) is a constant pseudo-count parameter that is introduced to mitigate the problem of positions in which the alternative allele read count might be underestimated (e.g. due to a relatively low read depth at a given position in the normal samples). In the Results section we test values of C in the range from 10<sup>&#x02212;&#x02009;5</sup> to 2&#x02022;10<sup>&#x02212;&#x02009;2</sup>.</p><p id="Par30">When calculating the summations in (1a) and (1b), we apply two filters that aim to increase the quality of the error estimation at specific positions and for specific alternative alleles <italic>&#x003b1;</italic> at that position. First, at a given position, samples for which an alternative allele <italic>&#x003b1;</italic> has VAF&#x02009;&#x0003e;&#x02009;5% are not considered at that position&#x000a0;for that particular allele. This is because a frequency greater than 5% is likely to indicate, in that sample, either the presence of a real variant (i.e. a single nucleotide polymorphism) or a particularly noisy &#x02018;read-out&#x02019;. Second, samples that at a given position have coverage lower than a predefined threshold either on the forward or on the reverse strand are not considered for computing <italic>Er</italic><sup><italic>&#x003b1;</italic>,&#x02009;+&#x02009;/&#x02212;</sup> (1a) and <italic>Erd</italic><sup>+/&#x02212;</sup> (1b) for any allele <italic>&#x003b1;</italic> at that position. In the following we use a threshold of 100 reads which, in our case, typically excludes 5% of sites per sample (see Additional&#x000a0;file&#x000a0;<xref rid="MOESM3" ref-type="media">3</xref>: Figure S2); however, this parameter can be adjusted depending on the study design. After applying these filters, positions and alternative alleles for which 2/3 or more of the normal samples cannot be used for calculating the summations in (1a) and (1b) are considered non-callable. We note that among non-callable cases there may be positions with alleles that are either frequent in the population or simply over-represented in the specific set of normal samples used for the error estimation. However, given that AmpliSolve main goal is the identification of somatic mutations this does not constitute a major limitation.</p></sec><sec id="Sec5"><title>SNV detection using a cumulative Poisson distribution</title><p id="Par31">Given a sample of interest, for every alternative allele <italic>&#x003b1;</italic> featuring a non-zero strand-specific (+ or &#x02013;) variant read count <italic>k</italic><sup><italic>&#x003b1;</italic>,&#x02009;+&#x02009;/&#x02212;</sup>, the AmpliSolveVariantCalling program uses a Poisson model to calculate the probability that <italic>k</italic><sup><italic>&#x003b1;</italic>,&#x02009;+&#x02009;/&#x02212;</sup> or more variant reads are produced by sequencing errors, i.e. the <italic>p</italic>-value. Only positions that, in the sample of interest, have read depth on each strand higher than a pre-assigned threshold <italic>RD</italic><sub><italic>min</italic></sub> are considered (in the following, we set <italic>RD</italic><sub><italic>min</italic></sub>&#x02009;=&#x02009;100 unless otherwise specified). At these positions, the calculated p-value is a function of the normal sample-based sequencing error <italic>s</italic><sup><italic>&#x003b1;</italic>,&#x02009;+&#x02009;/&#x02212;</sup> from the previous section and of both the number of variant reads <italic>k</italic><sup><italic>&#x003b1;</italic>,&#x02009;+&#x02009;/&#x02212;</sup> and the strand-specific read depth <italic>K</italic><sup><italic>+/&#x02212;</italic></sup> in the sample of interest (<italic>K</italic><sup><italic>+/&#x02212;</italic></sup>&#x000a0;<italic>&#x0003e;&#x02009;RD</italic><sub><italic>min</italic></sub>). In particular:<disp-formula id="Equ4"><label>2</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ p- value\left( variant\ \right|\ {k}^{\alpha, +/-},{K}^{+/-},{s}^{\alpha, +/-}\Big)=1-{e}^{-K\ast s}\sum \limits_{i=0}^{k-1}\frac{{\left(K\ast s\right)}^i}{i!} $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mi>p</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mtext mathvariant="italic">value</mml:mtext><mml:mfenced close="|" open="("><mml:mrow><mml:mtext mathvariant="italic">variant</mml:mtext><mml:mspace width="0.25em"/></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mo>/</mml:mo><mml:mo>&#x02212;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>+</mml:mo><mml:mo>/</mml:mo><mml:mo>&#x02212;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mo>/</mml:mo><mml:mo>&#x02212;</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>K</mml:mi><mml:mo>&#x02217;</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mfrac><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>K</mml:mi><mml:mo>&#x02217;</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mfenced><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mi>i</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12920_2019_557_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par32">Where, for better readability, on the right side of the equation we have omitted all <italic>&#x003b1;</italic> symbols for k and s, as well as, +/&#x02212; symbols for k, K and s. We observe that <italic>K*s</italic> is the expected number of random substitutions for a depth of coverage <italic>K</italic> or the mean of the Poisson distribution. Note that <italic>p</italic>-values are not corrected for multiple testing. The strand-specific p-values are finally converted to quality scores using the formula <italic>Q&#x02009;=&#x02009;-10*log10(p-value)</italic>. In its output, for all positions in the panel carrying substitutions with Q score equal to or greater than 5 on both strands, AmpliSolve reports the average Q score between the two strands. Vice versa, positions with no substitutions or with substitutions with associated Q score lower than 5 on one or both strands are not reported in AmpliSolve&#x02019;s output. All reported SNVs are further tested for and potentially assigned one or more of the following warning flags:<list list-type="alpha-lower"><list-item><p id="Par33">&#x02018;LowQ&#x02019; if the Q score is lower than 20 in at least one of the two strands.</p></list-item><list-item><p id="Par34">&#x02018;LowSupportingReads&#x02019; if the SNV is supported by less than 5 reads per strand in the tumor samples being analysed.</p></list-item><list-item><p id="Par35">&#x02018;AmpliconEdge&#x02019; if the SNV is located within overlapping amplicon edge regions, which may result in sequencing artifacts.</p></list-item><list-item><p id="Par36">&#x02018;StrandBias&#x02019; if the SNV is associated to a strand-bias. We apply Fisher&#x02019;s exact test to each SNV under the null hypothesis that the number of forward and reverse reads supporting the variant should be proportional to the total number of reads sequenced in the forward and reverse strands, respectively. The flag is assigned to substitutions for which the <italic>p</italic>-value of the Fisher&#x02019;s exact test is lower than a pre-defined value <italic>SB</italic><sub><italic>th</italic></sub>. In the following we set <italic>SB</italic><sub><italic>th</italic></sub>&#x02009;=&#x02009;0.05 (unless otherwise specified).</p></list-item><list-item><p id="Par37">&#x02018;HomoPolymerRegion&#x02019; if the SNV is located within a homopolymer region using the same criteria as in [<xref ref-type="bibr" rid="CR18">18</xref>].</p></list-item><list-item><p id="Par38">&#x02018;PositionWithHighNoise&#x02019; if the SNV is supported by more than 5 reads per strand but the associated VAF is lower than the maximum VAF at this position across all normal samples in the training set.</p></list-item></list></p><p id="Par39">If no warning is issued, AmpliSolve assigns a &#x02018;PASS&#x02019; flag to the SNV.</p></sec><sec id="Sec6"><title>Performance measures</title><p id="Par40">To assess AmpliSolve&#x02019;s success in detecting SNVs, we use a number of performance metrics:<list list-type="order"><list-item><p id="Par41">Sensitivity or True Positive Rate (TPR)&#x02009;=&#x02009;TP / (TP&#x02009;+&#x02009;FN)</p></list-item><list-item><p id="Par42">Precision or Positive Predictive Value (PPV)&#x02009;=&#x02009;TP/(TP&#x02009;+&#x02009;FP)</p></list-item><list-item><p id="Par43">False Discovery Rate (FDR)&#x02009;=&#x02009;1-PPV=FP / (FP&#x02009;+&#x02009;TP)</p></list-item><list-item><p id="Par44">Harmonic mean of Precision and Sensitivity (F1)&#x02009;=&#x02009;2*TP / (2*TP&#x02009;+&#x02009;FP&#x02009;+&#x02009;FN)</p></list-item></list></p><p id="Par45">Where, TP is the number of True Positive predictions, FN is the number of False Negative predictions and FP is the number of False Positive predictions.</p></sec><sec id="Sec7"><title>Clinical data used in this study</title><p id="Par46">For the development and evaluation of AmpliSolve, we have access to an extensive collection of clinical samples from castration-resistant prostate cancer (CRPC) patients, part of which had been already presented in previous publications [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR19">19</xref>&#x02013;<xref ref-type="bibr" rid="CR21">21</xref>]. The collection comprises 184 germline samples (white blood cells, buccal swabs or saliva) and more than 450 liquid biopsy plasma samples (note that for some patients there are multiple liquid biopsies and a small minority of liquid biopsy samples has no matched normal). In practice for this study, we rely on all 184 normal samples but only use 96 liquid biopsy samples for which results from digital droplet PCR (ddPCR) assays are available (see below). For 5 additional patients we have access to 10 solid tumor samples from metastatic sites (1, 2 and 3 samples from respectively 1, 3 and 1 patients) and their associated 5 germline samples. For the available samples, we have the following data:<list list-type="alpha-lower"><list-item><p id="Par47">For all samples (germlines, liquid biopsies and solid tumors), we have Ion Torrent sequencing data obtained using a custom Ion AmpliSeq panel of 367 amplicons spanning 40,814 genomic positions at around 1000-1500x coverage. The panel targets both intronic and exonic regions in chromosomes 8, 10, 14, 17, 21 and X including commonly aberrated genes such as <italic>PTEN</italic>, <italic>CYP17A1</italic>, <italic>FOXA1</italic>, <italic>TP53</italic>, <italic>SPOP</italic> as well as the androgen receptor (<italic>AR</italic>) gene, which is one of the main drivers of CRPC, and the drug target <italic>CYP17A1</italic>. More details about the sequencing protocol, data processing and additional information about the application of our custom Ion AmpliSeq panel in CRPC diagnostic studies can be found in [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. These papers also include a description of a variant caller that we used as starting point for developing AmpliSolve. We call variants in these Ion AmpliSeq data with our program AmpliSolve.</p></list-item><list-item><p id="Par48">For the 10 solid tumor samples and 5 matched germline samples, in addition to Ion Torrent data, we have Illumina Whole Genome Sequencing (WGS) data at around 80-100x (tumor) and 30x (germline) coverage. We call variants in WGS data according to a previously established pipeline [<xref ref-type="bibr" rid="CR22">22</xref>], which we describe in the next section.</p></list-item><list-item><p id="Par49">For 96 liquid biopsy samples, we have results from ddPCR assays to screen 3 clinically relevant SNVs in the <italic>AR</italic> gene. These SNVs have been linked to resistance to targeted therapy in CRPC patients, namely: 2105&#x02009;T&#x02009;&#x0003e;&#x02009;A (p.L702H), 2226G-&#x02009;&#x0003e;&#x02009;T (p.W742C) and 2632A&#x02009;&#x0003e;&#x02009;G (p.T878A). ddPCR in the plasma samples was performed using 2&#x02013;4&#x02009;ng of DNA, using Life Technologies Custom Taqman snp genotyping assay (product codes AH0JFRC, C_175239649_10 and C_175239651_10, respectively). Following droplet generation (AutoDg, Bio-Rad) and PCR, samples were run on the Bio-Rad QX200 droplet reader and analyzed using the QuantaSoft software.</p></list-item></list></p></sec><sec id="Sec8"><title>WGS variant calling pipeline</title><p id="Par50">We used Illumina WGS data to generate a benchmark set of calls (&#x0201c;ground-truth&#x0201d;) against which AmpliSolve performance is evaluated. WGS data have been processed using standard tools, such as Skewer [<xref ref-type="bibr" rid="CR23">23</xref>] for adapter trimming, BWA-MEM [<xref ref-type="bibr" rid="CR24">24</xref>] for mapping and Picard [<xref ref-type="bibr" rid="CR25">25</xref>] for duplicate removal. In order to call SNVs we run a previously developed pipeline [<xref ref-type="bibr" rid="CR22">22</xref>] that utilizes jointly Mutect [<xref ref-type="bibr" rid="CR26">26</xref>] and Platypus [<xref ref-type="bibr" rid="CR18">18</xref>] (throughout the manuscript this pipeline is denoted as <italic>MutPlat</italic>). Briefly, we first run Mutect (default parameters) on each paired tumor-normal samples. Then, we use Mutect&#x02019;s calls as priors for Platypus and jointly call variants on all tumors and matched normal samples of a patient (further details are provided in Additional&#x000a0;file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Methods). Our ground-truth set of calls consists of both germline and somatic mutations extracted as explained below.</p><p id="Par51">Germline variants are identified as those variants called in the normal (GT&#x02009;=&#x02009;0/1 or 1/1) and that, additionally, have either a PASS filter flag or don&#x02019;t have a PASS filter flag (could have e.g. &#x02018;badReads&#x02019;) but are present in 1000 genomes (phase 3 release) [<xref ref-type="bibr" rid="CR27">27</xref>]. For AmpliSolve validation purposes we consider only tumor samples but include both germline and somatic SNVs. By including germline SNVs, in particular, we are able to test a higher number of low VAF mutations than would be possible when considering only somatic mutations. This is due to a combination of somatic deletions and germline DNA contamination in the tumor samples. Indeed, while somatic deletions cause loss of some germline SNPs in tumor DNA, germline DNA contamination (i.e. &#x0003c;&#x02009;100% tumor purity) means that these mutations may still be present in the tumor samples, albeit with a lower VAF. Note that if somatic deletions occur in high tumor purity samples and/or the sequencing coverage is not deep enough, germline variants may have no supporting read at all in the WGS tumor data. We keep also these limiting cases as part of our ground-truth set of variants as they might be (and sometimes are) detectable in the targeted Ion AmpliSeq data.</p><p id="Par52">To call a somatic SNV we require all of the following criteria to be met: i) Platypus filter: PASS, alleleBias, Q20, QD, SC or HapScore, ii) at least 3 reads supporting the variant in the tumor, iii) at least 10 reads covering the position in the germline and no support for the variant in the germline (NV&#x02009;=&#x02009;0 and genotype GT&#x02009;=&#x02009;0/0), iv) SNV not present in the 1000 genomes database.</p></sec><sec id="Sec9"><title>SNV callers tested for comparison</title><p id="Par53">On WGS and ctDNA samples, we compare AmpliSolve to SiNVICT [<xref ref-type="bibr" rid="CR12">12</xref>], a tool that has been shown to be effective in detecting mutations at very low VAF in Ion Torrent data. We run SiNVICT (version 1.0) with default parameters and with no additional data pre-processing steps. We split the tumor samples (10 metastatic solid tumors plus 96 ctDNA samples) into 3 batches of similar size and we run SiNVICT simultaneously on all samples from each batch. SiNVICT applies a number of post-processing filters and calls variants at 6 different confidence levels, with level 6 assigned to variants that pass all filters. On ctDNA samples, we additionally compare AmpliSolve to deepSNV [<xref ref-type="bibr" rid="CR9">9</xref>], a state-of-the-art method for calling low allele frequency variants in deep sequencing data (although originally designed to detect sub-clonal mutations on Illumina rather than Ion AmpliSeq data). We run deepSNV (version 1.21.3) with default parameters following the available vignette in the R package.</p></sec><sec id="Sec10"><title>How to run AmpliSolve</title><p id="Par54">AmpliSolve two modules, AmpliSolveErrorEstimation and AmpliSolveVariantCalling, can be downloaded from github (<ext-link ext-link-type="uri" xlink:href="https://github.com/dkleftogi/AmpliSolve">https://github.com/dkleftogi/AmpliSolve</ext-link>). Additional requirements include running versions of the programs Samtools [<xref ref-type="bibr" rid="CR15">15</xref>], ASEQ [<xref ref-type="bibr" rid="CR16">16</xref>] and the Boost libraries for C++. Here we provide a brief description of how to run AmpliSolve, however, more detailed information and a number of examples are available on the github page.</p><p id="Par55">For a given amplicon panel, error estimation at each genomic position, for each alternative nucleotide and for each of the two strands requires availability of amplicon-based data from N normal sample files. Although we don&#x02019;t enforce a minimum value for N, values below 10 are likely to give low-quality error estimations. In general, we suggest using as many normal samples as possible when training the error matrix for your panel. If normal samples are not available, AmpliSolveErrorEstimation assigns a constant error rate to all positions, nucleotides and strands in the panel. The default constant error is 0.01 but the user can specify a different value if needed (e.g. for different sequencing platforms). Note that AmpliSolveErrorEstimation does not take bam files as input but rather bam-derived read count files. Read count files can be obtained by running the program ASEQ [<xref ref-type="bibr" rid="CR16">16</xref>]. Once the read count files have been produced, the user needs to set the value of the C pseudo-count parameter (eq. (<xref rid="Equ1" ref-type="">1</xref>)). The choice of C will depend on the trade-off between precision and sensitivity the user is interested in. Users can refer to the benchmarking experiments performed in this paper. In general, values of C between 0.001 and 0.01 should suit most applications.</p><p id="Par56">Once the error matrix has been calculated, it can be fed to the AmpliSolveVariantCalling program together with read count files for the tumor samples again to be produced by running ASEQ. Note that AmpliSolveVariantCalling does not require matched normal-tumor samples for calling SNVs. In fact, AmpliSolveVariantCalling calls all variants it can find in the tumor sample, including germline variants. To separate germline from somatic variants users will need to run AmpliSolveVariantCalling on a matched normal sample and take the difference between the two output files. Command-line syntax for running AmpliSolveErrorEstimation and AmpliSolveVariantCalling is provided on github.</p></sec></sec><sec id="Sec11"><title>Results</title><sec id="Sec12"><title>Sequencing error estimation, self-consistency test and AmpliSolve FDR</title><p id="Par57">AmpliSolve estimates the background sequencing noise by analyzing the distribution of alternative alleles in normal samples. As previously reported, PGM errors tend to be systematic [<xref ref-type="bibr" rid="CR11">11</xref>]. For example, we observe that A&#x02009;&#x0003e;&#x02009;G (T&#x02009;&#x0003e;&#x02009;C) and, to a lesser extent, C&#x02009;&#x0003e;&#x02009;T (G&#x02009;&#x0003e;&#x02009;A) mutations tend to have a higher background error level (see Additional&#x000a0;file&#x000a0;<xref rid="MOESM4" ref-type="media">4</xref>: Figure S3). For this reason, AmpliSolve assigns separate error levels to each genomic position, each alternative allele and each strand (see Additional&#x000a0;file&#x000a0;<xref rid="MOESM5" ref-type="media">5</xref>: Figure S4). These are then utilized to build the Poisson models that are at the core of AmpliSolve SNV calling (Methods). In this section, we study AmpliSolve variant calling performance as a function of two parameters: the pseudo-count <italic>C</italic> (eq. (<xref rid="Equ1" ref-type="">1</xref>) in Methods) and the number of normal samples <italic>N</italic> that are used to calculate the error estimations.</p><p id="Par58">We perform a self-consistency test using sets of normal samples to train our models and other, non-overlapping sets of normal samples for testing them. Given a dataset of <italic>N</italic>&#x02009;=&#x02009;184 normal samples (Methods), we proceed as follows: 1) we select a number M&#x02009;&#x0003c;&#x02009;N of samples at random and additionally a value <italic>c</italic> of the C parameter; 2) we use the M samples to train our Poisson-models with C&#x02009;=&#x02009;<italic>c</italic>; 3) we use the models obtained in 2) to predict SNVs in the remaining N-M samples; 4) we calculate FDR and TPR by defining as negatives all alternative alleles that have VAF&#x02009;&#x0003c;&#x02009;20% and as positives those for which VAF&#x02009;&#x02265;&#x02009;20%. This threshold is chosen empirically based on the distributions of VAFs that we observe in the data (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S1); 5) we repeat steps 1) to 4) 50 times for each pair of (M,<italic>c</italic>) values, each time selecting a new set of M samples at random; 6) we calculate median FDR and TPR over the 50 experiments. We perform steps 1) to 6) for all combinations of the following values of M (size of the training set) and <italic>c</italic> (parameter C): M&#x02009;=&#x02009;10, 20, 40, 80, 120 and <italic>c</italic>&#x02009;=&#x02009;10<sup>&#x02212;&#x02009;5</sup>, 5*10<sup>&#x02212;&#x02009;5</sup>, 10<sup>&#x02212;&#x02009;4</sup>, 5*10<sup>&#x02212;&#x02009;4</sup>, 10<sup>&#x02212;&#x02009;3</sup>, 2*10<sup>&#x02212;&#x02009;3</sup>, 5*10<sup>&#x02212;&#x02009;3</sup>, 10<sup>&#x02212;&#x02009;2</sup>, 2*10<sup>&#x02212;&#x02009;2</sup>. In Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>a and b, we plot the median FDR for each size of the training set (10&#x02013;120) as a function of C; additionally, for comparison, we plot the median FDR of a method in which we skip the error estimation step and we set instead s&#x02009;=&#x02009;<italic>c</italic> for all positions, nucleotides and strands (&#x02018;baseline caller&#x02019;) (see eq. (<xref rid="Equ1" ref-type="">1</xref>) in Methods for the definition of s). The FDR reported in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a is calculated by considering an SNV as called by AmpliSolve if and only if it has a Q score higher or equal 20 (i.e. <italic>p</italic>-value &#x02264;0.01; this is equivalent to the SNV not having a LowQ flag, see <xref rid="Sec2" ref-type="sec">Methods</xref>). The FDR reported in Fig. <xref rid="Fig2" ref-type="fig">2</xref>b, instead, is calculated by considering an SNV as called by AmpliSolve if and only if the program assigns a &#x02018;PASS&#x02019; flag to it, that is, if none of the warnings described in the Methods section applies. In Fig. <xref rid="Fig2" ref-type="fig">2</xref>a we see that, for relatively small values of <italic>c</italic>, the training set size N affects the method performance, with more samples providing better error estimation and thus lower FDR. Also, our approach provides an approximately 2- to 4-fold FDR improvement over the baseline caller at all values of <italic>c&#x02009;&#x02264;</italic>&#x000a0;0.01. For values of <italic>c</italic>&#x02009;&#x0003e;&#x02009;0.01, instead, differences with the baseline caller become negligible. Figure&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>b shows that filtering AmpliSolve&#x02019;s SNV calls using the warning flags that we define on top of LowQ (such as those related to low number of supporting reads, homopolymer regions, etc.) has the effect of further improving the FDR. Also, it reduces differences between FDRs obtained when using training sets of different size. All of the above findings suggest that estimating the background noise at each position, for each nucleotide and for each strand is important for reducing the number of FPs arising from noise in Ion AmpliSeq data. If we now consider the median values of the Sensitivity measure (or TPR), we discover that in all our experiments they are close to 1, irrespective of the value of M and <italic>c</italic>. This close to perfect Sensitivity is not surprising as our definition of positives (VAF&#x02009;&#x02265;&#x02009;20%) makes them relatively simple to discriminate from the background noise especially considering the fact that most of them have VAFs that are much higher than 20% (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S1). Thus, in order to truly test AmpliSolve Sensitivity, we have to perform a different kind of experiment, which we describe in the next section.<fig id="Fig2"><label>Fig. 2</label><caption><p>Assessing AmpliSolve&#x02019;s performance using normal samples. <bold>a</bold> Median AmpliSolve FDR (%) as a function of the model pseudo-count parameter, when using different numbers M of normal samples as training set and testing on the remaining normal samples. We consider as TP all normal variants with VAF&#x02009;&#x02265;&#x02009;20% and as FP all normal variants with VAF&#x02009;&#x0003c;&#x02009;20% (see Text). We consider all AmpliSolve calls that have Q-score&#x02009;&#x02265;&#x02009;20. <bold>b</bold> Same as (<bold>a</bold>) when considering only AmpliSolve calls with a &#x02018;PASS&#x02019; quality flag (see Text)</p></caption><graphic xlink:href="12920_2019_557_Fig2_HTML" id="MO2"/></fig></p></sec><sec id="Sec13"><title>Synthetic variants test for TPR estimation</title><p id="Par59">In order to test the sensitivity of our method at low VAFs (0.5 to 4%), we design the following experiment. We first select two amplicons on the <italic>AR</italic> gene (1,017 genomic positions overall); the <italic>AR</italic> gene is chosen because clinically relevant but for this purpose other choices would be equally valid. Then, we use 120 normal samples randomly selected from the full set of 184 described in Methods to estimate the errors at each position in the two amplicons, for each nucleotide and each strand, according to formula (<xref rid="Equ1" ref-type="">1</xref>). Next, we test the method&#x02019;s sensitivity on synthetic variants. For each possible alternative allele at each of the 1,017 amplicon positions, we set read depth to a fixed value <italic>COV</italic> and the number of reads supporting the allele to 2<italic>a (a</italic> supporting reads on the forward strand and <italic>a</italic> on the reverse strand). We use COV&#x02009;=&#x02009;800, 1600, 3200, 6400 (values in this range apply to more than 60% of full panel positions with coverage &#x0003e;&#x02009;200, see Additional&#x000a0;file&#x000a0;<xref rid="MOESM6" ref-type="media">6</xref>: Figure S5) and for each value of COV we select <italic>a</italic> corresponding to VAFs of 0.5, 1, 1.25, 2, 3 and 4%. For example for COV&#x02009;=&#x02009;800 we test <italic>a</italic>&#x02009;=&#x02009;2, 4, 5, 8, 12, 16. We then apply the Poisson models previously trained on the 120 normal samples to predict variants at each position and for each alternative allele and consider only AmpliSolve calls with a &#x02018;PASS&#x02019; quality flag. We consider all synthetic variants to be positives (thus, no FDR can be calculated in this case) and ask how many of these can be detected by AmpliSolve. We stress that while in each experiment the VAF is by design the same at all positions and for each alternative allele and strand, following estimation from the normal samples the error estimate is position-, alternative allele- and strand-dependent. We calculate the TPR for all combinations of <italic>COV</italic> and <italic>VAF</italic>. We do this for several values of the pseudo-count parameter C in the range of low AmpliSolve FDR as calculated from the self-consistency test in the previous section or the range of main interest for applications (C&#x02009;=&#x02009;0.001, 0.002, 0.005, 0.01, 0.02, see Fig. <xref rid="Fig2" ref-type="fig">2</xref>b).</p><p id="Par60">Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>a-e highlight the role of the C parameter as an approximate lower bound for AmpliSolve sensitivity (see eq. (<xref rid="Equ1" ref-type="">1</xref>)). Typically, AmpliSolve identifies few or no variants at allele frequencies equal to or lower than C, in the range of tested coverage depth (see, in particular, Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>c-e). For example, for C&#x02009;=&#x02009;0.005 no calls are made at VAF&#x02009;=&#x02009;0.5% even at values of COV as high a 6,400. Along the same lines, for values of C equal 0.01 and 0.02, which correspond to FDRs below 1.6 and 0.6%, respectively (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b), the lowest VAFs that AmpliSolve can detect are above 1 and 2%, respectively. For VAF values above C, on the other hand, sensitivity grows quickly with increasing VAF. For example within the depth of coverage range that we have analyzed, when using C&#x02009;=&#x02009;0.01 and C&#x02009;=&#x02009;0.02 AmpliSolve successfully calls the vast majority of synthetic variants at VAF 2 and 3%, respectively. When we compare the Sensitivity histograms in Fig. <xref rid="Fig3" ref-type="fig">3</xref>a-e to the FDR curves in Fig. <xref rid="Fig2" ref-type="fig">2</xref>b, we see that AmpliSolve can reliably predict synthetic SNVs at VAFs as low as 1% while still in a regime of relatively low FDR. Indeed for C&#x02009;=&#x02009;0.002, at an estimated FDR of 6.8% (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b), AmpliSolve calls most SNVs with 1% allele frequency at depth of coverage &#x0003e;&#x02009;1,600 and most SNVs with allele frequency 0.5% at depth of coverage &#x0003e;&#x02009;3,200. While it will be up to the user to select the best trade-off between FDR and TPR for a specific experiment, it would appear that values of C between 0.001 and 0.01 would likely represent a reasonable compromise between these two performance measures in most applications.<fig id="Fig3"><label>Fig. 3</label><caption><p>Assessing AmpliSolve&#x02019;s sensitivity using synthetic data. <bold>a-e</bold> AmpliSolve TPR (Sensitivity) values in <italic>in-silico</italic> synthetic variant experiments. We test different combinations of VAF, depth of coverage and C parameter values (see Text)</p></caption><graphic xlink:href="12920_2019_557_Fig3_HTML" id="MO3"/></fig></p></sec><sec id="Sec14"><title>Benchmarking AmpliSolve perfomance using Illumina WGS data</title><p id="Par61">For 5 additional CRPC patients, we have access to 10 metastatic solid tumor (for some patients more than one metastasis) and associated normal samples. These were sequenced both with our custom Ion AmpliSeq panel and with the Illumina platform as WGS (the latter, with average coverage ~100X) (Methods). We use these 10 samples to provide a validation of AmpliSolve SNV calls in a more realistic set-up with respect to what shown in the previous two sections. For training our AmpliSolve Poisson models, we use the full set of 184 normal samples sequenced with the Ion AmpliSeq technology and we set C&#x02009;=&#x02009;0.002.</p><p id="Par62">In the solid tumor samples, when run on the Ion AmpliSeq data AmpliSolve identifies a total of 556 SNVs. For the same set of genomic positions processed by AmpliSolve, our WGS-variant calling pipeline MutPlat (Methods) calls a total of 603 SNVs in the corresponding Illumina data. The list of positions processed by AmpliSolve includes all those covered by our amplicon panel minus the ones for which no background error estimate can be produced (Methods). Almost all SNVs identified in the WGS data are germline (592 out of 603) but some of them have low VAF in the tumor samples because of deletions and loss of heterozygosity (LOH) events in the tumor DNA combined with germline DNA contamination. It is therefore a very valuable test set that includes confidently identified variants at low VAF.</p><p id="Par63">The level of agreement between AmpliSolve and the ground-truth set of calls from MutPlat is summarized in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>a and in Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>. On this data, AmpliSolve achieves 87% TPR, 94% PPV and 90% F1. In particular, of the 556 SNVs called by AmpliSolve, 525 SNVs are also identified by MutPlat (TP). The remaining 31 are likely false positives (FP) although some of them might be real somatic variants with very low VAFs (and hence non detectable by a WGS done at 100x). The 78 SNVs additionally identified by MutPlat in the WGS data are likely AmpliSolve false negatives (FP). However, we note that 48 of them correspond to positions not called because the coverage in the tumor samples was below the threshold of 100 reads per strand and 26 were filtered out because of the strandBias flag. By simply setting more lenient parameters RD<sub>min</sub>&#x02009;=&#x02009;50 and SB<sub>th</sub>&#x02009;=&#x02009;0.01 we are able to drastically reduce the number of missed calls without affecting AmpliSolve precision. With these settings we obtain 571 TP, 34 FP and 32 FN, which translates into 95% TPR, 94% PPV and 94% F1.<fig id="Fig4"><label>Fig. 4</label><caption><p>Benchmarking AmpliSolve calls with Illumina WGS calls. <bold>a</bold> Venn diagram of mutations on 10 samples sequenced with both Ion Torrent and Illumina platforms and called respectively by AmpliSolve and by MutPlat. Low coverage positions denote mutations excluded by AmpliSolve because poorly covered (&#x0003c;&#x02009;100 reads on at least one strand, &#x02018;uncallable&#x02019; by AmpliSolve). <bold>b</bold> Scatter plot of VAFs in WGS and AmpliSeq data. Note that all the SNVs not called by AmpliSolve (green point) have some support in the data and are reported in its output (hence they have AF&#x02009;&#x0003e;&#x02009;0) but are filtered out, mostly because of strand bias. <bold>c</bold> Same as (<bold>b</bold>) but for VAFs&#x0003c;&#x02009;20%. Note that some concordant calls (purple points) have WGS AF&#x02009;=&#x02009;0; these are real germline variants with no support in the tumor (Methods). For the sake of this comparison, both in (<bold>b</bold>) and in (<bold>c</bold>) we don&#x02019;t consider the 49 mutations at positions of low coverage in Ion Ampliseq data (see (<bold>a</bold>)) (&#x02018;uncallable&#x02019; for AmpliSolve)</p></caption><graphic xlink:href="12920_2019_557_Fig4_HTML" id="MO4"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison between AmpliSolve and SiNVICT calls across the targeted panel. MutPlat calls on Illumina WGS data have been used as ground-truth. SiNVICT levels correspond to confidence levels in the calls (6 being the highest). TP&#x02009;=&#x02009;True Positives, FP=False Positives, FN&#x02009;=&#x02009;False Negatives, TPR&#x02009;=&#x02009;True Positives Rate (Sensitivity), PPV=Positive Predictive Value (Precision), F1&#x02009;=&#x02009;Harmonic mean of Precision and Sensitivity</p></caption><table frame="hsides" rules="groups"><thead><tr><th colspan="2"/><th>TP</th><th>FP</th><th>FN</th><th>TPR</th><th>PPV</th><th>F1</th></tr></thead><tbody><tr><td>AmpliSolve</td><td/><td>525</td><td>31</td><td>78</td><td>87%</td><td>94%</td><td>90%</td></tr><tr><td rowspan="6">SiNVICT</td><td>Level 1</td><td>591</td><td>156</td><td>12</td><td>98%</td><td>79%</td><td>88%</td></tr><tr><td>Level 2</td><td>587</td><td>154</td><td>16</td><td>97%</td><td>79%</td><td>87%</td></tr><tr><td>Level 3</td><td>575</td><td>34</td><td>28</td><td>95%</td><td>94%</td><td>95%</td></tr><tr><td>Level 4</td><td>575</td><td>34</td><td>28</td><td>95%</td><td>94%</td><td>95%</td></tr><tr><td>Level 5</td><td>141</td><td>12</td><td>457</td><td>24%</td><td>92%</td><td>38%</td></tr><tr><td>Level 6</td><td>104</td><td>3</td><td>494</td><td>17%</td><td>97%</td><td>29%</td></tr></tbody></table></table-wrap></p><p id="Par64">In Fig. <xref rid="Fig4" ref-type="fig">4</xref>b and c we report a scatter plot of the VAFs in the WGS and AmpliSeq data with colors indicating common calls (purple), MutPlat-only calls (green) and AmpliSolve-only calls (blue), respectively. Overall there is a good concordance between AmpliSolve and MutPlat calls, even at low VAF (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). In particular, AmpliSolve correctly identifies 18 out of 21 SNVs with VAF&#x02009;&#x0003c;&#x02009;5% in the WGS calls. AmpliSolve does call a number of likely false positives at low VAF, however we note that most of them occur at recurrent positions across patients and could therefore potentially be identified and discarded at a post variant calling analysis stage.</p><p id="Par65">In Table <xref rid="Tab1" ref-type="table">1</xref>, we additionally compare AmpliSolve&#x02019;s performance to the one of SiNVICT when run on the same 10 solid tumor samples. (MutPlat calls on the Illumina data are used as ground truth in both cases). SiNVICT assigns a confidence level (1 to 6) to its calls according to a series of hierarchical filters (each filter eliminates some calls from the previous level). On our dataset, SINVICT&#x02019;s highest confidence level (level 6) although very precise appears to miss a substantial number of SNVs (i.e. it has low sensitivity), especially at low VAF. Better overall results are obtained at confidence levels 3 and 4, In this case, precision and sensitivity values are similar to the ones obtained by Amplisolve when using RD<sub>min</sub>&#x02009;=&#x02009;50 and SB<sub>th</sub>&#x02009;=&#x02009;0.01. Interestingly, at low VAF AmpliSolve and SiNVICT seem to identify slightly different sets of SNVs, suggesting that it might be possible to improve SNV calling by appropriately combining them.</p></sec><sec id="Sec15"><title>Clinical application using ctDNA samples and ddPCR for validation</title><p id="Par66">One of the most promising clinical applications of ctDNA is profiling of specific mutations associated with tumor progression and resistance to cancer therapies. To evaluate AmpliSolve&#x02019;s usefulness for this important task, we use results from a ddPCR screen on 96 samples from our CRPC patients at three genomic positions within the <italic>AR</italic> gene, which are associated with resistance to targeted therapy (Methods). ddPCR detects 30 variants in total at these positions in a VAF range of 0.1 to 49% (note, however, that in some experiments only the presence or absence of the variant was recorded). Next, we compare AmpliSolve calls at the same positions in the AmpliSeq NGS data for the same samples (predictions made after training AmpliSolve with pseudo-count parameter C&#x02009;=&#x02009;0.002 on 184 normal samples). In Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>a we summarize the level of agreement between AmpliSolve and the ddPCR experiments. AmpliSolve correctly calls 19 out of 30 ddPCR variants and predicts variants at two additional positions. If we take the ddPCR experiments as our ground-truth, this translates into 90% PPV 63% TPR and 74% F1 for AmpliSolve at these 3 clinically relevant genomic positions.<fig id="Fig5"><label>Fig. 5</label><caption><p>Validating AmpliSolve performance with ddPCR experiments. <bold>a</bold> Venn diagram of mutations in 96 samples at 3 positions as determined by AmpliSolve and ddPCR experiments. False positives refer to variants called by AmpliSolve and not detected by ddPCR, false negatives the opposite. In 256 out of&#x000a0;288 cases neither AmpliSolve nor ddPCR detect a mutation. <bold>b</bold> Scatter plot of the VAFs in the ddPCR and Ion Torrent data. Most of the SNVs missed by AmpliSolve (green points) have some support in the NGS data but they cannot be distinguished from noise. Because of the log scale, we arbitrarily set AF&#x02009;=&#x02009;10<sup>&#x02212;&#x02009;4</sup> for negative calls with AF&#x02009;=&#x02009;0. Similarly, we set AF&#x02009;=&#x02009;1 for ddPCR calls for which no allele frequency information is available</p></caption><graphic xlink:href="12920_2019_557_Fig5_HTML" id="MO5"/></fig></p><p id="Par67">As a comparison, we run the SiNVICT and deepSNV methods on the same Ion Torrent data and extract their SNV calls at these positions. The results are summarized in Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref>. Similar to what observed in the previous section, SiNVICT highest confidence levels (5 and 6) have low sensitivity (30% TPR). Better results are obtained at lower confidence level (1 to 4) whereby SiNVICT correctly identifies 17 out of 30 ddPCR variants without introducing any false positives. In total deepSNV calls 18 SNVs, 15 of which are correct.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparison of SNV calling on 96 samples at 3 genomics positions. The 3 positions on the AR gene were screened by ddPCR used here as ground-truth. SINVICT Levels 5 and 6 and Levels 1, 2, 3 and 4 have been grouped as they give the same results. TP&#x02009;=&#x02009;True Positives, FP=False Positives, FN&#x02009;=&#x02009;False Negatives, TPR&#x02009;=&#x02009;True Positives Rate (Sensitivity), PPV=Positive Predictive Value (Precision), F1&#x02009;=&#x02009;Harmonic mean of Precision and Sensitivity</p></caption><table frame="hsides" rules="groups"><thead><tr><th colspan="2"/><th>TP</th><th>FP</th><th>FN</th><th>TPR</th><th>PPV</th><th>F1</th></tr></thead><tbody><tr><td>AmpliSolve</td><td/><td>19</td><td>2</td><td>11</td><td>63%</td><td>90%</td><td>74%</td></tr><tr><td rowspan="2">SiNVICT</td><td>Levels 1,2,3,4</td><td>17</td><td>0</td><td>13</td><td>57%</td><td>100%</td><td>73%</td></tr><tr><td>Levels 5,6</td><td>9</td><td>0</td><td>21</td><td>30%</td><td>100%</td><td>46%</td></tr><tr><td>deepSNV</td><td/><td>15</td><td>3</td><td>15</td><td>50%</td><td>83%</td><td>62%</td></tr></tbody></table></table-wrap></p><p id="Par68">When looking at AmpliSolve predictions in more details (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b), we note that all ddPCR positives not called by our program (and additionally missed by both SiNVICT and deepSNV) have VAF&#x02009;&#x0003c;&#x02009;1% in the NGS data and that AmpliSolve succeeds in calling all ddPCR positives at higher NGS frequencies including several at VAFs between 1 and 5%. It is also important to note that AmpliSolve correctly predicts 256 out of 258 (99.2%) ddPCR negatives. While the results presented in this section refer to only three genomic positions, they are indicative of AmpliSolve&#x02019;s potential value in a clinically relevant setting.</p></sec></sec><sec id="Sec16"><title>Discussion</title><p id="Par69">In this study we present AmpliSolve, a new bioinformatics method that combines position-specific, nucleotide-specific and strand-specific background error estimation with statistical modeling for SNV detection in amplicon-based deep sequencing data. AmpliSolve is originally designed for the Ion AmpliSeq platform that is affected by higher error levels compared to, for example, Illumina platforms. Our method is based on the estimation of noise levels from normal samples and uses a Poisson model to calculate the <italic>p</italic>-value of the detected variant. We assess AmpliSolve&#x02019;s performance with experiments that use normal samples (self-consistency tests) and simulated data (synthetic variants) and, additionally, with tests that utilize real metastatic samples sequenced with both Ion Torrent and Illumina platforms. In these experiments, AmpliSolve achieves a good balance between precision and sensitivity, even at VAF&#x02009;&#x0003c;&#x02009;5%. These experiments also suggest possible ways to further improve the method, such as adopting a better strand bias filter, reducing the minimum coverage requirement for calling a variant and introducing a &#x02018;black list&#x02019; of positions characterized by an unusual noise distribution across samples (e.g. bimodal). Further, we test AmpliSolve in a clinically relevant setting by calling SNVs in 96 liquid biopsy samples at 3 positions that had been additionally screened by ddPCR assay. In this experiment AmpliSolve successfully identifies SNVs at VAF as low as 1% in the NGS data. This opens up interesting possibilities for clinical applications using the Ion Torrent PGM such as, for example, tracking mutations in ctDNA to monitor treatment effectiveness and/or disease relapse.</p></sec><sec id="Sec17"><title>Conclusions</title><p id="Par70">AmpliSolve is a new computational tool for the detection of low frequency SNVs in targeted deep sequencing data. It uses a set of germline samples to build a sequencing error profile at each genomic position of interest. Based on these profiles AmpliSolve estimates the likelihood of a variant being real or just the result of sequencing artefacts. We test AmpliSolve on clinical cancer samples sequenced with a custom Ion AmpliSeq gene panel and show that AmpliSolve can correctly identify variants even at allele frequency below 5% and as low as 1%. This is significant because detecting variants with low allele frequency can be challenging using Ion Torrent sequencing. From a methodological point of view, we believe that the use of models with position-specific error estimates, as described here, could have a significant impact on variant detection for other sequencing platforms as well.</p></sec><sec sec-type="supplementary-material"><title>Additional files</title><sec id="Sec18"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="12920_2019_557_MOESM1_ESM.docx"><label>Additional file 1:</label><caption><p>Supplementary Methods. Details of the MutPlat pipeline. (DOCX 15 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="12920_2019_557_MOESM2_ESM.pptx"><label>Additional file 2:</label><caption><p>
<bold>Figure S1.</bold> Variant allele frequency (VAF) distributions for the A, T, C, G nucleotides as calculated from 30 randomly chosen normal samples across our custom AmpliSeq panel. Only VAFs &#x0003c;&#x02009;60% are displayed. The red lines mark VAF&#x02009;=&#x02009;20%. (PPTX 278 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM3"><media xlink:href="12920_2019_557_MOESM3_ESM.pptx"><label>Additional file 3:</label><caption><p>
<bold>Figure S2.</bold> Fraction of sites in a normal sample sequenced at a given coverage or more across our custom AmpliSeq panel. The values are calculated over&#x000a0;30 randomly selected samples. (PPTX 59 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM4"><media xlink:href="12920_2019_557_MOESM4_ESM.pptx"><label>Additional file 4:</label><caption><p>
<bold>Figure S3.</bold> Distributions of background error values by mutation type. Panels (a), (b), (c) and (d) refers to mutations from reference allele A, C, G and T respectively. Mutations are split by alternative allele and strand, (+) and (&#x02212;). Note the higher error values for A&#x02009;&#x0003e;&#x02009;G (T&#x02009;&#x0003e;&#x02009;C) and C&#x02009;&#x0003e;&#x02009;T (G&#x02009;&#x0003e;&#x02009;A) mutations. Plots are bound to error values of 0.005 on the y-axis for visual clarity. (PPTX 201 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM5"><media xlink:href="12920_2019_557_MOESM5_ESM.pptx"><label>Additional file 5:</label><caption><p>
<bold>Figure S4.</bold> Position-specific, allele-specific and strand-specific frequency of alternative alleles in 100 consecutive positions in the <italic>AR</italic> gene. (PPTX 116 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM6"><media xlink:href="12920_2019_557_MOESM6_ESM.pptx"><label>Additional file 6:</label><caption><p>
<bold>Figure S5.</bold> Fraction of sites in our custom AmpliSeq panel sequenced at a given coverage or more. The values are calculated over 30 randomly selected ctDNA samples. Note that positions with depth of coverage less than 200 are not considered for calculating the total number of positions. The red lines represent the upper and lower bounds of coverage used in the synthetic variant test. (PPTX 64 kb)</p></caption></media></supplementary-material>
</p></sec></sec></body><back><glossary><title>Abbreviations</title><def-list><def-item><term>cfDNA</term><def><p id="Par5">circulating free DNA</p></def></def-item><def-item><term>CRPC</term><def><p id="Par6">Castration Resistant Prostate Cancer</p></def></def-item><def-item><term>ctDNA</term><def><p id="Par7">circulating tumor DNA</p></def></def-item><def-item><term>ddPCR</term><def><p id="Par8">digital droplet PCR</p></def></def-item><def-item><term>FDR</term><def><p id="Par9">False Discovery Rate</p></def></def-item><def-item><term>FN</term><def><p id="Par10">False Negatives</p></def></def-item><def-item><term>FP</term><def><p id="Par11">False Positives</p></def></def-item><def-item><term>NGS</term><def><p id="Par12">Next-Generation Sequencing</p></def></def-item><def-item><term>PGM</term><def><p id="Par13">Personal Genome Machine</p></def></def-item><def-item><term>PPV</term><def><p id="Par14">Positive Predictive Value</p></def></def-item><def-item><term>SNV</term><def><p id="Par15">Single Nucleotide Variant</p></def></def-item><def-item><term>TP</term><def><p id="Par16">True Positives</p></def></def-item><def-item><term>TPR</term><def><p id="Par17">True Positive Rate</p></def></def-item><def-item><term>VAF</term><def><p id="Par18">Variant Allele Frequency</p></def></def-item><def-item><term>WGS</term><def><p id="Par19">Whole Genome Sequencing</p></def></def-item></def-list></glossary><fn-group><fn><p><bold>Publisher&#x02019;s Note</bold></p><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><ack><title>Acknowledgements</title><p>The authors thank the participating men and their families who suffered from metastatic prostate cancer and nonetheless gave the gift of participation so that others might benefit.</p></ack><notes notes-type="author-contribution"><title>Authors&#x02019; contributions</title><p>DK implemented and tested the AmpliSolve software. DK, MP and SL designed the computational study and analyzed the results. SS, SQW, DW, AJ, VC and DGT were responsible for sample collection; DW, AJ, VC and DGT carried out library preparation and DNA sequencing. DW, AJ, VC and DGT performed the ddPCR assays. SL and GA conceived the study; SL, GA and MP supervised it. DK, MP and SL wrote the paper, DW and GA reviewed it. All authors read and approved the final manuscript.</p></notes><notes notes-type="funding-information"><title>Funding</title><p>DK, MP and SL are funded by the Wellcome Trust (105104/Z/14/Z). GA, DW, AJ, VC and DGT were supported by Prostate Cancer UK (PG12&#x02013;49) and Cancer Research UK (A13239). VC was also funded by a European Society of Medical Oncology Translational Clinical Research Fellowship, AJ by an Irish Health Research Board Clinical Research Fellowship and a Medical Research Council Clinical Research Fellowship, DGT by a European Union Marie Sk&#x00142;odowska-Curie Actions Individual Fellowship (MSCA-IF).</p></notes><notes notes-type="data-availability"><title>Availability of data and materials</title><p>AmpliSolve is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/dkleftogi/AmpliSolve">https://github.com/dkleftogi/AmpliSolve</ext-link>. The datasets analysed during the current study are&#x000a0;available from the authors on reasonable request.</p></notes><notes><title>Ethics approval and consent to participate</title><p id="Par71">All samples were collected in studies with institutional regulatory board approval and conducted in accordance with the Declaration of Helsinki and the Good Clinical Practice guidelines of the International Conference of Harmonization. The protocols were approved by: The Royal Marsden Research Ethics Committee at the Royal Marsden, London, UK (REC number 04/Q0801/6), Comitato Etico IRST IRCCS AVR at the Istituto Scientifico Romagnolo per lo Studio e la Cura dei Tumori, Meldola, Italy (REC number 2192/2013) and The Peter MacCallum Cancer Centre Ethics Committee [EC00235] at The Peter MacCallum Cancer Centre, Melbourne, Australia (REC number 15/98). Written informed consent was obtained from all patients.</p></notes><notes><title>Consent for publication</title><p id="Par72">Patients have consented that next-generation sequencing data with no personal identifiers can be used for publication in an anonymized format.</p></notes><notes notes-type="COI-statement"><title>Competing interests</title><p id="Par73">The authors declare that they have no competing interests.</p></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goodwin</surname><given-names>S</given-names></name><name><surname>McPherson</surname><given-names>JD</given-names></name><name><surname>McCombie</surname><given-names>WR</given-names></name></person-group><article-title>Coming of age: ten years of next-generation sequencing technologies</article-title><source>Nat Rev Genet</source><year>2016</year><volume>17</volume><fpage>333</fpage><lpage>351</lpage><pub-id pub-id-type="doi">10.1038/nrg.2016.49</pub-id><pub-id pub-id-type="pmid">27184599</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McGranahan</surname><given-names>N</given-names></name><name><surname>Swanton</surname><given-names>C</given-names></name></person-group><article-title>Clonal heterogeneity and tumor evolution: past, present, and the future</article-title><source>Cell</source><year>2017</year><volume>168</volume><fpage>613</fpage><lpage>628</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2017.01.018</pub-id><pub-id pub-id-type="pmid">28187284</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heitzer</surname><given-names>E</given-names></name><name><surname>Perakis</surname><given-names>S</given-names></name><name><surname>Geigl</surname><given-names>JB</given-names></name><name><surname>Speicher</surname><given-names>MR</given-names></name></person-group><article-title>The potential of liquid biopsies for the early detection of cancer</article-title><source>NPJ Precis Oncol</source><year>2017</year><volume>1</volume><fpage>36</fpage><pub-id pub-id-type="doi">10.1038/s41698-017-0039-5</pub-id><pub-id pub-id-type="pmid">29872715</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wan</surname><given-names>JCM</given-names></name><name><surname>Massie</surname><given-names>C</given-names></name><name><surname>Garcia-Corbacho</surname><given-names>J</given-names></name><name><surname>Mouliere</surname><given-names>F</given-names></name><name><surname>Brenton</surname><given-names>JD</given-names></name><name><surname>Caldas</surname><given-names>C</given-names></name><etal/></person-group><article-title>Liquid biopsies come of age: towards implementation of circulating tumour DNA</article-title><source>Nat Rev Cancer</source><year>2017</year><volume>17</volume><fpage>223</fpage><lpage>238</lpage><pub-id pub-id-type="doi">10.1038/nrc.2017.7</pub-id><pub-id pub-id-type="pmid">28233803</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Newman</surname><given-names>AM</given-names></name><name><surname>Lovejoy</surname><given-names>AF</given-names></name><name><surname>Klass</surname><given-names>DM</given-names></name><name><surname>Kurtz</surname><given-names>DM</given-names></name><name><surname>Chabon</surname><given-names>JJ</given-names></name><name><surname>Scherer</surname><given-names>F</given-names></name><etal/></person-group><article-title>Integrated digital error suppression for improved detection of circulating tumor DNA</article-title><source>Nat Biotechnol</source><year>2016</year><volume>34</volume><fpage>547</fpage><lpage>555</lpage><pub-id pub-id-type="doi">10.1038/nbt.3520</pub-id><pub-id pub-id-type="pmid">27018799</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mansukhani</surname><given-names>Sonia</given-names></name><name><surname>Barber</surname><given-names>Louise J.</given-names></name><name><surname>Kleftogiannis</surname><given-names>Dimitrios</given-names></name><name><surname>Moorcraft</surname><given-names>Sing Yu</given-names></name><name><surname>Davidson</surname><given-names>Michael</given-names></name><name><surname>Woolston</surname><given-names>Andrew</given-names></name><name><surname>Proszek</surname><given-names>Paula Zuzanna</given-names></name><name><surname>Griffiths</surname><given-names>Beatrice</given-names></name><name><surname>Fenwick</surname><given-names>Kerry</given-names></name><name><surname>Herman</surname><given-names>Bram</given-names></name><name><surname>Matthews</surname><given-names>Nik</given-names></name><name><surname>O'Leary</surname><given-names>Ben</given-names></name><name><surname>Hulkki</surname><given-names>Sanna</given-names></name><name><surname>Gonzalez De Castro</surname><given-names>David</given-names></name><name><surname>Patel</surname><given-names>Anisha</given-names></name><name><surname>Wotherspoon</surname><given-names>Andrew</given-names></name><name><surname>Okachi</surname><given-names>Aleruchi</given-names></name><name><surname>Rana</surname><given-names>Isma</given-names></name><name><surname>Begum</surname><given-names>Ruwaida</given-names></name><name><surname>Davies</surname><given-names>Matthew N.</given-names></name><name><surname>Powles</surname><given-names>Thomas</given-names></name><name><surname>von Loga</surname><given-names>Katharina</given-names></name><name><surname>Hubank</surname><given-names>Michael</given-names></name><name><surname>Turner</surname><given-names>Nick</given-names></name><name><surname>Watkins</surname><given-names>David</given-names></name><name><surname>Chau</surname><given-names>Ian</given-names></name><name><surname>Cunningham</surname><given-names>David</given-names></name><name><surname>Lise</surname><given-names>Stefano</given-names></name><name><surname>Starling</surname><given-names>Naureen</given-names></name><name><surname>Gerlinger</surname><given-names>Marco</given-names></name></person-group><article-title>Ultra-Sensitive Mutation Detection and Genome-Wide DNA Copy Number Reconstruction by Error-Corrected Circulating Tumor DNA Sequencing</article-title><source>Clinical Chemistry</source><year>2018</year><volume>64</volume><issue>11</issue><fpage>1626</fpage><lpage>1635</lpage><pub-id pub-id-type="doi">10.1373/clinchem.2018.289629</pub-id><pub-id pub-id-type="pmid">30150316</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nielsen</surname><given-names>R</given-names></name><name><surname>Paul</surname><given-names>JS</given-names></name><name><surname>Albrechtsen</surname><given-names>A</given-names></name><name><surname>Song</surname><given-names>YS</given-names></name></person-group><article-title>Genotype and SNP calling from next-generation sequencing data</article-title><source>Nat Rev Genet</source><year>2011</year><volume>12</volume><fpage>443</fpage><lpage>451</lpage><pub-id pub-id-type="doi">10.1038/nrg2986</pub-id><pub-id pub-id-type="pmid">21587300</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>C</given-names></name></person-group><article-title>A review of somatic single nucleotide variant calling algorithms for next-generation sequencing data</article-title><source>Comput Struct Biotechnol J</source><year>2018</year><volume>16</volume><fpage>15</fpage><lpage>24</lpage><pub-id pub-id-type="doi">10.1016/j.csbj.2018.01.003</pub-id><pub-id pub-id-type="pmid">29552334</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerstung</surname><given-names>M</given-names></name><name><surname>Beisel</surname><given-names>C</given-names></name><name><surname>Rechsteiner</surname><given-names>M</given-names></name><name><surname>Wild</surname><given-names>P</given-names></name><name><surname>Schraml</surname><given-names>P</given-names></name><name><surname>Moch</surname><given-names>H</given-names></name><etal/></person-group><article-title>Reliable detection of subclonal single-nucleotide variants in tumour cell populations</article-title><source>Nat Commun</source><year>2012</year><volume>3</volume><fpage>811</fpage><pub-id pub-id-type="doi">10.1038/ncomms1814</pub-id><pub-id pub-id-type="pmid">22549840</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quail</surname><given-names>MA</given-names></name><name><surname>Smith</surname><given-names>M</given-names></name><name><surname>Coupland</surname><given-names>P</given-names></name><name><surname>Otto</surname><given-names>TD</given-names></name><name><surname>Harris</surname><given-names>SR</given-names></name><name><surname>Connor</surname><given-names>TR</given-names></name><etal/></person-group><article-title>A tale of three next generation sequencing platforms: comparison of ion torrent, pacific biosciences and Illumina MiSeq sequencers</article-title><source>BMC Genomics</source><year>2012</year><volume>13</volume><fpage>341</fpage><pub-id pub-id-type="doi">10.1186/1471-2164-13-341</pub-id><pub-id pub-id-type="pmid">22827831</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bragg</surname><given-names>LM</given-names></name><name><surname>Stone</surname><given-names>G</given-names></name><name><surname>Butler</surname><given-names>MK</given-names></name><name><surname>Hugenholtz</surname><given-names>P</given-names></name><name><surname>Tyson</surname><given-names>GW</given-names></name></person-group><article-title>Shining a light on dark sequencing: characterising errors in ion torrent PGM data</article-title><source>PLoS Comput Biol</source><year>2013</year><volume>9</volume><fpage>e1003031</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003031</pub-id><pub-id pub-id-type="pmid">23592973</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kockan</surname><given-names>C</given-names></name><name><surname>Hach</surname><given-names>F</given-names></name><name><surname>Sarrafi</surname><given-names>I</given-names></name><name><surname>Bell</surname><given-names>RH</given-names></name><name><surname>McConeghy</surname><given-names>B</given-names></name><name><surname>Beja</surname><given-names>K</given-names></name><etal/></person-group><article-title>SiNVICT: ultra-sensitive detection of single nucleotide variants and indels in circulating tumour DNA</article-title><source>Bioinformatics</source><year>2017</year><volume>33</volume><fpage>26</fpage><lpage>34</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btw536</pub-id><pub-id pub-id-type="pmid">27531099</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deshpande</surname><given-names>A</given-names></name><name><surname>Lang</surname><given-names>W</given-names></name><name><surname>McDowell</surname><given-names>T</given-names></name><name><surname>Sivakumar</surname><given-names>S</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><etal/></person-group><article-title>Strategies for identification of somatic variants using the ion torrent deep targeted sequencing platform</article-title><source>BMC Bioinformatics</source><year>2018</year><volume>19</volume><fpage>5</fpage><pub-id pub-id-type="doi">10.1186/s12859-017-1991-3</pub-id><pub-id pub-id-type="pmid">29301485</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shin</surname><given-names>S</given-names></name><name><surname>Lee</surname><given-names>H</given-names></name><name><surname>Son</surname><given-names>H</given-names></name><name><surname>Paik</surname><given-names>S</given-names></name><name><surname>Kim</surname><given-names>S</given-names></name></person-group><article-title>AIRVF: a filtering toolbox for precise variant calling in ion torrent sequencing</article-title><source>Bioinformatics</source><year>2018</year><volume>34</volume><fpage>1232</fpage><lpage>1234</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btx719</pub-id><pub-id pub-id-type="pmid">29126106</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Handsaker</surname><given-names>B</given-names></name><name><surname>Wysoker</surname><given-names>A</given-names></name><name><surname>Fennell</surname><given-names>T</given-names></name><name><surname>Ruan</surname><given-names>J</given-names></name><name><surname>Homer</surname><given-names>N</given-names></name><etal/></person-group><article-title>The sequence alignment/map format and SAMtools</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>2078</fpage><lpage>2079</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id><pub-id pub-id-type="pmid">19505943</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Romanel</surname><given-names>A</given-names></name><name><surname>Lago</surname><given-names>S</given-names></name><name><surname>Prandi</surname><given-names>D</given-names></name><name><surname>Sboner</surname><given-names>A</given-names></name><name><surname>Demichelis</surname><given-names>F</given-names></name></person-group><article-title>ASEQ: fast allele-specific studies from next-generation sequencing data</article-title><source>BMC Med Genet</source><year>2015</year><volume>8</volume><fpage>9</fpage></element-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Romanel</surname><given-names>A</given-names></name><name><surname>Gasi Tandefelt</surname><given-names>D</given-names></name><name><surname>Conteduca</surname><given-names>V</given-names></name><name><surname>Jayaram</surname><given-names>A</given-names></name><name><surname>Casiraghi</surname><given-names>N</given-names></name><name><surname>Wetterskog</surname><given-names>D</given-names></name><etal/></person-group><article-title>Plasma AR and abiraterone-resistant prostate cancer</article-title><source>Sci Transl Med</source><year>2015</year><volume>7</volume><fpage>312re10</fpage><pub-id pub-id-type="doi">10.1126/scitranslmed.aac9511</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rimmer</surname><given-names>A</given-names></name><name><surname>Phan</surname><given-names>H</given-names></name><name><surname>Mathieson</surname><given-names>I</given-names></name><name><surname>Iqbal</surname><given-names>Z</given-names></name><name><surname>Twigg</surname><given-names>SRF</given-names></name></person-group><article-title>WGS500 consortium, et al. integrating mapping-, assembly- and haplotype-based approaches for calling variants in clinical sequencing applications</article-title><source>Nat Genet</source><year>2014</year><volume>46</volume><fpage>912</fpage><lpage>918</lpage><pub-id pub-id-type="doi">10.1038/ng.3036</pub-id><pub-id pub-id-type="pmid">25017105</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carreira</surname><given-names>S</given-names></name><name><surname>Romanel</surname><given-names>A</given-names></name><name><surname>Goodall</surname><given-names>J</given-names></name><name><surname>Grist</surname><given-names>E</given-names></name><name><surname>Ferraldeschi</surname><given-names>R</given-names></name><name><surname>Miranda</surname><given-names>S</given-names></name><etal/></person-group><article-title>Tumor clone dynamics in lethal prostate cancer</article-title><source>Sci Transl Med</source><year>2014</year><volume>6</volume><fpage>254ra125</fpage><pub-id pub-id-type="doi">10.1126/scitranslmed.3009448</pub-id></element-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawrence</surname><given-names>MG</given-names></name><name><surname>Obinata</surname><given-names>D</given-names></name><name><surname>Sandhu</surname><given-names>S</given-names></name><name><surname>Selth</surname><given-names>LA</given-names></name><name><surname>Wong</surname><given-names>SQ</given-names></name><name><surname>Porter</surname><given-names>LH</given-names></name><etal/></person-group><article-title>Patient-derived models of Abiraterone- and enzalutamide-resistant prostate Cancer reveal sensitivity to ribosome-directed therapy</article-title><source>Eur Urol</source><year>2018</year><volume>74</volume><fpage>562</fpage><lpage>572</lpage><pub-id pub-id-type="doi">10.1016/j.eururo.2018.06.020</pub-id><pub-id pub-id-type="pmid">30049486</pub-id></element-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conteduca</surname><given-names>V</given-names></name><name><surname>Wetterskog</surname><given-names>D</given-names></name><name><surname>Sharabiani</surname><given-names>MTA</given-names></name><name><surname>Grande</surname><given-names>E</given-names></name><name><surname>Fernandez-Perez</surname><given-names>MP</given-names></name><name><surname>Jayaram</surname><given-names>A</given-names></name><etal/></person-group><article-title>Androgen receptor gene status in plasma DNA associates with worse outcome on enzalutamide or abiraterone for castration-resistant prostate cancer: a multi-institution correlative biomarker study</article-title><source>Ann Oncol</source><year>2017</year><volume>28</volume><fpage>1508</fpage><lpage>1516</lpage><pub-id pub-id-type="doi">10.1093/annonc/mdx155</pub-id><pub-id pub-id-type="pmid">28472366</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barry</surname><given-names>Peter</given-names></name><name><surname>Vatsiou</surname><given-names>Alexandra</given-names></name><name><surname>Spiteri</surname><given-names>Inmaculada</given-names></name><name><surname>Nichol</surname><given-names>Daniel</given-names></name><name><surname>Cresswell</surname><given-names>George D.</given-names></name><name><surname>Acar</surname><given-names>Ahmet</given-names></name><name><surname>Trahearn</surname><given-names>Nicholas</given-names></name><name><surname>Hrebien</surname><given-names>Sarah</given-names></name><name><surname>Garcia-Murillas</surname><given-names>Isaac</given-names></name><name><surname>Chkhaidze</surname><given-names>Kate</given-names></name><name><surname>Ermini</surname><given-names>Luca</given-names></name><name><surname>Huntingford</surname><given-names>Ian Said</given-names></name><name><surname>Cottom</surname><given-names>Hannah</given-names></name><name><surname>Zabaglo</surname><given-names>Lila</given-names></name><name><surname>Koelble</surname><given-names>Konrad</given-names></name><name><surname>Khalique</surname><given-names>Saira</given-names></name><name><surname>Rusby</surname><given-names>Jennifer E.</given-names></name><name><surname>Muscara</surname><given-names>Francesca</given-names></name><name><surname>Dowsett</surname><given-names>Mitch</given-names></name><name><surname>Maley</surname><given-names>Carlo C.</given-names></name><name><surname>Natrajan</surname><given-names>Rachael</given-names></name><name><surname>Yuan</surname><given-names>Yinyin</given-names></name><name><surname>Schiavon</surname><given-names>Gaia</given-names></name><name><surname>Turner</surname><given-names>Nicholas</given-names></name><name><surname>Sottoriva</surname><given-names>Andrea</given-names></name></person-group><article-title>The Spatiotemporal Evolution of Lymph Node Spread in Early Breast Cancer</article-title><source>Clinical Cancer Research</source><year>2018</year><volume>24</volume><issue>19</issue><fpage>4763</fpage><lpage>4770</lpage><pub-id pub-id-type="doi">10.1158/1078-0432.CCR-17-3374</pub-id><pub-id pub-id-type="pmid">29891724</pub-id></element-citation></ref><ref id="CR23"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>H</given-names></name><name><surname>Lei</surname><given-names>R</given-names></name><name><surname>Ding</surname><given-names>S-W</given-names></name><name><surname>Zhu</surname><given-names>S</given-names></name></person-group><article-title>Skewer: a fast and accurate adapter trimmer for next-generation sequencing paired-end reads</article-title><source>BMC Bioinformatics</source><year>2014</year><volume>15</volume><fpage>182</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-15-182</pub-id><pub-id pub-id-type="pmid">24925680</pub-id></element-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name></person-group><source>Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM</source><year>2013</year></element-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="other">Picard: A set of command line tools (in Java) for manipulating high-throughput sequencing (HTS) data and formats such as SAM/BAM/CRAM and VCF. <ext-link ext-link-type="uri" xlink:href="http://broadinstitute.github.io/picard/">http://broadinstitute.github.io/picard/</ext-link>. Accessed 30 Oct 2018.</mixed-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cibulskis</surname><given-names>K</given-names></name><name><surname>Lawrence</surname><given-names>MS</given-names></name><name><surname>Carter</surname><given-names>SL</given-names></name><name><surname>Sivachenko</surname><given-names>A</given-names></name><name><surname>Jaffe</surname><given-names>D</given-names></name><name><surname>Sougnez</surname><given-names>C</given-names></name><etal/></person-group><article-title>Sensitive detection of somatic point mutations in impure and heterogeneous cancer samples</article-title><source>Nat Biotechnol</source><year>2013</year><volume>31</volume><fpage>213</fpage><lpage>219</lpage><pub-id pub-id-type="doi">10.1038/nbt.2514</pub-id><pub-id pub-id-type="pmid">23396013</pub-id></element-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="other">IGSR: The International Genome Sample Resource. <ext-link ext-link-type="uri" xlink:href="http://www.internationalgenome.org/">http://www.internationalgenome.org/</ext-link>. Accessed 30 Oct 2018.</mixed-citation></ref></ref-list></back></article>