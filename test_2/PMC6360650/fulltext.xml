<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id><journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id><journal-title-group><journal-title>BMC Genomics</journal-title></journal-title-group><issn pub-type="epub">1471-2164</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6360650</article-id><article-id pub-id-type="pmid">30712508</article-id><article-id pub-id-type="publisher-id">5372</article-id><article-id pub-id-type="doi">10.1186/s12864-018-5372-8</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research</subject></subj-group></article-categories><title-group><article-title>NanoMod: a computational tool to detect DNA modifications using Nanopore long-read sequencing data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Liu</surname><given-names>Qian</given-names></name><address><email>liuq1@email.chop.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Georgieva</surname><given-names>Daniela C.</given-names></name><address><email>dcg2140@cumc.columbia.edu</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Egli</surname><given-names>Dieter</given-names></name><address><email>de2220@cumc.columbia.edu</email></address><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Wang</surname><given-names>Kai</given-names></name><address><email>wangk@email.chop.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff4">4</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0680 8770</institution-id><institution-id institution-id-type="GRID">grid.239552.a</institution-id><institution>Raymond G. Perelman Center for Cellular and Molecular Therapeutics, </institution><institution>Children&#x02019;s Hospital of Philadelphia, </institution></institution-wrap>Philadelphia, PA 19104 USA </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000000419368729</institution-id><institution-id institution-id-type="GRID">grid.21729.3f</institution-id><institution>Integrated Program in Cellular, Molecular, and Biomedical Studies, </institution><institution>Columbia University, </institution></institution-wrap>New York, NY 10032 USA </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000000419368729</institution-id><institution-id institution-id-type="GRID">grid.21729.3f</institution-id><institution>Department of Pediatrics, </institution><institution>Columbia University, </institution></institution-wrap>New York, NY 10032 USA </aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8972</institution-id><institution-id institution-id-type="GRID">grid.25879.31</institution-id><institution>Department of Pathology and Laboratory Medicine, Perelman School of Medicine, </institution><institution>University of Pennsylvania, </institution></institution-wrap>Philadelphia, PA 19104 USA </aff></contrib-group><pub-date pub-type="epub"><day>4</day><month>2</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>4</day><month>2</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>20</volume><issue>Suppl 1</issue><issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. The Supplement Editors declare that they have no competing interests.</issue-sponsor><elocation-id>78</elocation-id><permissions><copyright-statement>&#x000a9; The Author(s). 2019</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p id="Par1">Recent advances in single-molecule sequencing techniques, such as Nanopore sequencing, improved read length, increased sequencing throughput, and enabled direct detection of DNA modifications through the analysis of raw signals. These DNA modifications include naturally occurring modifications such as DNA methylations, as well as modifications that are introduced by DNA damage or through synthetic modifications to one of the four standard nucleotides.</p></sec><sec><title>Methods</title><p id="Par2">To improve the performance of detecting DNA modifications, especially synthetically introduced modifications, we developed a novel computational tool called NanoMod. NanoMod takes raw signal data on a pair of DNA samples with and without modified bases, extracts signal intensities, performs base error correction based on a reference sequence, and then identifies bases with modifications by comparing the distribution of raw signals between two samples, while taking into account of the effects of neighboring bases on modified bases (&#x0201c;neighborhood effects&#x0201d;).</p></sec><sec><title>Results</title><p id="Par3">We evaluated NanoMod on simulation data sets, based on different types of modifications and different magnitudes of neighborhood effects, and found that NanoMod outperformed other methods in identifying known modified bases. Additionally, we demonstrated superior performance of NanoMod on an <italic>E. coli</italic> data set with 5mC (5-methylcytosine) modifications.</p></sec><sec><title>Conclusions</title><p id="Par4">In summary, NanoMod is a flexible tool to detect DNA modifications with single-base resolution from raw signals in Nanopore sequencing, and will facilitate large-scale functional genomics experiments that use modified nucleotides.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>DNA modifications</kwd><kwd>Nanopore long-read data</kwd><kwd>Statistics analysis</kwd><kwd>Computational tool</kwd><kwd>Nanopore signal annotation</kwd></kwd-group><conference xlink:href="http://icibm2018.zhaobioinfo.org/"><conf-name>The International Conference on Intelligent Biology and Medicine (ICIBM) 2018</conf-name><conf-acronym>ICIBM 2018</conf-acronym><conf-loc>Los Angeles, CA, USA</conf-loc><conf-date>10-12 June 2018</conf-date></conference><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2019</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p id="Par8">An important type of covalent modification in epigenetics is DNA modification, where a chemical residue can be added to one of the four standard nucleotides (A, C, G, T) in a DNA molecule [<xref ref-type="bibr" rid="CR1">1</xref>]. Those added residues can be methyl, carboxyl, ethyl, formyl, hydroxymethyl, dimethyl groups and other larger chemicals such as biotin and Idoxuridine, resulting in various types of DNA modifications. DNA modifications can exist naturally in genomes or can be introduced synthetically into DNA molecules for research purposes. For example, DNA methylation, a common and well-studied type of modification, is formed when a methyl group is added into the adenines or cytosines in a DNA molecule, and different types of methylations exist depending on which atomic position in an adenine or cytosine is modified, such as 5-methylcytosine (5mC) and N6-methyladenosine (6mA). Various naturally occurring DNA modifications have been widely discovered in all kingdoms of life [<xref ref-type="bibr" rid="CR2">2</xref>]. They play a critical role in regulating cellular states and functions, controlling which genes are turned on/off, dramatically affecting gene expression and eventual production of proteins and their functions [<xref ref-type="bibr" rid="CR3">3</xref>]. In comparison, synthetically introduced DNA modifications can mark specific positions in genome sequence, facilitating functional genomics studies. For example, labeling specific DNA sequence motifs by fluorescence signals in a genome can facilitate optical mapping of genomes and the detection of structural variants [<xref ref-type="bibr" rid="CR4">4</xref>]. Furthermore, incorporation of modified DNA bases during DNA synthesis can be used to track patterns of DNA replication in a genome-wide scale through optical mapping [<xref ref-type="bibr" rid="CR5">5</xref>]. However, there are currently no genome-wide methods that allow the detection of replicated and non-replicated DNA with base-pair resolution.</p><p id="Par9">Several different genomic techniques have been developed to detect DNA modifications, especially for DNA methylations. For example, bisulfite sequencing is a widely used method for detecting DNA methylations, where unmethylated cytosines are converted to uracil and Illumina short-read sequencing techniques are used to call methylated and unmethylated cytosines from sequence data [<xref ref-type="bibr" rid="CR6">6</xref>]. However, the harsh process in bisulfite treatment results in a large fraction of DNA fragmentation, which generally requires large quantity of DNA and complicates the analysis of highly variable, heterogeneous epigenome [<xref ref-type="bibr" rid="CR3">3</xref>]. Immunoprecipitation together with Illumina short-read sequencing were also used to detect DNA or RNA modifications [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>], but these methods can detect only broad genomic regions with methylation without single base resolution. Furthermore, short read sequencing averages signals across different cells, and does not answer the question whether two reads mapping to adjacent locations in the genome are from the same cell or from a different cell. Other studies took advantage of PacBio single-molecule real-time (SMRT) sequencing techniques to directly detect DNA modifications using the principle that the existence of DNA modifications would affect DNA polymerase kinetics during SMRT sequencing [<xref ref-type="bibr" rid="CR9">9</xref>&#x02013;<xref ref-type="bibr" rid="CR12">12</xref>]. Modifications in RNA can also be detected using PacBio SMRT sequencing [<xref ref-type="bibr" rid="CR13">13</xref>]. However, there was reduced signal-to-noise ratio for 5mC modifications [<xref ref-type="bibr" rid="CR14">14</xref>] and the improved enzymatic treatment of 5mC detection using Tet1 [<xref ref-type="bibr" rid="CR15">15</xref>] also had incomplete and context-dependent treatment [<xref ref-type="bibr" rid="CR3">3</xref>]. A comprehensive review can be found in [<xref ref-type="bibr" rid="CR16">16</xref>].</p><p id="Par10">Recent studies have explored the use of Oxford Nanopore sequencing techniques for the detection of DNA modifications. In Nanopore sequencing, electric current change occurs when a k-mer passes through a nanopore, and different molecules (such as standard nucleotides and their modified versions) generate different current change, depending on sequence contexts. Several prior studies [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>] have carefully analyzed ionic current signals and demonstrated the feasibility of using Nanopore signals to identify DNA modifications by comparing current levels of methylated (that is, 5mC and 5-hydroxymethylcytosine (5hmC)) DNA copies with current levels of unmethylated DNA copies. They found that more C5-cytosine variants (1 unmethylated cytosine and 4 cytosine modifications) could also be identified using Nanopore sequencing data with higher accuracy in a background of known sequences [<xref ref-type="bibr" rid="CR19">19</xref>]. Recently, three groups have quantified the strength of using Nanopore platform for detecting DNA modifications at a large scale [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]: Simpson <italic>et. al.</italic> developed a HMM (hidden Markov model) to distinguish 5mC from cytosine [<xref ref-type="bibr" rid="CR3">3</xref>] in <italic>E. coli</italic> and <italic>Homo sapiens</italic> and integrated it in nanopolish, but this method cannot detect non-CpG methylations; Mclntyre <italic>et.al.</italic> designed mCaller to improve the detection of 6mA and tested the 6mA detection in mouse, <italic>E. coli</italic> and Lambda phage DNA [<xref ref-type="bibr" rid="CR20">20</xref>]; Rand <italic>et. al.</italic> analyzed three types of cytosine (i.e., cytosine, 5mC and 5hmC) and also 6mA in <italic>E. coli</italic> with different phases using HMM with a hierarchical Dirichlet process, with an implementation in the signalAlign package [<xref ref-type="bibr" rid="CR21">21</xref>]. The results demonstrated feasibility to achieve improved performance in detecting DNA modifications [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>], but they needed large prior training datasets for HMM [<xref ref-type="bibr" rid="CR2">2</xref>], and therefore cannot be extended for detecting different types of modifications (especially synthetically introduced modifications). Stoiber <italic>et. al.</italic> proposed MoD-seq in the nanoraw package to identify modifications in the absence of large prior training dataset [<xref ref-type="bibr" rid="CR2">2</xref>]. Here we developed NanoMod to achieve improved performance in the detection of modified bases in the absence of any training data, though NanoMod can optionally leverage existing training data to further improve performance.</p><p id="Par11">NanoMod was designed for the detection of de novo DNA modifications (for example, synthetically introduced modifications). The inputs of NanoMod were a group of reads from a DNA sample with modification at specific bases and a group of reads from the matched non-modified sample. The nucleotide sequence for the sample is assumed to be known, that is, the reference genome must be already known a priori. Currently, within NanoMod, we used albacore for basecalling, and then performed an indel error correction by aligning the events of electric signals to a reference genome, similar to the procedure implemented in nanoraw [<xref ref-type="bibr" rid="CR2">2</xref>]. After that, two groups of electric signals for each genomic position were compared using the Kolmogorov-Smirnov test [<xref ref-type="bibr" rid="CR22">22</xref>] in a per-base level to identify bases with significantly different distributions of signals between the two groups. Finally, weighted Stouffer&#x02019;s method was used to combine the effects of neighboring bases since some modifications (especially bulky ones) may have strong neighbor effects that affect electric signals in neighboring non-modified bases. We evaluated NanoMod on simulation data of modifications with different properties and on a published <italic>E. coli</italic> methylation data set. NanoMod can be accessed at <ext-link ext-link-type="uri" xlink:href="https://github.com/WGLab/NanoMod">https://github.com/WGLab/NanoMod</ext-link>.</p></sec><sec id="Sec2"><title>Methods</title><sec id="Sec3"><title>Summary of NanoMod</title><p id="Par12">The input of NanoMod is a dataset with two groups of reads: one from a sample with DNA modifications at specific positions and the other is the matched non-modified sample. The output is the ranked list of positions with potential modifications, as shown in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>. NanoMod does not require prior training data, but it cannot detect the specific type of modification either. However, given a large-scale data set with known modifications at known positions, it is possible to use them as prior information to train a model and analyze a new dataset with the same type of modifications by NanoMod. The several steps involved in NanoMod are illustrated below.<fig id="Fig1"><label>Fig. 1</label><caption><p>The flowchart of NanoMod. The squares with dotted line refer to components that require external tools, while the dotted arrow line suggests an alternative solution. This procedure is similar to nanoraw [<xref ref-type="bibr" rid="CR2">2</xref>]</p></caption><graphic xlink:href="12864_2018_5372_Fig1_HTML" id="MO1"/></fig></p></sec><sec id="Sec4"><title>Basecalling by albacore</title><p id="Par13">Nanopore raw data on a long read consists of a time series of raw signals measured by the Oxford Nanopore sequencer such as MinION or GridION. Each raw signal is a digital integer value, a measure of the changes of electric current when a k-mer (for example, 5-mer) passes through nanopores. Since the acquisition frequency is usually much higher than the speed of translocation of bases passing through nanopores, the same k-mer may be measured multiple times when it passes through the pore. Since the speed of translocation is not constant, different k-mers may have different numbers of measurements. More importantly, errors and noises may exist during signals acquisition on the k-mers, making the precise interpretation of bases from raw signals more challenging. In other words, given a set of electric signals when a DNA molecule passes through the pore, it is not straightforward to convert them directly into a series of nucleotides.</p><p id="Par14">To generate bases from Nanopore signals, raw signals are typically segmented into separate &#x0201c;events&#x0201d; in albacore (Note that the latest version albacore uses raw signals for basecalling, thus the segmentation step is no longer needed). Each event consists of a consecutive series of raw signals that significantly deviate from the two direct neighboring events. The joint analysis of neighboring events with multiple overlapping bases would finally generate a sequence of bases with the highest probability, which is a procedure that uses deep recurrent neural network as implemented in albacore. The output of albacore contains a read from a FAST5 file and the signal information of all its bases.</p></sec><sec id="Sec5"><title>Error correction and signal annotation</title><p id="Par15">Long reads generated on Nanopore platform usually have high error rates which may negatively affect downstream analysis. Since we assume that a reference genome is already available (i.e. the true nucleotide identity is assumed to be known in advance), to correct the base calling errors, BWA-MEM [<xref ref-type="bibr" rid="CR23">23</xref>] was used to align Nanopore long reads to the known sequence, and then the indels (possible basecalling errors) were corrected by a re-segmentation process which is similar to the indel correction procedure in nanoraw [<xref ref-type="bibr" rid="CR2">2</xref>]. An insertion error suggests that two adjacent segmented events might be from the same k-mer, and thus, one of the two neighbor events of the insertion is merged with the insertion event for generating a new neighbor event. A deletion error suggests that the neighboring events of the deletion are be generated by one additional k-mer, and thus, the several closest neighbor events of the deletion are re-segmented so that one additional event can be generated. When the neighboring events to be re-segmented contain other indels, the collection of events are first merged together and then re-segmented so that proper events can be generated. The number of neighboring events is automatically determined so that there are enough number of signal measurements for each event after the re-segmentation. Meanwhile, to address the issue of homopolymer error, if there are&#x000a0;<italic>L</italic><sub><italic>r</italic></sub>&#x02009;&#x0003e;&#x02009;5 single nucleotide repeats in the sequence, the middle <italic>L</italic><sub><italic>r</italic></sub>&#x02009;&#x02212;&#x02009;4 new positions would share a certain new event after re-segmentation.</p><p id="Par16">To illustrate this further, examples of the deletion correction procedure and insertion correction procedure are shown in Figs. <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref>, respectively. In Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>, there is a deletion. To generate the correct events in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>, we grouped the deletion together (shadowed region in green) with one upstream adjacent neighbor and one downstream adjacent neighbor. We then re-segmented those signals associated with the bases in the shadowed region, and obtained one additional event from the correction procedure. In Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>, we grouped the insertion event, one upstream adjacent neighbor and one downstream adjacent neighbor (shadowed region in yellow), and then re-segmented the signals to generate two events from the correction procedure.<fig id="Fig2"><label>Fig. 2</label><caption><p>An example of the deletion correction procedure in NanoMod. X axis represents time of signal acquisition, and y axis denotes detected signal values by Nanopore sequencers before standardization. &#x02018;Albacore&#x02019; represents a sequence of bases called based on original events before error correction, and &#x02018;Known&#x02019; represents the known sequence. Each red horizontal bar represents an event split by vertical lines. &#x02018;-&#x02019; in &#x02018;Albacore&#x02019; suggests a deletion. The region shadowed in green shows the deleted bases together with one upstream and one downstream neighbors</p></caption><graphic xlink:href="12864_2018_5372_Fig2_HTML" id="MO2"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>An example of the insertion correction procedure in NanoMod. The region shadowed in yellow shows the insertion base together with one upstream and one downstream neighbors. For other notations, see Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref></p></caption><graphic xlink:href="12864_2018_5372_Fig3_HTML" id="MO3"/></fig></p><p id="Par17">After that, raw signals in a long read are normalized using the median subtraction and the standardization by averaged difference, and the normalized signal was limited between &#x02212;&#x02009;5 to 5. Normalized signal information of each position in a long read subsequently anchors a position in the known reference sequence. This process is similar to what is described in nanoraw [<xref ref-type="bibr" rid="CR2">2</xref>].</p></sec><sec id="Sec6"><title>Signal summarization for positions in the known sequence</title><p id="Par18">Based on the corrected alignment of a long read with the known sequence, the normalized signal of a position in a long read can be assigned to the corresponding aligned position in the known sequence. Given two groups of aligned long reads, each position in the known sequence will have two groups of normalized signals, one from reads of the sample with modifications and the other from the matched non-modified sample.</p><p id="Par19">Sometimes, a position may have a much smaller number of associated reads in one sample versus the other sample, possibly due to random fluctuation of coverage or due to other issues (for example, PCR amplification biases). Thus, those positions with limited data on signals in either group are filtered and excluded from the downstream analysis, based on user-specified criteria.</p></sec><sec id="Sec7"><title>Detection of modifications</title><p id="Par20">Assuming that signals of a base for a position in a known sequence are generated from a specific but unknown distribution with some noises. The signals for a position of the known sequence in the two groups would be highly similar to each other if the position and its closest neighbors are not modified. However, if a position contains a modified base, the signals of the two groups for the position and/or its neighbors would be different, in term of mean, standard deviation or shape. In other words, a position has high probability to have a modified base if the signals between the two groups for the position or its neighbors are statistically different.</p><p id="Par21">In NanoMod, Kolmogorov-Smirnov test is used for this purpose, since our purpose is to detect de novo modifications and since the actual distribution of signal intensity is not known a priori. Additionally, our experience and manual examination showed that the distribution of signal intensities at a modified position (or neighbors of a modified position) can be of various different shapes, such as increased/decreased mean, increased variance, a change from unimodal to bimodal distribution, etc. Kolmogorov-Smirnov test [<xref ref-type="bibr" rid="CR22">22</xref>] is one of the most useful nonparametric test methods to quantify the distance between empirical distribution functions of two groups of samples. It is sensitive to the differences in both the locations and shapes of the two distribution functions. The Kolmogorov-Smirnov statistic <italic>D</italic><sub><italic>m</italic>, <italic>n</italic></sub> is defined below.<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{c}{F}_{1,m}(x)=\frac{1}{m}\sum \limits_{i=1}^m{I}_{\left[-\infty, x\right]}\left({X}_i\right)\\ {}{F}_{2,n}(x)=\frac{1}{n}\sum \limits_{i=1}^n{I}_{\left[-\infty, x\right]}\left({X}_i\right)\\ {}{D}_{m,n}={\mathit{\sup}}_x\left|{F}_{1,m}(x)-{F}_{2,n}(x)\right|\end{array}} $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msub><mml:mi>I</mml:mi><mml:mfenced close="]" open="[" separators=","><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mo>&#x0221e;</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:mfenced></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>I</mml:mi><mml:mfenced close="]" open="[" separators=","><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mo>&#x0221e;</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:mfenced></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo mathvariant="italic">sup</mml:mo><mml:mi>x</mml:mi></mml:msub><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2018_5372_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par22">Where <italic>X</italic><sub><italic>i</italic></sub> is a signal, and <italic>I</italic><sub>[&#x02212;&#x0221e;,&#x02009;<italic>x</italic>]</sub>(<italic>X</italic><sub><italic>i</italic></sub>) is 1 if <italic>X</italic><sub><italic>i</italic></sub>&#x02009;&#x02264;&#x02009;<italic>x</italic> and 0 otherwise. <italic>F</italic><sub>1, <italic>m</italic></sub>(<italic>x</italic>) is for a group of <italic>m</italic> modified reads, and <italic>F</italic><sub>2, <italic>n</italic></sub>(<italic>x</italic>)&#x000a0;is for a group of <italic>n</italic> non-modified reads. <italic>sup</italic> is a supremum function giving the least upper bound, that is, the least difference which is not less than all differences between the two <italic>F</italic>(<italic>x</italic>)s. <italic>P</italic>-values of the Kolmogorov-Smirnov test indicate the probability of the base at a position to be modified: the smaller <italic>p</italic>-value is, the more likely the base is modified.</p></sec><sec id="Sec8"><title>The combination of neighbor <italic>p</italic>-values</title><p id="Par23">Measured signals in Nanopore data are usually for k-mers, that is, a modification of a base at a specific position may affect the signals of its neighbors. Therefore, p-values of neighboring positions may also suggest the presence of modifications. To take into account the neighborhood effect, p-values within <italic>k</italic> closest positions of a given position can be used to generate a combined <italic>p</italic>-values. <italic>k</italic> could be specified by users and by default <italic>k</italic>&#x02009;=&#x02009;2. Weighted Stouffer&#x02019;s method is used for this purpose, so that the center position has higher weights, and the further neighbors, the lesser the weights. The weighted Stouffer statistic for <italic>k</italic>&#x02009;+&#x02009;1 consecutive positions (<italic>k</italic> closest positions plus the center position) is <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ Z\sim \frac{\sum_{i=1}^{k+1}{w}_i{\varnothing}^{-1}\left(1-{p}_i\right)}{\sqrt{\sum_{i=1}^{k+1}{w}_i^2}} $$\end{document}</tex-math><mml:math id="M4" display="inline"><mml:mi>Z</mml:mi><mml:mo>~</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mo>&#x02205;</mml:mo><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mfrac></mml:math><inline-graphic xlink:href="12864_2018_5372_Article_IEq1.gif"/></alternatives></inline-formula> where <italic>p</italic><sub><italic>i</italic></sub> is the probability of a position with a weight of <italic>w</italic><sub><italic>i</italic></sub> and &#x02205;<sup>&#x02212;1</sup>(1&#x02009;&#x02212;&#x02009;<italic>p</italic><sub><italic>i</italic></sub>) returns a Z score of <italic>p</italic><sub><italic>i</italic></sub> with a standard normal cumulative distribution function.</p><p id="Par24">When a position has extremely small p-value, its neighboring positions tend to also have very small <italic>p</italic>-values, and these positions will rank very high among all positions. Therefore, the rank for a position gives redundant information on whether a neighborhood region has a modification. We thus used neighborhood-based ranking. In neighborhood-based ranking, if a position has a higher rank, its neighbor positions (within 1 or 2 base window size for both left and right sides) with lower rank are not considered.</p></sec><sec id="Sec9"><title>Simulation of nanopore long-read data</title><p id="Par25">To evaluate how NanoMod works on modifications with different properties, we generated several simulation datasets where samples have multiple types of modifications. In the simulation, we assumed that we had a sequence and each 5-mer produces signals according to a normal distribution of the mean E<sub><italic>k</italic></sub> and the standard deviation <italic>&#x02206;</italic><sub><italic>k</italic></sub> plus some random noises, then a basic simulation process for a given sequence can be described as below:<list list-type="order"><list-item><p id="Par26">Generate n signals for each 5-mer in the given sequence, and sequentially merge all signals together for the given sequence. n is a random number which varies from 5 to 15.</p></list-item><list-item><p id="Par27">Repeat Step 1 for 100 times, and treat them as raw reads of a non-modified sample.</p></list-item><list-item><p id="Par28">Sample h positions in the given sequence, and assume that those bases are modified.</p></list-item><list-item><p id="Par29">For each position h<sub><italic>i</italic></sub> with simulated modifications and its neighborhood position h<sub><italic>j</italic></sub>, &#x02016;<italic>j</italic>&#x02009;&#x02212;&#x02009;<italic>i</italic>&#x02016;&#x02009;&#x02264;&#x02009;2, the mean was increased by <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathrm{w}}_a^i=\alpha /{2}^{\left\Vert j-i\right\Vert } $$\end{document}</tex-math><mml:math id="M6" display="inline"><mml:msubsup><mml:mi mathvariant="normal">w</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mo>/</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mfenced close="&#x02016;" open="&#x02016;"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:msup></mml:math><inline-graphic xlink:href="12864_2018_5372_Article_IEq2.gif"/></alternatives></inline-formula>, and the standard deviation was increased by <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathrm{w}}_b^i=\beta /\Big(\left\Vert j-i\right\Vert $$\end{document}</tex-math><mml:math id="M8" display="inline"><mml:msubsup><mml:mi mathvariant="normal">w</mml:mi><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>&#x003b2;</mml:mi><mml:mo>/</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mfenced close="&#x02016;" open="&#x02016;"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2018_5372_Article_IEq3.gif"/></alternatives></inline-formula>+&#x02009;1). If a position is adjacent to two modifications, <italic>h</italic><sub><italic>u</italic></sub> and h<sub><italic>v</italic></sub>, its <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathrm{w}}_a={\mathrm{w}}_a^u+{\mathrm{w}}_a^v $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:msub><mml:mi mathvariant="normal">w</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="normal">w</mml:mi><mml:mi>a</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="normal">w</mml:mi><mml:mi>a</mml:mi><mml:mi>v</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2018_5372_Article_IEq4.gif"/></alternatives></inline-formula> and <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathrm{w}}_b={\mathrm{w}}_b^u+{\mathrm{w}}_b^v $$\end{document}</tex-math><mml:math id="M12" display="inline"><mml:msub><mml:mi mathvariant="normal">w</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="normal">w</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="normal">w</mml:mi><mml:mi>b</mml:mi><mml:mi>v</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2018_5372_Article_IEq5.gif"/></alternatives></inline-formula>, otherwise if a position is only close to a modifications h<sub><italic>i</italic></sub>, <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathrm{w}}_a={\mathrm{w}}_a^i $$\end{document}</tex-math><mml:math id="M14" display="inline"><mml:msub><mml:mi mathvariant="normal">w</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="normal">w</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2018_5372_Article_IEq6.gif"/></alternatives></inline-formula> and <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathrm{w}}_b={\mathrm{w}}_b^i $$\end{document}</tex-math><mml:math id="M16" display="inline"><mml:msub><mml:mi mathvariant="normal">w</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="normal">w</mml:mi><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2018_5372_Article_IEq7.gif"/></alternatives></inline-formula>. In this study, <italic>&#x003b1;</italic> was set to 0.2, while <italic>&#x003b2;</italic> was set to 1.</p></list-item><list-item><p id="Par30">For those positions with modifications or are adjacent to the modified bases, generate m signals according to a normal distribution of the mean E<sub><italic>k</italic></sub>&#x02009;&#x02217;&#x02009;(1&#x02009;+&#x02009;w<sub><italic>a</italic></sub>) and the standard deviation <italic>&#x02206;</italic><sub><italic>k</italic></sub>&#x02009;&#x02217;&#x02009;(1&#x02009;+&#x02009;w<sub><italic>b</italic></sub>) plus some random noises. Here E<sub><italic>k</italic></sub> and <italic>&#x02206;</italic><sub><italic>k</italic></sub> are the mean and standard deviation of the corresponding non-modified 5-mer, and m was a random number, which varies from 5 to 15.</p></list-item><list-item><p id="Par31">For other positions without modified bases and are not in the vicinity of modified bases, generate m signals as what has been done in Step 1.</p></list-item><list-item><p id="Par32">Repeat Steps 4, 5 and 6 for 100 times, and treat them as reads of a modified sample.</p></list-item><list-item><p id="Par33">Run NanoMod on two groups of reads.</p></list-item><list-item><p id="Par34">Repeat Steps 1 to 8 for 100 times so that 100 pairs of datasets were used to evaluate NanoMod.</p></list-item></list></p><p id="Par35">To simulate modifications with different properties, we generated several types of simulation data sets below:<list list-type="simple"><list-item><label>i)</label><p id="Par36">&#x02018;MeanDif&#x02019; simulation: The modification of a base only affects signal mean of the 5-mer centered at that base, i.e., w<sub><italic>a</italic></sub>&#x02009;&#x0003e;&#x02009;0. Signal standard deviation of the 5-mer has no change (w<sub><italic>b</italic></sub>&#x02009;=&#x02009;0) and no neighborhood effect (w<sub><italic>a</italic></sub>&#x02009;=&#x02009;0&#x000a0;<italic>and</italic>&#x000a0;w<sub><italic>b</italic></sub>&#x02009;=&#x02009;0 for non-modified bases).</p></list-item><list-item><label>ii)</label><p id="Par37">&#x0201c;STDDif&#x0201d; simulation: The modification of a base only affects signal standard deviation of the 5-mer centered at that base, i.e., w<sub><italic>b</italic></sub>&#x02009;&#x0003e;&#x02009;0. Signal mean of the 5-mer has no change (w<sub><italic>a</italic></sub>&#x02009;=&#x02009;0) and no neighborhood effect (w<sub><italic>a</italic></sub>&#x02009;=&#x02009;0&#x000a0;<italic>and</italic>&#x000a0;w<sub><italic>b</italic></sub>&#x02009;=&#x02009;0 for non-modified bases).</p></list-item><list-item><label>iii)</label><p id="Par38">&#x0201c;Mean_STDDif&#x0201d; simulation: The modification of a base affects both signal mean and standard deviation of the 5-mer centered at that base, i.e., w<sub><italic>a</italic></sub>&#x02009;&#x0003e;&#x02009;0&#x000a0;<italic>and</italic>&#x000a0;w<sub><italic>b</italic></sub>&#x02009;&#x0003e;&#x02009;0, but no neighborhood effect (w<sub><italic>a</italic></sub>&#x02009;=&#x02009;0&#x000a0;<italic>and</italic>&#x000a0;w<sub><italic>b</italic></sub>&#x02009;=&#x02009;0 for non-modified bases).</p></list-item><list-item><label>iv)</label><p id="Par39">&#x0201c;Mean_STDDif_NE&#x0201d; simulation: The modification of a base affects both signal mean and the standard deviation of the 5-mer centered at that base, i.e., w<sub><italic>a</italic></sub>&#x02009;&#x0003e;&#x02009;0&#x000a0;<italic>and</italic>&#x000a0;w<sub><italic>b</italic></sub>&#x02009;&#x0003e;&#x02009;0, and also adjacent neighbors, i.e., w<sub>a</sub>&#x0003e;0&#x000a0;<italic>and</italic>&#x000a0;w<sub><italic>b</italic></sub>&#x02009;&#x0003e;&#x02009;0 for adjacent non-modified 5-mer of the modified bases.</p></list-item></list></p><p id="Par40">A summary of these simulation data sets was also provided in Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>A summary of simulation data and real data used in the analysis</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Datasets</th><th>#base in ref <sup>a</sup></th><th>#reads <sup>b</sup></th><th>#modification <sup>c</sup></th><th>Modification types</th></tr></thead><tbody><tr><td>100 &#x02018;MeanDif&#x02019; simulation datasets</td><td>6184-bp</td><td>200 in each dataset</td><td>a group of 60 modifications</td><td>Only signal mean of modified bases was affected without neighborhood effect.</td></tr><tr><td>100 &#x02018;STDDif&#x02019; simulation datasets</td><td>6184-bp</td><td>200 in each dataset</td><td>a group of 60 modifications</td><td>Only signal standard deviation of modified bases was affected without neighborhood effect.</td></tr><tr><td>100 &#x02018;Mean_STDDif&#x02019; simulation datasets</td><td>6184-bp</td><td>200 in each dataset</td><td>a group of 60 modifications</td><td>Both signal mean and standard deviation of modified bases were affected without neighborhood effect.</td></tr><tr><td>100 &#x02018;Mean_STDDif_NE&#x02019; simulation datasets</td><td>6184-bp</td><td>200 in each dataset</td><td>a group of 60 modifications</td><td>Both signal mean and standard deviation of modified bases were affected with neighborhood effect.</td></tr><tr><td><italic>E. coli</italic> [<xref ref-type="bibr" rid="CR3">3</xref>]</td><td>~&#x02009;4.64&#x02009;Mb</td><td>181,092</td><td>693,586</td><td>Methylation at all CpG sites</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>The number of bases in the reference sequence</p><p><sup>b</sup>The number of reads in a dataset. For simulation data, half of reads have modifications and the other half do not have modifications. For E. Coli, 111,213 reads have methylations and 69,879 do not have methylations</p><p><sup>c</sup>The number of modifications in each dataset</p></table-wrap-foot></table-wrap></p></sec><sec id="Sec10"><title>A Nanopore long-read sequencing data set on <italic>E. coli</italic></title><p id="Par41">A publicly available Nanopore long-read sequencing data of <italic>E. coli</italic> [<xref ref-type="bibr" rid="CR3">3</xref>] was also used to evaluate NanoMod. This dataset contains two groups of samples, one was generated from PCR product where DNA modifications are not expected to be present, and the other was from PCR product after enzymatic methylation with the M.SssI methyltransferase where almost all of cytosines in a CpG context were converted to 5-mC [<xref ref-type="bibr" rid="CR3">3</xref>]. These dataset was downloaded from the European Nucleotide Archive under accession number PRJEB13021 [<xref ref-type="bibr" rid="CR3">3</xref>]. On this data set, the known <italic>E. coli</italic> sample has ~&#x02009;4.64&#x02009;Mb nucleotides and ~&#x02009;693,586 CpG sites, which were also included in Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>.</p></sec><sec id="Sec11"><title>Measurement for performance evaluation</title><p id="Par42">To measure the performance of ranking modified bases at the top among all bases, we used the percentiles of 0.1, 0.25, 0.5, 1, 2, 3, 4 and 5% to split the ranking into 9 categories for simulation data. Then, at each percentile, we calculated precision (i.e., the number of correctly identified modifications divided by the number of modification predictions at a percentile) and recall (i.e., the number of correctly identified modifications divided by the number of modifications) for correctly detecting the known modifications, and generated precision-recall plot. On the <italic>E. coli</italic> data set [<xref ref-type="bibr" rid="CR3">3</xref>], we used the percentiles of 0.1, 0.25, 0.5, 1, 2, 3, 4, 5, 10, 15, 20, 25 and 30% to split the ranking, because there are many methylated CpG sites.</p></sec></sec><sec id="Sec12"><title>Results</title><p id="Par43">NanoMod was designed to detect candidate positions with DNA modifications using raw electric signals generated from Nanopore long-read sequencing techniques. Briefly, two groups of reads, one containing modified bases and the other without modified bases, were used as input of NanoMod, and were then subject to basecalling, error correction and signal annotation of positions in a known sequence. After that, we ranked all positions for the presence of potential DNA modifications. NanoMod was evaluated on simulation data where raw signals were simulated according to the mean and standard deviation of 5-mer and on a publicly available methylation data. The results are described in detail below.</p><sec id="Sec13"><title>Evaluation on simulation data with multiple DNA modifications in a sequence</title><p id="Par44">We simulated 200 reads of a 6184-bp sequence (100 with and 100 without modification on specific positions) on a sample based on the means and standard deviations of observed 5-mers (1024 distributions) from large-scale Nanopore sequencing experiments. Each of the simulated modification reads has 60 modifications randomly dispersed across the whole sequence. DNA modifications with different properties were simulations as described in the Method section. Each type of modification was also generated 100 times. The performance of NanoMod was evaluated using precision and recall, as the percentile of the rank which ranges from 0.1, 0.25, to 0.5%, 1, 2, 3, 4% and then to 5%. Typically, when the percentile value increases, the recall would increase. We compared the performance of Mann&#x02013;Whitney U test, Student&#x02019;s T test and Kolmogorov-Smirnov test on signals of single bases, and also two combined statistics methods including Stouffer&#x02019;s method and Fisher&#x02019;s method. The results were shown in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>, where precision and recall were the averaged values on 100 simulation data sets.<fig id="Fig4"><label>Fig. 4</label><caption><p>The average precision and recall rates of NanoMod on 100 simulation data sets. &#x0201c;U test&#x0201d;: Mann&#x02013;Whitney U test, &#x0201c;T test&#x0201d;: Student&#x02019;s T test, &#x0201c;KS test&#x0201d;: Kolmogorov-Smirnov test, &#x0201c;Stouffer&#x02019;s M&#x0201d;: Stouffer&#x02019;s method and &#x0201c;Fisher&#x02019;s M&#x0201d;: Fisher&#x02019;s method. &#x0201c;MeanDif&#x0201d;: modified bases only have the mean difference for signals from non-modified bases, &#x0201c;STDDif&#x0201d;: modified bases only have the difference of standard deviation for signals from non-modified bases, &#x0201c;Mean_STDDif&#x0201d;: modified bases have the difference of the mean and standard deviation for signals from non-modified bases, and &#x0201c;Mean_STDDif_NE&#x0201d;: the simulation of &#x0201c;Mean_STDDif&#x0201d; plus neighborhood effect. Precision was calculated using the number of correctly identified modifications divided by the number of modification predictions at a percentile (i.e., 0.1, 0.25, 0.5, 1, 2, 3, 4 and 5%), and recall was calculated using the number of correctly identified modifications divided by the number of modifications</p></caption><graphic xlink:href="12864_2018_5372_Fig4_HTML" id="MO4"/></fig></p><p id="Par45">We found that on the MeanDif simulation (see the Method section), Mann&#x02013;Whitney U test and Student&#x02019;s T test worked better than Kolmogorov-Smirnov test, because the first two statistics methods were more powerful to detect the change of the mean of 5-mers, yet signal mean of modified bases were simulated on the MeanDif simulation. However, for the other three simulations (the STDDif, Mean_STDDif, and Mean_STDDif_NE simulations) where differences of standard deviation of 5-mers were considered, Kolmogorov-Smirnov test significantly outperformed Mann&#x02013;Whitney U test and Student&#x02019;s T test. In particular, when only differences of standard deviation of modified 5-mers were simulated, Mann&#x02013;Whitney U test and Student&#x02019;s T test had no predictive power, as expected (refer to STDDif in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>). Since it is unusual for DNA modifications to change only mean or variance of signal intensity values, Kolmogorov-Smirnov test is used by default in NanoMod for capturing all types of alterations in signals.</p><p id="Par46">When the two combined statistics methods were used, the performance was worse than Kolmogorov-Smirnov test for the MeanDif, STDDif and Mean_STDDif simulations. This is because no neighborhood effects were considered in these types of simulations. When neighborhood effects were simulated in Mean_STDDif_NE, both Stouffer&#x02019;s Method and Fisher&#x02019;s method improved the detection of DNA modification. In particular, Stouffer&#x02019;s method performed much better than Fisher&#x02019;s method, and 75% modifications detected by Stouffer&#x02019;s method were ranked at top. This suggested that Stouffer&#x02019;s method is preferred over single-base Kolmogorov-Smirnov test when neighborhood effects are present.</p></sec><sec id="Sec14"><title>Evaluation on <italic>E. coli</italic> methylation data</title><p id="Par47">To test the usefulness of NanoMod on synthetically introduced modifications rather than simulated data, we also evaluated NanoMod on a publicly available Nanopore long-read sequencing data on <italic>E. coli</italic> [<xref ref-type="bibr" rid="CR3">3</xref>] where CpG sites were almost all methylated by the M.SssI methyltransferase. Given a rank list of detected modifications, we calculated precision and recall at each splitting percentile value for evaluating five statistical methods (implemented in NanoMod) and nanoraw. The results were shown in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>.<fig id="Fig5"><label>Fig. 5</label><caption><p>The performance of modification detection using nanoraw and 5 statistics methods implemented in NanoMod. &#x0201c;U test&#x0201d;: Mann&#x02013;Whitney U test, &#x0201c;T test&#x0201d;: Student&#x02019;s T test, &#x0201c;KS test&#x0201d;: Kolmogorov-Smirnov test, &#x0201c;Stouffer&#x02019;s M&#x0201d;: Stouffer&#x02019;s method and &#x0201c;Fisher&#x02019;s M&#x0201d;: Fisher&#x02019;s method. The percentile definition was in the method section. Precision was calculated using the number of correctly identified modifications divided by the number of modification predictions at a percentile (i.e., 0.1, 0.25, 0.5, 1, 2, 3, 4, 5% and then to 30%), and recall was calculated using the number of correctly identified modifications divided by the number of modifications</p></caption><graphic xlink:href="12864_2018_5372_Fig5_HTML" id="MO5"/></fig></p><p id="Par48">We found that the combined statistical testing methods achieved better performance than the various methods on single bases, indicating strong neighborhood effects caused by the methylation. In particular, Fisher&#x02019;s method and Stouffer&#x02019;s method (both implemented in NanoMod) outperformed nanoraw especially to detect methylations at the top rank (the smaller recall in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>), where the precision of nanoraw was about 0.70 while the precision of Nanomod was more than 0.9. (We note that nanoraw itself incorporated Fisher&#x02019;s method to combine <italic>p</italic>-values.) Therefore, NanoMod significantly improved the performance to detect modified DNA bases.</p><p id="Par49">In Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>, the better performance of Fisher&#x02019;s method (implemented in NanoMod) is due to the fact that the <italic>E. coli</italic> sequence has many modified regions containing multiple CpG sites together. Note that the original data set was generated on DNA molecules treated with the M.SssI methyltransferase, where nearly all of cytosines in a CpG context were converted to 5-mC, yet in practice de novo modifications in living organisms should occur only in a very minor fraction of bases. Indeed, upon further examination, among about half of CpG sites, we can found another CpG sites within 5&#x02009;bps. In such scenarios, Stouffer&#x02019;s method cannot work as well as Fisher&#x02019;s method, because Stouffer&#x02019;s method give less weights to neighbors of a methylation site.</p></sec><sec id="Sec15"><title>Example plots of top ranked CpG sites</title><p id="Par50">We used the top three ranked CpG sites detected by NanoMod in the methylation data of <italic>E. coli</italic> to demonstrate details of how NanoMod identified signal difference at methylated CpG sites. The results were shown in Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>. As can be seen from Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>(a) and (b), NanoMod generated the smallest <italic>p</italic>-values of the position and its closest neighbors at the center of the plot. In contrast, those positions, which were far from the CpG sites (the both left and right sides of Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>(a) and the right side of Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>(b), had much larger p-values using either Kolmogorov-Smirnov test or the Stouffer&#x02019;s method. This observation demonstrated that methylated bases changed the Nanopore signals. In the left side of Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref> (b) and (c), the methylated CpG site in the center had smaller p-values. Meanwhile, the left side of Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>(b) and the left and right sides of Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>(c) also had <italic>p</italic>-values which were smaller than the both left and right sides of Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>(a) and the right side of Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>(b). This is because there are two additional CpG sites on the right side of Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>(b) and two additional CpG sites on either side of Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>(c). These observations clearly demonstrated that NanoMod captured statistically significant signals of modified bases between modified reads and non-modified bases.<fig id="Fig6"><label>Fig. 6</label><caption><p>Analysis of DNA methylation in <italic>E. coli</italic> using NanoMod. Data of the top three ranked modifications are shown. &#x02018;<italic>p</italic>-value/Comb Pv&#x02019; is the combined <italic>p</italic>-values calculated using the Stouffer&#x02019;s method, &#x02018;KS test/KS Pv&#x02019; is the p-value calculated using Kolmogorov-Smirnov test. &#x02018;DS 1&#x02019; represents the non-methylated sample, and &#x02018;DS 2&#x02019; represents the methylated sample. In each panel, the first line is the position of the base in the reference genome followed by the base in reads. The position is based on the reference genome. For reverse strand, the 3&#x02032; to 5&#x02032; of reads is from right to left while for forward strand of reads is from left to right</p></caption><graphic xlink:href="12864_2018_5372_Fig6_HTML" id="MO6"/></fig></p></sec></sec><sec id="Sec16"><title>Discussion</title><p id="Par51">The advent of Nanopore long-read sequencing technique provides valuable opportunities to detect DNA modifications directly from signal intensity data at a large scale and at low costs. Although several existing tools were developed for the detection of DNA modifications using Nanopore long-read data, they either need large training data [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>] or require further tweaking of algorithms to improve the detection of modifications [<xref ref-type="bibr" rid="CR2">2</xref>]. In this study, we proposed NanoMod to identify DNA modifications using raw signals of reads generated by the Nanopore long-read sequencing technique. NanoMod does not require any training data so it can detect DNA modifications de novo. NanoMod achieved improved performance when it was evaluated on simulation data with modifications of different properties and on an <italic>E. coli</italic> data set with 5mC (5-methylcytosine) modifications.</p><p id="Par52">Compared with existing methods [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>], one limitation of NanoMod is that it is designed to detect DNA modifications de novo and hence cannot predict the specific type of modification (such as whether a modification is 4mA or 5mC). However, given large-scale training data sets, it is possible to generate prior models in NanoMod to detect specific type of modifications. For example, assume that a specific modification on a base will impact the signals on a 7-bp window around the base, then from a large training data set, we can generate the signal distributions for all 7-mers surrounding the specific modification as the prior model. Long reads on a new sample can be compared to the prior model as well as a control model (from samples without modifications) to detect whether the specific type of modification exist in each position in the new sample.</p><p id="Par53">Both nanoraw [<xref ref-type="bibr" rid="CR2">2</xref>] and NanoMod require two groups of reads, one from a sample with modifications and the other from a matched control sample known to contain no modifications. They both used the error correction procedure from the alignment. After aligning long reads to a known sequence, signals of bases in long reads can be used to annotate the corresponding mapped positions. However, Nanopore long reads have high insertion/deletion errors especially when the bases are called from segmentation events (the latest version of albacore no longer use this procedure, partly due to the inherent error in the segmentation process). Thus, the indel correction step is crucial to rescue signal annotations for many positions. In some specific cases, the reference sequence used in NanoMod may contain true indels themselves (for example, when using <italic>E. coli</italic> reference genome sequence in the analysis for an <italic>E. coli</italic> strain with real indels at specific positions); in these scenarios, it may be necessary to generate confidence sets of indel calls on the sample first, then use a modified version of reference sequence (by incorporating highly confident indels) in the error correction procedure in NanoMod.</p><p id="Par54">Integrated statistical testing is another critical component of NanoMod, because different types of modifications can result in different types of alterations on the signal distributions. Modifications might (i) only change signal mean of a modified base, or (ii) only change variance of the signals for a modified base, or (iii) result in the change of both signal mean and standard deviation, or (iv) change the overall shape of distribution such as from unimodal to bimodal, or (v) affect several adjacent neighborhood positions, and so on. Different statistical tests may have different power to detect modifications based on the property of the modifications. For example, Student&#x02019;s T test and Mann&#x02013;Whitney U test outperformed Kolmogorov-Smirnov test for the first category of modifications, but had no prediction power for the second category of modifications and had limited power for the other categories of modifications (see Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>). Kolmogorov-Smirnov test outperformed other methods for the second and third categories of modifications, and achieved worse performance than the combined statistical testing for the fifth category of modifications. In short, Kolmogorov-Smirnov test on single bases and the combined Stouffer&#x02019;s method on multiple bases are better choice for modification detections than Mann&#x02013;Whitney U test used in nanoraw [<xref ref-type="bibr" rid="CR2">2</xref>] when data set is large enough. This comparison was supported by additional preliminary studies (data not shown) where NanoMod could achieve much better prediction performance than nanoraw for multiple different types of modifications that we introduced synthetically into DNA molecules.</p><p id="Par55">More accurate detection of DNA modifications, especially synthetically introduced modifications, has many downstream applications. For example, accurate detection of DNA modifications can facilitate studies on the role of epigenetic modifications [<xref ref-type="bibr" rid="CR24">24</xref>] in different human diseases such as cancer, and help identity candidate genes where epigenetic switch is important for disease progression. Similarly, incorporation of modified DNA bases during DNA synthesis can be used to track patterns of DNA replication [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>], so accurate detection of de novo DNA modifications on newly synthesized DNA strands enables genome-wide studies on DNA replication timing and patterns.</p></sec><sec id="Sec17"><title>Conclusion</title><p id="Par56">We have developed a new computational tool, NanoMod, for the detection of DNA modifications using Nanopore long-read sequencing data. We evaluated NanoMod on simulation data with different types of modifications and also on a methylation data of <italic>E. coli</italic>. Our results suggested that NanoMod achieved better performance than other existing tools in detecting modifications without training data. Therefore, NanoMod will greatly facilitate functional genomics experiments for single base resolution mapping of modified nucleotides in the genome.</p></sec></body><back><glossary><title>Abbreviations</title><def-list><def-item><term>5mC</term><def><p id="Par5">5-methylcytosine</p></def></def-item><def-item><term>HMM</term><def><p id="Par6">Hidden Markov model</p></def></def-item><def-item><term>SMRT</term><def><p id="Par7">Single-molecule real-time</p></def></def-item></def-list></glossary><ack><title>Acknowledgements</title><p>We thank the Wang lab members for insightful comments on the NanoMod algorithm and implementation, and we thank the developers of nanoraw for providing valuable help and support on the software tool. We thank Simpson et al for making the <italic>E. coli</italic> data publicly available for testing our software tools.</p><sec id="FPar1"><title>Funding</title><p id="Par57">This study was in part supported by NIH grant HG006465 (K.W.). Publication of this article was supported by CHOP Research Institute.</p></sec><sec id="FPar2" sec-type="data-availability"><title>Availability of data and materials</title><p id="Par58">NanoMod is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/WGLab/NanoMod">https://github.com/WGLab/NanoMod</ext-link>.</p></sec><sec id="FPar3"><title>About this supplement</title><p id="Par59">This article has been published as part of <italic>BMC Genomics Volume 20 Supplement 1, 2019: Selected articles from the International Conference on Intelligent Biology and Medicine (ICIBM) 2018: genomics.</italic> The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="https://bmcgenomics.biomedcentral.com/articles/supplements/volume-20-supplement-1">https://bmcgenomics.biomedcentral.com/articles/supplements/volume-20-supplement-1</ext-link>.</p></sec></ack><notes notes-type="author-contribution"><title>Authors&#x02019; contributions</title><p>QL and KW designed the study. QL implemented the tool and performed the analysis. DCG and DE facilitated and advised the development of the tool and analysis. QL and KW drafted the manuscript. All authors read, revised and approved the manuscript.</p></notes><notes notes-type="COI-statement"><sec id="FPar4"><title>Ethics approval and consent to participate</title><p>Not applicable.</p></sec><sec id="FPar5"><title>Consent for publication</title><p>Not applicable.</p></sec><sec id="FPar6"><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec id="FPar7"><title>Publisher&#x02019;s Note</title><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></sec></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><mixed-citation publication-type="other">Sood AJ, Viner C, Hoffman MM. DNAmod: the DNA modification database. bioRxiv. 2016.</mixed-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="other">Stoiber MH, Quick J, Egan R, Lee JE, Celniker SE, Neely R, Loman N, Pennacchio L, Brown JB. De novo identification of DNA modifications enabled by genome-guided Nanopore signal processing. bioRxiv. 2017.</mixed-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simpson</surname><given-names>JT</given-names></name><name><surname>Workman</surname><given-names>RE</given-names></name><name><surname>Zuzarte</surname><given-names>PC</given-names></name><name><surname>David</surname><given-names>M</given-names></name><name><surname>Dursi</surname><given-names>LJ</given-names></name><name><surname>Timp</surname><given-names>W</given-names></name></person-group><article-title>Detecting DNA cytosine methylation using nanopore sequencing</article-title><source>Nat Methods</source><year>2017</year><volume>14</volume><issue>4</issue><fpage>407</fpage><lpage>410</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4184</pub-id><pub-id pub-id-type="pmid">28218898</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCaffrey</surname><given-names>J</given-names></name><name><surname>Sibert</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>B</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Hu</surname><given-names>W</given-names></name><name><surname>Riethman</surname><given-names>H</given-names></name><name><surname>Xiao</surname><given-names>M</given-names></name></person-group><article-title>CRISPR-CAS9 D10A nickase target-specific fluorescent labeling of double strand DNA for whole genome mapping and structural variation analysis</article-title><source>Nucleic Acids Res</source><year>2016</year><volume>44</volume><issue>2</issue><fpage>e11</fpage><pub-id pub-id-type="doi">10.1093/nar/gkv878</pub-id><pub-id pub-id-type="pmid">26481349</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="other">Klein K, Wang W, Borrman T, Chan S, Zhang D, Weng Z, Hastie A, Chen C, Gilbert DM, Rhind N. Genome-Wide Identification of Early-Firing Human Replication Origins by Optical Replication Mapping. bioRxiv. 2017.</mixed-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miura</surname><given-names>F</given-names></name><name><surname>Enomoto</surname><given-names>Y</given-names></name><name><surname>Dairiki</surname><given-names>R</given-names></name><name><surname>Ito</surname><given-names>T</given-names></name></person-group><article-title>Amplification-free whole-genome bisulfite sequencing by post-bisulfite adaptor tagging</article-title><source>Nucleic Acids Res</source><year>2012</year><volume>40</volume><issue>17</issue><fpage>e136</fpage><pub-id pub-id-type="doi">10.1093/nar/gks454</pub-id><pub-id pub-id-type="pmid">22649061</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dominissini</surname><given-names>D</given-names></name><name><surname>Moshitch-Moshkovitz</surname><given-names>S</given-names></name><name><surname>Schwartz</surname><given-names>S</given-names></name><name><surname>Salmon-Divon</surname><given-names>M</given-names></name><name><surname>Ungar</surname><given-names>L</given-names></name><name><surname>Osenberg</surname><given-names>S</given-names></name><name><surname>Cesarkas</surname><given-names>K</given-names></name><name><surname>Jacob-Hirsch</surname><given-names>J</given-names></name><name><surname>Amariglio</surname><given-names>N</given-names></name><name><surname>Kupiec</surname><given-names>M</given-names></name><etal/></person-group><article-title>Topology of the human and mouse m6A RNA methylomes revealed by m6A-seq</article-title><source>Nature</source><year>2012</year><volume>485</volume><issue>7397</issue><fpage>201</fpage><lpage>206</lpage><pub-id pub-id-type="doi">10.1038/nature11112</pub-id><pub-id pub-id-type="pmid">22575960</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meyer Kate</surname><given-names>D</given-names></name><name><surname>Saletore</surname><given-names>Y</given-names></name><name><surname>Zumbo</surname><given-names>P</given-names></name><name><surname>Elemento</surname><given-names>O</given-names></name><name><surname>Mason Christopher</surname><given-names>E</given-names></name><name><surname>Jaffrey Samie</surname><given-names>R</given-names></name></person-group><article-title>Comprehensive analysis of mRNA methylation reveals enrichment in 3&#x02032; UTRs and near stop codons</article-title><source>Cell</source><year>2012</year><volume>149</volume><issue>7</issue><fpage>1635</fpage><lpage>1646</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2012.05.003</pub-id><pub-id pub-id-type="pmid">22608085</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flusberg</surname><given-names>BA</given-names></name><name><surname>Webster</surname><given-names>DR</given-names></name><name><surname>Lee</surname><given-names>JH</given-names></name><name><surname>Travers</surname><given-names>KJ</given-names></name><name><surname>Olivares</surname><given-names>EC</given-names></name><name><surname>Clark</surname><given-names>TA</given-names></name><name><surname>Korlach</surname><given-names>J</given-names></name><name><surname>Turner</surname><given-names>SW</given-names></name></person-group><article-title>Direct detection of DNA methylation during single-molecule, real-time sequencing</article-title><source>Nat Methods</source><year>2010</year><volume>7</volume><issue>6</issue><fpage>461</fpage><lpage>465</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1459</pub-id><pub-id pub-id-type="pmid">20453866</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname><given-names>TA</given-names></name><name><surname>Murray</surname><given-names>IA</given-names></name><name><surname>Morgan</surname><given-names>RD</given-names></name><name><surname>Kislyuk</surname><given-names>AO</given-names></name><name><surname>Spittle</surname><given-names>KE</given-names></name><name><surname>Boitano</surname><given-names>M</given-names></name><name><surname>Fomenkov</surname><given-names>A</given-names></name><name><surname>Roberts</surname><given-names>RJ</given-names></name><name><surname>Korlach</surname><given-names>J</given-names></name></person-group><article-title>Characterization of DNA methyltransferase specificities using single-molecule, real-time DNA sequencing</article-title><source>Nucleic Acids Res</source><year>2012</year><volume>40</volume><issue>4</issue><fpage>e29</fpage><pub-id pub-id-type="doi">10.1093/nar/gkr1146</pub-id><pub-id pub-id-type="pmid">22156058</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>Z</given-names></name><name><surname>Fang</surname><given-names>G</given-names></name><name><surname>Korlach</surname><given-names>J</given-names></name><name><surname>Clark</surname><given-names>T</given-names></name><name><surname>Luong</surname><given-names>K</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Wong</surname><given-names>W</given-names></name><name><surname>Schadt</surname><given-names>E</given-names></name></person-group><article-title>Detecting DNA modifications from SMRT sequencing data by modeling sequence context dependence of polymerase kinetic</article-title><source>PLoS Comput Biol</source><year>2013</year><volume>9</volume><issue>3</issue><fpage>e1002935</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002935</pub-id><pub-id pub-id-type="pmid">23516341</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cohen</surname><given-names>NR</given-names></name><name><surname>Ross</surname><given-names>CA</given-names></name><name><surname>Jain</surname><given-names>S</given-names></name><name><surname>Shapiro</surname><given-names>RS</given-names></name><name><surname>Gutierrez</surname><given-names>A</given-names></name><name><surname>Belenky</surname><given-names>P</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Collins</surname><given-names>JJ</given-names></name></person-group><article-title>A role for the bacterial GATC methylome in antibiotic stress survival</article-title><source>Nat Genet</source><year>2016</year><volume>48</volume><issue>5</issue><fpage>581</fpage><lpage>586</lpage><pub-id pub-id-type="doi">10.1038/ng.3530</pub-id><pub-id pub-id-type="pmid">26998690</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saletore</surname><given-names>Y</given-names></name><name><surname>Meyer</surname><given-names>K</given-names></name><name><surname>Korlach</surname><given-names>J</given-names></name><name><surname>Vilfan</surname><given-names>ID</given-names></name><name><surname>Jaffrey</surname><given-names>S</given-names></name><name><surname>Mason</surname><given-names>CE</given-names></name></person-group><article-title>The birth of the Epitranscriptome: deciphering the function of RNA modifications</article-title><source>Genome Biol</source><year>2012</year><volume>13</volume><issue>10</issue><fpage>175</fpage><pub-id pub-id-type="doi">10.1186/gb-2012-13-10-175</pub-id><pub-id pub-id-type="pmid">23113984</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beaulaurier</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>X-S</given-names></name><name><surname>Zhu</surname><given-names>S</given-names></name><name><surname>Sebra</surname><given-names>R</given-names></name><name><surname>Rosenbluh</surname><given-names>C</given-names></name><name><surname>Deikus</surname><given-names>G</given-names></name><name><surname>Shen</surname><given-names>N</given-names></name><name><surname>Munera</surname><given-names>D</given-names></name><name><surname>Waldor</surname><given-names>MK</given-names></name><name><surname>Chess</surname><given-names>A</given-names></name><etal/></person-group><article-title>Single molecule-level detection and long read-based phasing of epigenetic variations in bacterial methylomes</article-title><source>Nat Commun</source><year>2015</year><volume>6</volume><fpage>7438</fpage><pub-id pub-id-type="doi">10.1038/ncomms8438</pub-id><pub-id pub-id-type="pmid">26074426</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname><given-names>TA</given-names></name><name><surname>Lu</surname><given-names>X</given-names></name><name><surname>Luong</surname><given-names>K</given-names></name><name><surname>Dai</surname><given-names>Q</given-names></name><name><surname>Boitano</surname><given-names>M</given-names></name><name><surname>Turner</surname><given-names>SW</given-names></name><name><surname>He</surname><given-names>C</given-names></name><name><surname>Korlach</surname><given-names>J</given-names></name></person-group><article-title>Enhanced 5-methylcytosine detection in single-molecule, real-time sequencing via Tet1 oxidation</article-title><source>BMC Biol</source><year>2013</year><volume>11</volume><issue>1</issue><fpage>4</fpage><pub-id pub-id-type="doi">10.1186/1741-7007-11-4</pub-id><pub-id pub-id-type="pmid">23339471</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davis</surname><given-names>BM</given-names></name><name><surname>Chao</surname><given-names>MC</given-names></name><name><surname>Waldor</surname><given-names>MK</given-names></name></person-group><article-title>Entering the era of bacterial epigenomics with single molecule real time DNA sequencing</article-title><source>Curr Opin Microbiol</source><year>2013</year><volume>16</volume><issue>2</issue><fpage>192</fpage><lpage>198</lpage><pub-id pub-id-type="doi">10.1016/j.mib.2013.01.011</pub-id><pub-id pub-id-type="pmid">23434113</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laszlo</surname><given-names>AH</given-names></name><name><surname>Derrington</surname><given-names>IM</given-names></name><name><surname>Brinkerhoff</surname><given-names>H</given-names></name><name><surname>Langford</surname><given-names>KW</given-names></name><name><surname>Nova</surname><given-names>IC</given-names></name><name><surname>Samson</surname><given-names>JM</given-names></name><name><surname>Bartlett</surname><given-names>JJ</given-names></name><name><surname>Pavlenok</surname><given-names>M</given-names></name><name><surname>Gundlach</surname><given-names>JH</given-names></name></person-group><article-title>Detection and mapping of 5-methylcytosine and 5-hydroxymethylcytosine with nanopore MspA</article-title><source>Proc Natl Acad Sci U S A</source><year>2013</year><volume>110</volume><issue>47</issue><fpage>18904</fpage><lpage>18909</lpage><pub-id pub-id-type="doi">10.1073/pnas.1310240110</pub-id><pub-id pub-id-type="pmid">24167255</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schreiber</surname><given-names>J</given-names></name><name><surname>Wescoe</surname><given-names>ZL</given-names></name><name><surname>Abu-Shumays</surname><given-names>R</given-names></name><name><surname>Vivian</surname><given-names>JT</given-names></name><name><surname>Baatar</surname><given-names>B</given-names></name><name><surname>Karplus</surname><given-names>K</given-names></name><name><surname>Akeson</surname><given-names>M</given-names></name></person-group><article-title>Error rates for nanopore discrimination among cytosine, methylcytosine, and hydroxymethylcytosine along individual DNA strands</article-title><source>Proc Natl Acad Sci U S A</source><year>2013</year><volume>110</volume><issue>47</issue><fpage>18910</fpage><lpage>18915</lpage><pub-id pub-id-type="doi">10.1073/pnas.1310615110</pub-id><pub-id pub-id-type="pmid">24167260</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wescoe</surname><given-names>ZL</given-names></name><name><surname>Schreiber</surname><given-names>J</given-names></name><name><surname>Akeson</surname><given-names>M</given-names></name></person-group><article-title>Nanopores discriminate among five C5-cytosine variants in DNA</article-title><source>J Am Chem Soc</source><year>2014</year><volume>136</volume><issue>47</issue><fpage>16582</fpage><lpage>16587</lpage><pub-id pub-id-type="doi">10.1021/ja508527b</pub-id><pub-id pub-id-type="pmid">25347819</pub-id></element-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="other">McIntyre ABR, Alexander N, Burton AS, Castro-Wallace S, Chiu CY, John KK, Stahl SE, Li S, Mason CE. Nanopore detection of bacterial DNA base modifications. bioRxiv. 2017.</mixed-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rand</surname><given-names>AC</given-names></name><name><surname>Jain</surname><given-names>M</given-names></name><name><surname>Eizenga</surname><given-names>JM</given-names></name><name><surname>Musselman-Brown</surname><given-names>A</given-names></name><name><surname>Olsen</surname><given-names>HE</given-names></name><name><surname>Akeson</surname><given-names>M</given-names></name><name><surname>Paten</surname><given-names>B</given-names></name></person-group><article-title>Mapping DNA methylation with high-throughput nanopore sequencing</article-title><source>Nat Methods</source><year>2017</year><volume>14</volume><issue>4</issue><fpage>411</fpage><lpage>413</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4189</pub-id><pub-id pub-id-type="pmid">28218897</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Massey</surname><given-names>FJ</given-names></name></person-group><article-title>The Kolmogorov-Smirnov test for goodness of fit</article-title><source>J Am Stat Assoc</source><year>1951</year><volume>46</volume><issue>253</issue><fpage>68</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1080/01621459.1951.10500769</pub-id></element-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="other">Li H. Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM. ArXiv e-prints. 2013.</mixed-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Handy</surname><given-names>DE</given-names></name><name><surname>Castro</surname><given-names>R</given-names></name><name><surname>Loscalzo</surname><given-names>J</given-names></name></person-group><article-title>Epigenetic modifications: basic mechanisms and role in cardiovascular disease</article-title><source>Circulation</source><year>2011</year><volume>123</volume><issue>19</issue><fpage>2145</fpage><lpage>2156</lpage><pub-id pub-id-type="doi">10.1161/CIRCULATIONAHA.110.956839</pub-id><pub-id pub-id-type="pmid">21576679</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>IH</given-names></name><name><surname>Suomalainen</surname><given-names>M</given-names></name><name><surname>Andriasyan</surname><given-names>V</given-names></name><name><surname>Kilcher</surname><given-names>S</given-names></name><name><surname>Mercer</surname><given-names>J</given-names></name><name><surname>Neef</surname><given-names>A</given-names></name><name><surname>Luedtke Nathan</surname><given-names>W</given-names></name><name><surname>Greber Urs</surname><given-names>F</given-names></name></person-group><article-title>Tracking viral genomes in host cells at single-molecule resolution</article-title><source>Cell Host Microbe</source><year>2013</year><volume>14</volume><issue>4</issue><fpage>468</fpage><lpage>480</lpage><pub-id pub-id-type="doi">10.1016/j.chom.2013.09.004</pub-id><pub-id pub-id-type="pmid">24139403</pub-id></element-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salic</surname><given-names>A</given-names></name><name><surname>Mitchison</surname><given-names>TJ</given-names></name></person-group><article-title>A chemical method for fast and sensitive detection of DNA synthesis in vivo</article-title><source>Proc Natl Acad Sci U S A</source><year>2008</year><volume>105</volume><issue>7</issue><fpage>2415</fpage><lpage>2420</lpage><pub-id pub-id-type="doi">10.1073/pnas.0712168105</pub-id><pub-id pub-id-type="pmid">18272492</pub-id></element-citation></ref></ref-list></back></article>